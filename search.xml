<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Move IR ç¤ºä¾‹ä»£ç è§£è¯»]]></title>
    <url>%2F2019%2F07%2F10%2Flibra-moveIR-exampleCode%2F</url>
    <content type="text"><![CDATA[Move IR ç¤ºä¾‹ä»£ç è§£è¯»æœ¬èŠ‚æè¿°å¦‚ä½•åœ¨Moveä¸­é—´è¡¨ç¤º(IR)ä¸­ç¼–å†™äº‹åŠ¡è„šæœ¬å’Œæ¨¡å—ã€‚IRæ˜¯å³å°†åˆ°æ¥çš„Moveæºä»£ç è¯­è¨€çš„æ—©æœŸ(ä¸”ä¸ç¨³å®š)å…ˆé©±ã€‚Move IRæ˜¯ä¸€ä¸ªè¦†ç›–äºŽMoveå­—èŠ‚ç ä¹‹ä¸Šçš„è–„è–„çš„è¯­æ³•å±‚ï¼Œç”¨äºŽæµ‹è¯•å­—èŠ‚ç éªŒè¯å™¨å’Œè™šæ‹Ÿæœºï¼Œå®ƒå¯¹å¼€å‘äººå‘˜ä¸æ˜¯ç‰¹åˆ«å‹å¥½ã€‚å®ƒçš„çº§åˆ«è¶³å¤Ÿé«˜ï¼Œå¯ä»¥ç¼–å†™äººç±»å¯è¯»çš„ä»£ç ï¼Œä½†åˆè¶³å¤Ÿä½Žï¼Œå¯ä»¥ç›´æŽ¥ç¼–è¯‘ä»¥ç§»åŠ¨å­—èŠ‚ç ã€‚ æŽ¥ä¸‹æ¥ï¼Œæˆ‘å°†å±•ç¤ºä¸€äº›Move IRç‰‡æ®µã€‚å…³äºŽå¦‚ä½•åœ¨æœ¬åœ°ç¼–è¯‘ã€è¿è¡Œå’Œä¿®æ”¹è¿™äº›ç¤ºä¾‹æ¥å­¦ä¹ ã€‚libra/language/README.md and libra/language/compiler/README.mdè§£é‡Šäº†å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚ ç¼–å†™äº‹åŠ¡è„šæœ¬æ­£å¦‚æˆ‘ä»¬åœ¨Moveäº‹åŠ¡è„šæœ¬ä¸­è§£é‡Šçš„é‚£æ ·ï¼Œç”¨æˆ·ç¼–å†™äº‹åŠ¡è„šæœ¬æ¥è¯·æ±‚å¯¹LibraåŒºå—é“¾çš„å…¨å±€å­˜å‚¨çš„æ›´æ–°ã€‚å‡ ä¹Žåœ¨ä»»ä½•äº‹åŠ¡è„šæœ¬ä¸­éƒ½ä¼šå‡ºçŽ°ä¸¤ä¸ªé‡è¦çš„æž„å»ºå—:LibraAccount.Tå’ŒLibraCoin.Tã€‚LibraAccountæ˜¯æ¨¡å—çš„åç§°ï¼ŒTæ˜¯è¯¥æ¨¡å—å£°æ˜Žçš„èµ„æºçš„åç§°ã€‚è¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„å‘½åçº¦å®š;æ¨¡å—å£°æ˜Žçš„â€œmainâ€ç±»åž‹é€šå¸¸å‘½åä¸ºTã€‚ å½“æˆ‘ä»¬è¯´ä¸€ä¸ªç”¨æˆ·â€œåœ¨LibraåŒºå—é“¾ä¸Šçš„åœ°å€0xffå¤„æœ‰ä¸€ä¸ªå¸æˆ·â€æ—¶ï¼Œæˆ‘ä»¬çš„æ„æ€æ˜¯åœ°å€0xffæŒæœ‰LibraAccount.Tçš„èµ„æºã€‚æ¯ä¸ªéžç©ºåœ°å€éƒ½æœ‰ä¸€ä¸ªLibraAccount.Tèµ„æºã€‚æ­¤èµ„æºå­˜å‚¨å¸æˆ·æ•°æ®ï¼Œå¦‚åºåˆ—å·ã€èº«ä»½éªŒè¯å¯†é’¥å’Œä½™é¢ã€‚Libraç³»ç»Ÿçš„ä»»ä½•éƒ¨åˆ†æƒ³è¦ä¸Žä¸€ä¸ªå¸æˆ·è¿›è¡Œäº¤äº’ï¼Œéƒ½å¿…é¡»ä»ŽLibraAccount.Tèµ„æºä¸­è¯»å–æ•°æ®æˆ–è€…è°ƒç”¨LibraAccountçš„æ¨¡å—çš„è¿‡ç¨‹å‡½æ•°ã€‚ å¸æˆ·ä½™é¢æ˜¯LibraCoin.Tç±»åž‹çš„èµ„æºï¼Œå°±åƒå…¶ä»–ç§»åŠ¨èµ„æºä¸€æ ·ã€‚LibraCoinç±»åž‹çš„èµ„æºTå¯ä»¥å­˜å‚¨åœ¨ç¨‹åºå˜é‡ä¸­ï¼Œåœ¨è¿‡ç¨‹ä¹‹é—´ä¼ é€’ï¼Œç­‰ç­‰ã€‚ ä¸‹é¢è¿™äº›ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä¸Žæ¨¡å—å’Œèµ„æºäº¤äº’ã€‚ 1234567891011121314151617181920// ä½¿ç”¨å·²ç»å‘å¸ƒåˆ°é“¾ä¸Šçš„åœ¨ä¸€ä¸ªåœ°å€ä¸Šçš„Libra æ¨¡å—// 0x0...0 (with 64 zeroes). 0x0å…¶å®žæ˜¯ä¸€ä¸ªç¼©å†™ï¼Œå…¶ä¸­åŒ…å«64ä¸ª0import 0x0.LibraAccount;import 0x0.LibraCoin;main(payee: address, amount: u64) &#123; //IRä»£ç çš„å±€éƒ¨å˜é‡èŒƒå›´åœ¨æ•´ä¸ªå‡½æ•°è¿‡ç¨‹ï¼Œæ‰€æœ‰çš„å±€éƒ¨å˜é‡å£°æ˜Žéƒ½å¿…é¡» //åœ¨ç¨‹åºçš„å¼€å§‹ã€‚å£°æ˜Žå’Œåˆå§‹åŒ–å˜é‡æ˜¯ç‹¬ç«‹çš„æ“ä½œï¼Œä½†æ˜¯å­—èŠ‚ç éªŒè¯å™¨ä¼šé˜»æ­¢ //ä»»ä½•ä½¿ç”¨æœªåˆå§‹åŒ–å˜é‡çš„å°è¯•ã€‚ let coin: R#LibraCoin.T; //ä¸Šé¢ç±»åž‹çš„R#éƒ¨åˆ†æ˜¯ä¸¤ä¸ª*ç±»åž‹æ³¨è§£* R#å’ŒV#ä¹‹ä¸€(â€œResourceâ€å’Œâ€œunrestricted Valueâ€çš„ç¼©å†™)ã€‚è¿™äº›æ³¨è§£ //å¿…é¡»åŒ¹é…ç±»åž‹å£°æ˜Žçš„ç±»åž‹(ä¾‹å¦‚LibraCoinæ¨¡å—å£°æ˜Žâ€œresource Tâ€æˆ–â€œstruct Tâ€) //èŽ·å–senderçš„æ•°é‡ä¸ºamountçš„ LibraCoin.Tèµ„æºï¼Œå¦‚æžœsenderçš„ä½™é¢ä¸è¶³balanceï¼Œåˆ™ä¼šå¤±è´¥ï¼Œè¿™é‡Œamount // æ˜¯ä¸€ä¸ª unrestrictedå€¼ï¼Œæ‰€ä»¥å¯ä»¥copyä¹Ÿå¯ä»¥moveï¼Œä½†æ˜¯å› ä¸ºåŽç»­ä¸å†ä½¿ç”¨ï¼Œ æ‰€ä»¥æœ€å¥½è¿˜æ˜¯moveæŽ‰(move // ç™½çš®ä¹¦æ˜¯é‡Œé¢å†™çš„æ˜¯copy) coin = LibraAccount.withdraw_from_sender(move(amount)); // Move LibraCoin.T èµ„æºè¿›å…¥payeeè´¦æˆ·ï¼Œå¦‚æžœè´¦æˆ·ä¸å­˜åœ¨ï¼Œåˆ™æ­¥éª¤å¤±è´¥ LibraAccount.deposit(move(payee), move(coin)); //æ¯ä¸€ä¸ªå‡½æ•°è¿‡ç¨‹å¿…é¡»è¦æœ‰ä¸ªreturn, IR ç¼–è¯‘å™¨ä¸ä¼šåœ¨æ²¡æœ‰å†™returnçš„æƒ…å†µä¸‹ï¼Œè‡ªå·±åŠ ä¸Šreturnï¼Œå¦‚æžœæœ‰è¿”å›ž // å€¼ï¼Œè¿˜è¦å†™ä¸Šç›¸åº”çš„è¿”å›žå€¼ return;&#125; è¿™ä¸ªäº‹åŠ¡è„šæœ¬æœ‰ä¸€ä¸ªä¸å¹¸çš„é—®é¢˜â€”â€”å¦‚æžœæ”¶æ¬¾äººåœ°å€ä¸‹æ²¡æœ‰å¸æˆ·ï¼Œå®ƒå°†å¤±è´¥ã€‚æˆ‘ä»¬å°†é€šè¿‡ä¿®æ”¹è„šæœ¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»¥ä¾¿åœ¨æ”¶æ¬¾äººå¸æˆ·ä¸å­˜åœ¨çš„æƒ…å†µä¸‹ä¸ºå…¶åˆ›å»ºå¸æˆ·ã€‚ 123456789101112131415161718192021222324// ä¸€ä¸ªç‚¹å¯¹ç‚¹æ”¯ä»˜çš„ä¾‹å­å˜ä½“ï¼Œå³å½“è´¦æˆ·ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œåˆ›å»ºè´¦æˆ·import 0x0.LibraAccount;import 0x0.LibraCoin;main(payee: address, amount: u64) &#123; let coin: R#LibraCoin.T; let account_exists: bool; // Acquire a LibraCoin.T resource with value `amount` from the sender&apos;s // account. This will fail if the sender&apos;s balance is less than `amount`. coin = LibraAccount.withdraw_from_sender(move(amount)); //è¿™é‡Œè°ƒç”¨LibraAccountçš„å†…ç½®å‡½æ•°åˆ¤æ–­è´¦æˆ·æ˜¯å¦å­˜åœ¨ account_exists = LibraAccount.exists(copy(payee)); if (!move(account_exists)) &#123; //é€šè¿‡å‘å¸ƒä¸€ä¸ªLibraAccount.T èµ„æºåœ¨æŽ¥æ”¶æ–¹åœ°å€ä¸‹çš„æ–¹å¼ä¸ºæŽ¥å—è€…åˆ›å»ºä¸€ä¸ªè´¦æˆ·ï¼Œå¦‚æžœ //è´¦æˆ·èµ„æºå·²ç»å­˜åœ¨ï¼Œåˆ™å¤±è´¥ create_account(copy(payee)); &#125; LibraAccount.deposit(move(payee), move(coin)); return;&#125; è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨äº‹åŠ¡è„šæœ¬å‘å¤šä¸ªæ”¶ä»¶äººä»˜æ¬¾ï¼Œè€Œä¸æ˜¯åªå‘ä¸€ä¸ªæ”¶ä»¶äººä»˜æ¬¾ã€‚ 12345678910111213141516171819202122//å¤šä¸ªæ”¶æ¬¾äººä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­å°†amount1+ amount2æ•°é‡çš„èµ„é‡‘è½¬ç§»åˆ° æ”¶æ¬¾1è´¦æˆ·å’Œæ”¶æ¬¾2è´¦æˆ·ä¸Šimport 0x0.LibraAccount;import 0x0.LibraCoin;main(payee1: address, amount1: u64, payee2: address, amount2: u64) &#123; let coin1: R#LibraCoin.T; let coin2: R#LibraCoin.T; let total: u64; total = move(amount1) + copy(amount2); coin1 = LibraAccount.withdraw_from_sender(move(total)); // This mutates `coin1`, which now has value `amount1`. // `coin2` has value `amount2`. //ä¸‹é¢ä»£ç æ‰§è¡Œå®ŒåŽï¼Œcoin1èµ„æºå°†æ‹¥æœ‰æ•°é‡ä¸ºamount1çš„Coin //coin2æ˜¯ä¸€ä¸ªæœ‰amount2æ•°é‡coinçš„èµ„æºï¼Œwithdrawæ˜¯ä¸€ä¸ªå†…ç½®å‡½æ•° coin2 = LibraCoin.withdraw(&amp;mut coin1, move(amount2)); // æ‰§è¡Œæ”¯ä»˜ LibraAccount.deposit(move(payee1), move(coin1)); LibraAccount.deposit(move(payee2), move(coin2)); return;&#125; ç¼–å†™æ¨¡å—çŽ°åœ¨ï¼Œæˆ‘ä»¬å°†æŠŠæ³¨æ„åŠ›è½¬å‘ç¼–å†™è‡ªå·±çš„Moveæ¨¡å—ï¼Œè€Œä¸æ˜¯é‡ç”¨çŽ°æœ‰çš„LibraAccountå’ŒLibraCoinæ¨¡å—ã€‚è€ƒè™‘è¿™ç§æƒ…å†µ:Bobå°†åœ¨å°†æ¥çš„æŸä¸ªæ—¶å€™åœ¨åœ°å€aåˆ›å»ºä¸€ä¸ªå¸æˆ·ã€‚Aliceæƒ³ä¸ºBobâ€œæŒ‡å®šâ€ä¸€äº›èµ„é‡‘ï¼Œè¿™æ ·ä¸€æ—¦Bobçš„è´¦æˆ·åˆ›å»ºå¥½äº†ï¼Œä»–å°±å¯ä»¥æŠŠè¿™äº›èµ„é‡‘è½¬åˆ°ä»–çš„è´¦æˆ·ä¸­ã€‚ä½†å¥¹ä¹Ÿå¸Œæœ›ï¼Œå¦‚æžœé²å‹ƒä»Žæœªåˆ›å»ºè¿‡è´¦æˆ·ï¼Œå¥¹ä¹Ÿèƒ½æ”¶å›žè‡ªå·±çš„èµ„é‡‘ã€‚ ä¸ºäº†ç»™Aliceè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªæ¨¡å—EarmarkedLibraCoin: å£°æ˜Žä¸€ä¸ªæ–°çš„èµ„æºç±»åž‹EarmarkedLibraCoinã€‚è¿™é‡Œé¢æœ‰Libra coinå’ŒæŽ¥æ”¶æ–¹åœ°å€ å…è®¸Aliceåˆ›å»ºè¿™æ ·çš„ç±»åž‹å¹¶å°†å…¶å‘å¸ƒåˆ°å¥¹çš„å¸æˆ·ä¸‹(createè¿‡ç¨‹)ã€‚ å…è®¸Bob claimèµ„æº(claim_for_receiverè¿‡ç¨‹) å…è®¸ä»»ä½•æ‹¥æœ‰EarmarkedLibraCoin.Tèµ„æºçš„äººé”€æ¯å®ƒï¼Œå¹¶èŽ·å¾—åº•å±‚çš„LibraCoin(unwarpçš„è¿‡ç¨‹) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273//ä¸€ä¸ªç”¨äºŽæ”¶æ¬¾åœ°å€æŒ‡å®šcoinçš„æ¨¡å—module EarmarkedLibraCoin &#123; import 0x0.LibraCoin; //T å®šä¹‰äº†ä¸€ä¸ªèµ„æºï¼Œ åŒ…å«äº†Libra coin å’Œä¸€ä¸ªæ”¶æ¬¾åœ°å€ resource T &#123; coin: R#LibraCoin.T, recipient: address &#125; // ä¸ºæŒ‡å®šæ”¶æ¬¾åœ°å€åˆ›å»ºEarmarkedCoin èµ„æº // åœ¨æ­¤äº¤æ˜“å‘é€æ–¹è´¦æˆ·å‘å¸ƒè¯¥èµ„æº public create(coin: R#LibraCoin.T, recipient: address) &#123; let t: R#Self.T; //æž„é€ æˆ–è€…å«åšæ‰“åŒ…ä¸€ä¸ªç±»åž‹ä¸ºTçš„èµ„æºï¼Œåªæœ‰EarmarkedCoin æ¨¡å—çš„å‡½æ•°å¯ä»¥åˆ›å»º EarmarkedCoin.T t = T &#123; coin: move(coin), recipient: move(recipient), &#125;; // åœ¨æ­¤äº¤æ˜“å‘é€è€…è´¦æˆ·ä¸‹å‘å¸ƒ earmarked coin //æ¯ä¸ªè´¦æˆ·å¯ä»¥åŒ…å«ä¸€ä¸ªæŒ‡å®šç±»åž‹çš„èµ„æºï¼Œå¦‚æžœæœ‰ç›¸åŒç±»åž‹çš„èµ„æºå­˜åœ¨ï¼Œæ­¤è¿‡ç¨‹ä¼šå¤±è´¥ //move_to_senderæ˜¯ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œä½œç”¨æ˜¯å°†èµ„æºå‘å¸ƒåˆ°senderè´¦æˆ·ï¼Œæ”¯æŒæ³›åž‹ move_to_sender&lt;T&gt;(move(t)); return; &#125; //å…è®¸äº¤æ˜“å‘é€è€…è®¤é¢†ä¸€æžšæŒ‡å®šç»™ä»–çš„ç¡¬å¸ã€‚ public claim_for_recipient(earmarked_coin_address: address): R#Self.T &#123; let t: R#Self.T; //è¿™é‡Œåˆ›å»ºTèµ„æºçš„å¼•ç”¨æ˜¯ä¸ºäº†é˜²æ­¢èµ„æºåªèƒ½è¢«moveä¸€æ¬¡ï¼Œassertä¹‹åŽè€Œä¸èƒ½è¿›è¡Œreturn let t_ref: &amp;R#Self.T; let sender: address; //ç§»é™¤æŒ‡å®šåœ°å€Tç±»åž‹çš„èµ„æºï¼Œå¦‚æžœæŒ‡å®šåœ°å€æ²¡æœ‰ç±»åž‹Tçš„èµ„æºï¼Œåˆ™å¤±è´¥ t = move_from&lt;T&gt;(move(earmarked_coin_address)); //æ‹¿åˆ°èµ„æºå¼•ç”¨ï¼Œæ–¹ä¾¿åŽç»­assert t_ref = &amp;t; //èŽ·å–æ­¤æ¬¡äº¤æ˜“å‘é€è€…è´¦æˆ· sender = get_txn_sender(); //ç¡®ä¿æ”¶æ¬¾è´¦æˆ·æ˜¯äº¤æ˜“å‘é€è€…ï¼Œå¦‚æžœæ–­è¨€å¤±è´¥ï¼Œåˆ™æ­¤æ¬¡äº¤æ˜“ä¸ä¼šé€ æˆä»»ä½•å½±å“ï¼Œ åŽŸå­æ“ä½œã€‚ //99æ˜¯ä¸€ä¸ªå†…éƒ¨æ–­è¨€ä½¿ç”¨çš„error code,ä¾¿äºŽäº¤æ˜“å¤±è´¥æ‰“å°äº‹ä»¶ assert(*(&amp;move(t_ref).recipient) == move(sender), 99); //è¿”å›žèŽ·å–åˆ°çš„èµ„æºï¼ŒæŽ¥ä¸‹æ¥åº”è¯¥ä½¿ç”¨unwarpèŽ·å–èµ„æºé‡Œé¢çš„Libra coinäº† return move(t); &#125; // å¦‚æžœBobçš„åœ°å€æ²¡æœ‰è¢«åˆ›å»ºï¼Œåˆ™Aliceå°†ä¼šå›žæ”¶æŽ‰è¯¥èµ„æº public claim_for_creator(): R#Self.T &#123; let t: R#Self.T; let coin: R#LibraCoin.T; let recipient: address; let sender: address; sender = get_txn_sender(); // This will fail if no resource of type T under the sender&apos;s address. t = move_from&lt;T&gt;(move(sender)); return move(t); &#125; // ä»ŽåŒ…è£…èµ„æºé‡Œé¢èŽ·å–åˆ°Libra coin,å¹¶å°†å®ƒè¿”å›žç»™è°ƒç”¨è€… public unwrap(t: R#Self.T): R#LibraCoin.T &#123; let coin: R#LibraCoin.T; let recipient: address; // å°†t èµ„æºè¿›è¡Œè§£åŒ…ï¼Œç”¨Tç±»åž‹åŽ»æŽ¥æ”¶ï¼Œåªæœ‰å£°æ˜Žäº†Tç±»åž‹çš„æ¨¡å—æ‰å¯ä»¥æŽ¥æ”¶è¿™ä¸ªèµ„æº T &#123; coin, recipient &#125; = move(t); //è¿”å›žlibra coinèµ„æº return move(coin); &#125;&#125; ä¸Šè¿°è¿‡ç¨‹å¯ä»¥ç»¼è¿°ä¸ºï¼šAliceå¯ä»¥åˆ›å»ºä¸€ä¸ªäº‹åŠ¡è„šæœ¬ï¼Œè°ƒç”¨createæ–¹æ³•ï¼Œå‚æ•°ä¸ºBobçš„åœ°å€å’Œlibra coinèµ„æºï¼Œä»Žè€Œä¸ºBobåˆ›å»ºä¸€ä¸ªæŒ‡å®šçš„coinåœ¨å¥¹çš„åœ°å€ä¸Šã€‚ä¸€æ—¦åˆ›å»ºäº†è¿™ä¸ªèµ„æº, Bobå°±å¯ä»¥é€šè¿‡ä»Žå‘é€äº‹åŠ¡æ¥å£°æ˜Žcoinã€‚è¿™å°†è°ƒç”¨claim_for_receiverï¼Œç„¶åŽå°†ç»“æžœä¼ é€’ç»™unwrapï¼Œå¹¶å°†è¿”å›žçš„LibraCoinå­˜å‚¨åœ¨ä»–å¸Œæœ›çš„ä»»ä½•åœ°æ–¹ã€‚å¦‚æžœBobèŠ±äº†å¤ªé•¿æ—¶é—´åœ¨åˆ›å»ºä¸€ä¸ªå¸æˆ·ä¸Šï¼Œè€ŒAliceæƒ³è¦æ”¶å›žå¥¹çš„èµ„é‡‘ï¼Œå¥¹å¯ä»¥ä½¿ç”¨claim_for_creatorå’Œunwrapã€‚å°†èµ„é‡‘å›žæ”¶ã€‚ rustå¼•ç”¨è¯´æ˜Žè¿™é‡Œé’ˆå¯¹ä¸Šè¿°ä¾‹å­æœ‰ä¸ªå…³äºŽrustå¼•ç”¨æˆ–è€…å€Ÿç”¨çš„è¯´æ˜Žï¼Œè¿™ä¹Ÿæ˜¯é’ˆå¯¹ç™½çš®ä¹¦é‡Œé¢çš„ä¸€äº›å¼•ç”¨å½¢å¼ç»™ä¸€ä¸ªè§£é‡Š 123456789let b = a; aç»‘å®šçš„èµ„æºAè½¬ç§»ç»™bï¼Œbæ‹¥æœ‰è¿™ä¸ªèµ„æºAlet b = &amp;a; aç»‘å®šçš„èµ„æºAå€Ÿç»™bä½¿ç”¨ï¼Œbåªæœ‰èµ„æºAçš„è¯»æƒé™let b = &amp;mut a; aç»‘å®šçš„èµ„æºAå€Ÿç»™bä½¿ç”¨ï¼Œbæœ‰èµ„æºAçš„è¯»å†™æƒé™let mut b = &amp;mut a; aç»‘å®šçš„èµ„æºAå€Ÿç»™bä½¿ç”¨ï¼Œbæœ‰èµ„æºAçš„è¯»å†™æƒé™ã€‚åŒæ—¶ï¼Œbå¯ç»‘å®šåˆ°æ–°çš„èµ„æºä¸Šé¢åŽ»(æ›´æ–°ç»‘å®šçš„èƒ½åŠ›)let &amp;mut b = &amp;mut a; a ç»‘å®šçš„èµ„æºAå€Ÿç»™bçš„å¼•ç”¨ä½¿ç”¨ï¼Œbçš„å¼•ç”¨æœ‰èµ„æºAçš„è¯»å†™æƒé™ã€‚åŒæ—¶bçš„å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°æ–°çš„èµ„æºä¸Šé¢åŽ»(æ›´æ–°ç»‘å®šèƒ½åŠ›)å¦‚æžœä¸€ä¸ªå€¼æœ‰äº†å¯å˜å¼•ç”¨ï¼Œåˆ™ä¸èƒ½å†æœ‰ä¸å˜å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å†…å®¹å¯ä»¥ä»”ç»†å‚è€ƒrustçš„å¼•ç”¨ä¸Žå€Ÿç”¨å…³ç³» ä¾‹å­è®²è§£ä¸‹é¢æˆ‘ä¼šæŠ½å–libra githubä»“åº“é‡Œé¢çš„ä¸€äº›å…¸åž‹çš„ä¾‹å­æ¥å¯¹moveè¿›è¡Œæ›´åŠ å…¨é¢çš„è§£é‡Šã€‚ ä¸‹é¢è¿™ä¸ªç¤ºä¾‹æ˜¯ä¸€ä¸ªmodule 1234module Signature &#123; native public ed25519_verify(signature: bytearray, public_key: bytearray, message: bytearray): bool;&#125;è¿™ä¸ªæ¨¡å—æ˜¯å®˜æ–¹çš„ç®—æ³•éªŒç­¾åæ¨¡å—ï¼Œæ­£å¦‚ç™½çš®ä¹¦é‡Œé¢è¯´å¾—åˆ°ï¼Œmoveè¯­è¨€å¯ä»¥ç›´æŽ¥è°ƒç”¨ä¸€äº›rustçš„å‡½æ•°å®žçŽ°ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºnavite,ç”¨naviteæ ‡è¯†ã€‚ ä¸‹é¢è¿™ä¸ªç¤ºä¾‹æ˜¯ä¸€ä¸ªscriptï¼Œç”±ä¸€ä¸ªmainè¿‡ç¨‹æž„æˆ 123456import 0x0.LibraAccount;main (new_key: bytearray) &#123; LibraAccount.rotate_authentication_key(move(new_key)); return;&#125;å®ƒå¼•å…¥äº†0x0åœ°å€(ç¼©å†™)ä¸Šçš„LibraAccountæ¨¡å—ï¼Œå¹¶è°ƒç”¨rotate_authentication_keyè¿‡ç¨‹ï¼Œæ›¿æ¢è´¦æˆ·èº«ä»½éªŒè¯å¯†é’¥ï¼Œè¿™ä¸ªä¸Žè´¦æˆ·åˆ›å»ºå¯†é’¥ä¸ä¸€æ ·ï¼Œè¿™ä¸ªå¯†é’¥æ˜¯ç”¨æ¥åˆ›å»ºäº¤æ˜“ç­¾åçš„ ä¸‹é¢è¿™ä¸ªç¤ºä¾‹æ˜¯ä¸€ä¸ªmodule + scriptï¼Œå®ƒä»¥modules:å¼€å§‹ï¼Œè¡¨æ˜Žmoduleçš„å¼€å§‹æ®µè½ï¼Œä»¥scriptå¼€å§‹äº‹åŠ¡è„šæœ¬æ®µè½ï¼Œäº‹åŠ¡è„šæœ¬å¯ä»¥ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„moduleã€‚ 1234567891011121314151617181920212223242526272829303132modules:module B &#123; struct T &#123;g: u64&#125; public new(g: u64): V#Self.T &#123; return T&#123;g: move(g)&#125;; &#125; public t(this: &amp;V#Self.T) &#123; let g: &amp;u64; let y: u64; g = &amp;copy(this).g; y = *move(g); //è¿™é‡Œå› ä¸ºthisèµ„æºæ²¡æœ‰å†æ¬¡è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥ä½¿ç”¨releaseå‡å°‘ä¸€æ¬¡å¼•ç”¨è®¡æ•° release(move(this)); return; &#125;&#125;script:import Transaction.B;main() &#123; let x: V#B.T; let y: &amp;V#B.T; x = B.new(5); y = &amp;x; B.t(move(y)); return;&#125; æŽ¥ä¸‹æ¥ä¸»è¦åˆ†æžä¸€ä¸‹ LibraCoin å’ŒLibraAccountè¿™ä¸¤ä¸ªå†…ç½®æ¨¡å— LibraCoin æ¨¡å—åˆ†æž123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102module LibraCoin &#123; // A resource representing the Libra coin resource T &#123; // The value of the coin. May be zero value: u64, &#125; // A resource that grants access to `LibraCoin.mint`. Only the Association account has one. resource MintCapability &#123;&#125; // Return a reference to the MintCapability published under the sender&apos;s account. Fails if thesender does not have a MintCapability. // Since only the Association account has a mint capability, this will only succeed if it is invoked by a transaction sent by that account. public borrow_sender_mint_capability(): &amp;R#Self.MintCapability &#123; let sender: address; //å¯å˜å¼•ç”¨ let capability_ref: &amp;mut R#Self.MintCapability; //ä¸å¯å˜å¼•ç”¨ let capability_immut_ref: &amp;R#Self.MintCapability; sender = get_txn_sender(); capability_ref = borrow_global&lt;MintCapability&gt;(move(sender)); //borrow_globalé»˜è®¤è¿”å›žå¯å˜å¼•ç”¨ï¼Œè¿™é‡Œä½¿ç”¨freezeéœ€è¦åŽ»é™¤å¯å˜æ€§ capability_immut_ref = freeze(move(capability_ref)); return move(capability_immut_ref); &#125; // mint ä¸€ä¸ªæ–°çš„LibraCoin.Tèµ„æºä»·å€¼ value, è°ƒç”¨è€…å¿…é¡»æœ‰ä¸€ä¸ªMintCapabilityçš„å¼•ç”¨ //åªæœ‰è”ç›Ÿæˆå‘˜è´¦æˆ·å¯ä»¥èŽ·å–è¿™æ ·çš„å¼•ç”¨ï¼Œè€Œä¸”åªèƒ½é€šè¿‡ borrow_sender_mint_capbailityæ–¹æ³•èŽ·å– public mint(value: u64, capability: &amp;R#Self.MintCapability): R#Self.T &#123; release(move(capability)); return T&#123;value: move(value)&#125;; &#125; //è¿™ä¸ªè¿‡ç¨‹æ˜¯ç§æœ‰çš„ï¼Œå› ä¸ºåªèƒ½è¢«è™šæ‹Ÿæœºå†…éƒ¨è°ƒç”¨å®ƒåªè¢«ä½¿ç”¨ //åœ¨åˆ›ä¸–çºªåˆ›å»ºwritesetæ—¶ï¼Œä¸ºè”ç›Ÿå¸æˆ·æä¾›å•ä¸ªmintability grant_mint_capability() &#123; move_to_sender&lt;MintCapability&gt;(MintCapability&#123;&#125;); return; &#125; // Create a new LibraCoin.T with a value of 0 public zero(): R#Self.T &#123; return T&#123;value: 0&#125;; &#125; //å…¬å¼€coinæ•°å€¼çš„è®¿é—®æ–¹æ³• public value(coin_ref: &amp;R#Self.T): u64 &#123; return *&amp;move(coin_ref).value; &#125; // å°† coinåˆ†ä¸ºä¸¤åŠï¼Œä¸€åŠæ˜¯ç»™å®šæ•°å€¼ï¼Œä¸€èˆ¬æ˜¯å‰©ä½™æ•°å€¼ public split(coin: R#Self.T, amount: u64): R#Self.T * R#Self.T &#123; let other: R#Self.T; other = Self.withdraw(&amp;mut coin, move(amount)); return move(coin), move(other); &#125; //ä»Žç»™å®šcoinèµ„æºä¸­åˆ’åˆ†å‡ºamountæ•°é‡çš„èµ„æºï¼Œå¹¶å°†æ–°åˆ›å»ºçš„èµ„æºè¿”å›ž public withdraw(coin_ref: &amp;mut R#Self.T, amount: u64): R#Self.T &#123; let value: u64; // Check that `amount` is less than the coin&apos;s value value = *(&amp;mut copy(coin_ref).value); assert(copy(value) &gt;= copy(amount), 10); // ç›´æŽ¥åœ¨åŽŸæ¥çš„å€¼ä¸Šé¢åˆ†å‰² *(&amp;mut move(coin_ref).value) = move(value) - copy(amount); return T&#123;value: move(amount)&#125;; &#125; // åˆå¹¶ä¸¤ä¸ªåŒæ ·çš„coinèµ„æºï¼Œå¹¶å°†æ–°çš„èµ„æºè¿”å›ž public join(coin1: R#Self.T, coin2: R#Self.T): R#Self.T &#123; Self.deposit(&amp;mut coin1, move(coin2)); return move(coin1); &#125; // &quot;Merges&quot; the two coins check æ˜¯éœ€è¦åˆå¹¶åœ¨coin_refä¸Šçš„èµ„æº public deposit(coin_ref: &amp;mut R#Self.T, check: R#Self.T) &#123; let value: u64; let check_value: u64; value = *(&amp;mut copy(coin_ref).value); T &#123; value: check_value &#125; = move(check); *(&amp;mut move(coin_ref).value)= move(value) + move(check_value); return; &#125; //é”€æ¯ä¸€ä¸ªå€¼ä¸º0çš„èµ„æºï¼Œä¸èƒ½é”€æ¯ä¸€ä¸ªéž0å€¼çš„èµ„æº public destroy_zero(coin: R#Self.T) &#123; let value: u64; T &#123; value &#125; = move(coin); assert(move(value) == 0, 11); return; &#125; //ä¸´æ—¶çš„ç¨‹åºï¼Œå°†æ¥å°†ä¼šè¢«å–æ¶ˆï¼Œæ­¤ç¨‹åºä¸»è¦æ˜¯ç”¨æ¥ä»Žè´¦æˆ·æ¶ˆè€—ä¸€å®šçš„æ‰‹ç»­è´¹ public TODO_REMOVE_burn_gas_fee(coin: R#Self.T) &#123; let value: u64; T &#123; value &#125; = move(coin); return; &#125;&#125; LibraAccountæ¨¡å—åˆ†æž123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302//è¿™ä¸ªæ¨¡å—ä¸»è¦æ˜¯å¾ˆå¯¹è´¦æˆ·èµ„æºçš„ï¼Œç”¨äºŽç®¡ç†æ¯ä¸ªLibraè´¦æˆ·//å¯ä»¥çœ‹åˆ°ä»–å¼•ç”¨äº†module LibraAccount &#123; import 0x0.LibraCoin; import 0x00.Hash; //æ¯ä¸ªLibraè´¦æˆ·éƒ½æœ‰ä¸€ä¸ªLibraAccount.Tèµ„æº // Every Libra account has a LibraLibraAccount.T resource resource T &#123; // The coins stored in this account balance: R#LibraCoin.T, //å½“å‰çš„èº«ä»½è®¤è¯key //è¿™ä¸ªkeyå¯ä»¥ä¸Žåˆ›å»ºè´¦æˆ·çš„keyä¸åŒ authentication_key: bytearray, //è´¦æˆ·nonce sequence_number: u64, //ä¸´æ—¶çš„å‘é€äº¤æ˜“äº‹ä»¶è®¡æ•°å™¨ï¼Œç­‰åˆ°åŽé¢äº‹ä»¶ç³»ç»Ÿè¢«å®Œå–„åŽï¼Œè¿™ä¸ªå€¼åº”è¯¥ä¼šè¢«ä»£æ›¿ sent_events_count: u64, //ä¸´æ—¶çš„äº¤æ˜“æŽ¥æ”¶äº‹ä»¶è®¡æ•°å™¨ï¼Œç­‰åˆ°åŽé¢äº‹ä»¶ç³»ç»Ÿè¢«å®Œå–„åŽï¼Œè¿™ä¸ªå€¼åº”è¯¥ä¼šè¢«ä»£æ›¿ received_events_count: u64 &#125; // Message for sent events struct SentPaymentEvent &#123; // The address that was paid payee: address, // The amount of LibraCoin.T sent amount: u64, &#125; // Message for received events struct ReceivedPaymentEvent &#123; // The address that sent the coin payer: address, // The amount of LibraCoin.T received amount: u64, &#125; //åˆ›å»ºä¸€ä¸ªæ–°çš„LibraAccount.Tç±»åž‹çš„èµ„æº //è¿™ä¸ªè¿‡ç¨‹è¢«å†…ç½®æ¨¡å—create_accountè°ƒç”¨ make(auth_key: bytearray): R#Self.T &#123; let zero_balance: R#LibraCoin.T; zero_balance = LibraCoin.zero(); return T &#123; balance: move(zero_balance), authentication_key: move(auth_key), sequence_number: 0, sent_events_count: 0, received_events_count: 0, &#125;; &#125; // å‘payeeè´¦æˆ·å­˜å…¥to_depositèµ„æº public deposit(payee: address, to_deposit: R#LibraCoin.T) &#123; let deposit_value: u64; let payee_account_ref: &amp;mut R#Self.T; let sender: address; let sender_account_ref: &amp;mut R#Self.T; let sent_event: V#Self.SentPaymentEvent; let received_event: V#Self.ReceivedPaymentEvent; // Check that the `to_deposit` coin is non-zero deposit_value = LibraCoin.value(&amp;to_deposit); assert(copy(deposit_value) &gt; 0, 7); // Load the sender&apos;s account sender = get_txn_sender(); sender_account_ref = borrow_global&lt;T&gt;(copy(sender)); // Log a send event sent_event = SentPaymentEvent &#123; payee: copy(payee), amount: copy(deposit_value) &#125;; // ç›®å‰çš„æ‰“å°äº‹ä»¶åªæ˜¯ä¸´æ—¶ä¹‹ä¸¾ï¼Œæœªæ¥åº”è¯¥ä¼šå˜å¾—æ›´åŠ æœ‰æ¡ç† emit_event(&amp;mut move(sender_account_ref).sent_events_count, b&quot;73656E745F6576656E74735F636F756E74&quot;, move(sent_event)); // Load the payee&apos;s account payee_account_ref = borrow_global&lt;T&gt;(move(payee)); // Deposit the `to_deposit` coin LibraCoin.deposit(&amp;mut copy(payee_account_ref).balance, move(to_deposit)); // Log a received event received_event = ReceivedPaymentEvent &#123; payer: move(sender), amount: move(deposit_value) &#125;; // TEMPORARY The events system is being overhauled and this will be replaced by something // more principled in the future emit_event(&amp;mut move(payee_account_ref).received_events_count, b&quot;72656365697665645F6576656E74735F636F756E74&quot;, move(received_event)); return; &#125; //mint_to-address åªèƒ½è¢«åˆæœ‰mintèƒ½åŠ›çš„çš„è´¦æˆ·ä½¿ç”¨(å‚ç…§LibraCoinæ¨¡å—) //è¿™äº›å¸æˆ·å°†è¢«æ”¶å–gasè´¹ç”¨ã€‚å¦‚æžœè¿™äº›å¸æˆ·æ²¡æœ‰è¶³å¤Ÿçš„gasæ”¯ä»˜,åˆ™mintå¤±è´¥ // é‚£äº›è´¦æˆ·ä¹Ÿå¯ä»¥mintç»™è‡ªå·±coin public mint_to_address(payee: address, amount: u64) &#123; let mint_capability_ref: &amp;R#LibraCoin.MintCapability; let coin: R#LibraCoin.T; let payee_account_ref: &amp;mut R#Self.T; let payee_exists: bool; let sender: address; // Mint the coin mint_capability_ref = LibraCoin.borrow_sender_mint_capability(); coin = LibraCoin.mint(copy(amount), move(mint_capability_ref)); // Create an account if it does not exist payee_exists = exists&lt;T&gt;(copy(payee)); if (!move(payee_exists)) &#123; //è¿™ä¸€è¡Œæ„Ÿè§‰æ²¡å¿…è¦ sender = get_txn_sender(); Self.create_new_account(copy(payee), 0); &#125; // Deposit the minted `coin` Self.deposit(move(payee), move(coin)); return; &#125; // Helper to withdraw `amount` from the given `account` and return the resulting LibraCoin.T withdraw_from_account(account: &amp;mut R#Self.T, amount: u64): R#LibraCoin.T &#123; let to_withdraw: R#LibraCoin.T; to_withdraw = LibraCoin.withdraw(&amp;mut move(account).balance, copy(amount)); return move(to_withdraw); &#125; // Withdraw `amount` LibraCoin.T from the transaction sender&apos;s account public withdraw_from_sender(amount: u64): R#LibraCoin.T &#123; let sender: address; let sender_account: &amp;mut R#Self.T; let to_withdraw: R#LibraCoin.T; // Load the sender sender = get_txn_sender(); sender_account = borrow_global&lt;T&gt;(move(sender)); // Withdraw the coin to_withdraw = Self.withdraw_from_account(move(sender_account), move(amount)); return move(to_withdraw); &#125; //ä»Žå‘é€è€…è´¦æˆ·è½¬ç§»èµ„é‡‘åˆ°æŽ¥å—è€…ï¼Œå¦‚æžœå‘é€è€…è´¦æˆ·ä¸å­˜åœ¨ï¼Œå…ˆåˆ›å»ºè´¦æˆ·ï¼Œç„¶åŽå†è°ƒç”¨æ­¤è¿‡ç¨‹ public pay_from_sender(payee: address, amount: u64) &#123; let to_pay: R#LibraCoin.T; let payee_exists: bool; payee_exists = exists&lt;T&gt;(copy(payee)); if (move(payee_exists)) &#123; to_pay = Self.withdraw_from_sender(move(amount)); Self.deposit(move(payee), move(to_pay)); &#125; else &#123; Self.create_new_account(move(payee), move(amount)); &#125; return; &#125; //æ›´æ–°äº¤æ˜“å‘é€è€…èº«ä»½è®¤è¯key //æ–°çš„keyå°†ä¼šè¢«ç”¨äºŽäº¤æ˜“ç­¾å public rotate_authentication_key(new_authentication_key: bytearray) &#123; let sender: address; let sender_account: &amp;mut R#Self.T; sender = get_txn_sender(); sender_account = borrow_global&lt;T&gt;(move(sender)); *(&amp;mut move(sender_account).authentication_key) = move(new_authentication_key); return; &#125; //åˆ›å»ºä¸€ä¸ªæ–°çš„è´¦æˆ·ï¼Œå¦‚æžœåˆå§‹èµ„é‡‘&gt;0ï¼Œåˆ™ä»Žäº¤æ˜“å‘é€è€…è´¦æˆ·è½¬ç§»èµ„é‡‘åˆ°æ–°è´¦æˆ· public create_new_account(fresh_address: address, initial_balance: u64) &#123; create_account(copy(fresh_address)); if (copy(initial_balance) &gt; 0) &#123; Self.pay_from_sender(move(fresh_address), move(initial_balance)); &#125; return; &#125; // Helper to return u64 value of the `balance` field for given `account` balance_for_account(account: &amp;R#Self.T): u64 &#123; let balance_value: u64; balance_value = LibraCoin.value(&amp;move(account).balance); return move(balance_value); &#125; // Return the current balance of the LibraCoin.T in LibraLibraAccount.T at `addr` public balance(addr: address): u64 &#123; let payee_account: &amp;mut R#Self.T; let imm_payee_account: &amp;R#Self.T; let balance_amount: u64; //ä»Žè´¦æˆ·åœ°å€ï¼Œæ‹¿åˆ°LibraAccountç±»åž‹çš„èµ„æºï¼Œæ­¤æ—¶æ‹¿åˆ°çš„èµ„æºæ˜¯å¯å˜çš„ payee_account = borrow_global&lt;T&gt;(move(addr)); //å°†èµ„æºè½¬ä¸ºä¸å¯å˜èµ„æºï¼Œé˜²æ­¢è¯¯æ“ä½œ imm_payee_account = freeze(move(payee_account)); balance_amount = Self.balance_for_account(move(imm_payee_account)); return move(balance_amount); &#125; // Helper to return the sequence number field for given `account` sequence_number_for_account(account: &amp;R#Self.T): u64 &#123; return *(&amp;move(account).sequence_number); &#125; // Return the current sequence number at `addr` public sequence_number(addr: address): u64 &#123; let account_ref: &amp;mut R#Self.T; let imm_ref: &amp;R#Self.T; let sequence_number_value: u64; account_ref = borrow_global&lt;T&gt;(move(addr)); imm_ref = freeze(move(account_ref)); sequence_number_value = Self.sequence_number_for_account(move(imm_ref)); return move(sequence_number_value); &#125; // Checks if an account exists at `check_addr` public exists(check_addr: address): bool &#123; let is_present: bool; is_present = exists&lt;T&gt;(move(check_addr)); return move(is_present); &#125; // åºè¨€è¿‡ç¨‹åœ¨æ¯ç¬”äº¤æ˜“å¼€å§‹çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œå®ƒè¦åšä»¥ä¸‹éªŒè¯ï¼š //è´¦æˆ·çš„èº«ä»½keyæ˜¯å¦åŒ¹é…äº¤æ˜“çš„å…¬é’¥ //è´¦æˆ·æ˜¯å¦æœ‰è¶³å¤Ÿçš„é‡‘é¢æ”¯ä»˜æ‰€æœ‰çš„gas //sequence numberæ˜¯å¦åŒ¹é…å½“å‰è´¦æˆ·sequence key prologue() &#123; let transaction_sender: address; let transaction_sender_exists: bool; let sender_account: &amp;mut R#Self.T; let imm_sender_account: &amp;R#Self.T; let sender_public_key: bytearray; let public_key_hash: bytearray; let gas_price: u64; let gas_units: u64; let gas_fee: u64; let balance_amount: u64; let sequence_number_value: u64; let transaction_sequence_number_value: u64; transaction_sender = get_txn_sender(); // çŽ°åœ¨è¿™äº›error codeè¿˜æ˜¯å¾ˆä¸å‹å¥½çš„ï¼ŒåŽç»­åº”è¯¥ä¼šå˜å¾—æ›´å¥½ transaction_sender_exists = exists&lt;T&gt;(copy(transaction_sender)); assert(move(transaction_sender_exists), 5); // Load the transaction sender&apos;s account sender_account = borrow_global&lt;T&gt;(copy(transaction_sender)); //æ£€æŸ¥äº¤æ˜“çš„å…¬é’¥æ˜¯å¦ä¸Žå½“å‰è´¦æˆ·çš„èº«ä»½keyç›¸åŒ¹é… sender_public_key = get_txn_public_key(); public_key_hash = Hash.sha3_256(move(sender_public_key)); assert(move(public_key_hash) == *(&amp;copy(sender_account).authentication_key), 2); // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ä½™é¢æ”¯ä»˜äº¤æ˜“æ‰‹ç»­è´¹ gas_price = get_txn_gas_unit_price(); gas_units = get_txn_max_gas_units(); //å…ˆè®¡ç®—æœ€å¤§æ‰€éœ€çš„æ‰‹ç»­è´¹,åœ¨äº¤æ˜“ç»“æŸåŽè¿›è¡Œæ‰£é™¤çœŸå®žæ¶ˆè€—çš„gasæ‰‹ç»­è´¹ gas_fee = move(gas_price) * move(gas_units); imm_sender_account = freeze(copy(sender_account)); balance_amount = Self.balance_for_account(move(imm_sender_account)); assert(move(balance_amount) &gt;= move(gas_fee), 6); // æ£€æŸ¥äº¤æ˜“çš„sequence numberæ˜¯å¦ä¸Žè´¦æˆ·ä¿å­˜çš„sequence numberåŒ¹é… sequence_number_value = *(&amp;mut move(sender_account).sequence_number); transaction_sequence_number_value = get_txn_sequence_number(); //è¿™é‡Œå¤šåˆ¤æ–­ä¸€æ¬¡å¯èƒ½æ˜¯æœªæ¥é˜²æ­¢å¹¶è¡Œäº¤æ˜“çš„æ—¶å€™è¾ƒå¤§sequence numberå¯ä»¥è¢«æŽ¥å— assert(copy(transaction_sequence_number_value) &gt;= copy(sequence_number_value), 3); assert(move(transaction_sequence_number_value) == move(sequence_number_value), 4); return; &#125; // æ”¶å°¾ä¸»è¦æ˜¯è¢«ç”¨äºŽåœ¨äº¤æ˜“ç»“æŸåŽè¿›è¡Œä¸€äº›å¤„ç† //ä¸»è¦æ˜¯è®¡ç®—äº¤æ˜“çœŸå®žæ¶ˆè€—gasçš„æ‰‹ç»­è´¹å’Œè°ƒæ•´è´¦æˆ·sequence number // The epilogue is invoked at the end of transactions. // It collects gas and bumps the sequence number epilogue() &#123; let transaction_sender: address; let sender_account: &amp;mut R#Self.T; let imm_sender_account: &amp;R#Self.T; let gas_price: u64; let gas_units_remaining: u64; let starting_gas_units: u64; let gas_fee_amount: u64; let balance_amount: u64; let gas_fee: R#LibraCoin.T; let transaction_sequence_number_value: u64; transaction_sender = get_txn_sender(); // Load the transaction sender&apos;s account sender_account = borrow_global&lt;T&gt;(copy(transaction_sender)); //æ”¶å–çœŸå®žæ¶ˆè€—çš„gasçš„æ‰‹ç»­è´¹ gas_price = get_txn_gas_unit_price(); starting_gas_units = get_txn_max_gas_units(); gas_units_remaining = get_gas_remaining(); gas_fee_amount = move(gas_price) * (move(starting_gas_units) - move(gas_units_remaining)); imm_sender_account = freeze(copy(sender_account)); balance_amount = Self.balance_for_account(move(imm_sender_account)); assert(move(balance_amount) &gt;= copy(gas_fee_amount), 6); gas_fee = Self.withdraw_from_account(copy(sender_account), move(gas_fee_amount)); //é”€æ¯æŽ‰ç›¸åº”çš„æ‰‹ç»­è´¹èµ„æº LibraCoin.TODO_REMOVE_burn_gas_fee(move(gas_fee)); // è´¦æˆ·sequence number + 1 transaction_sequence_number_value = get_txn_sequence_number(); *(&amp;mut move(sender_account).sequence_number) = move(transaction_sequence_number_value) + 1; return; &#125;&#125;]]></content>
      <categories>
        <category>libra</category>
        <category>moveè¯­è¨€</category>
      </categories>
      <tags>
        <tag>libra</tag>
        <tag>moveè¯­è¨€</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Move:ä¸€ç§å¯ç¼–ç¨‹èµ„æºè¯­è¨€]]></title>
    <url>%2F2019%2F07%2F10%2Flibra-move-paper%2F</url>
    <content type="text"><![CDATA[Move:ä¸€ç§å¯ç¼–ç¨‹èµ„æºè¯­è¨€Abstract. æˆ‘ä»¬ä¸ºLibraåŒºå—é“¾æä¾›äº†ä¸€ç§å®‰å…¨çµæ´»çš„ç¼–ç¨‹è¯­è¨€Moveï¼Œ Moveæ˜¯ä¸€ç§å¯æ‰§è¡Œçš„å­—èŠ‚ç è¯­è¨€ï¼Œç”¨äºŽå®žçŽ°è‡ªå®šä¹‰äº‹åŠ¡å’Œæ™ºèƒ½åˆçº¦ã€‚Moveçš„å…³é”®ç‰¹æ€§æ˜¯èƒ½å¤Ÿä½¿ç”¨å—linearå¯å‘çš„è¯­ä¹‰å®šä¹‰è‡ªå®šä¹‰èµ„æºç±»åž‹ã€‚èµ„æºæ°¸è¿œä¸èƒ½è¢«å¤åˆ¶æˆ–è€…è¢«éšå¼ä¸¢å¼ƒï¼Œåªèƒ½åœ¨ç¨‹åºçš„å­˜å‚¨ä½ç½®é—´ç§»åŠ¨ã€‚è¿™äº›å®‰å…¨ä¿è¯ç”±Moveçš„ç±»åž‹ç³»ç»Ÿé™æ€æ‰§è¡Œï¼Œå°½ç®¡æœ‰è¿™äº›ç‰¹æ®Šä¿æŠ¤ï¼Œèµ„æºä»ç„¶æ˜¯ä¸€ç§æ™®é€šçš„ç¨‹åºå€¼ï¼Œå®ƒä»¬å¯ä»¥å­˜å‚¨åœ¨æ•°æ®ç»“æž„ä¸­ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¤„ç†é€»è¾‘ï¼Œç­‰ç­‰ã€‚èµ„æºä¼˜å…ˆæ˜¯ä¸€ç§å¾ˆæ™®éçš„è§‚å¿µã€‚ç¨‹åºå‘˜ä¸ä»…å¯ä»¥å®žçŽ°å®‰å…¨çš„æ•°å­—èµ„äº§ï¼Œè¿˜å¯ä»¥ç¼–å†™æ­£ç¡®çš„ä¸šåŠ¡ç”¨äºŽåŒ…è£…èµ„äº§å’Œå¼ºåˆ¶è®¿é—®æŽ§åˆ¶ç­–ç•¥çš„é€»è¾‘ã€‚Moveçš„å®‰å…¨æ€§å’Œè¡¨è¾¾æ€§ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨Moveä¸­å®žçŽ°Libraåè®®çš„é‡è¦éƒ¨åˆ†ï¼ŒåŒ…æ‹¬Libra Coinï¼Œäº‹åŠ¡å¤„ç†å’ŒéªŒè¯å™¨ç®¡ç†. ä»‹ç»äº’è”ç½‘å’Œç§»åŠ¨å®½å¸¦çš„å‡ºçŽ°è¿žæŽ¥äº†å…¨çƒæ•°åäº¿äººï¼Œä¸ºä»–ä»¬æä¾›äº†èŽ·å–çŸ¥è¯†ã€å…è´¹é€šä¿¡ä»¥åŠä¸€ç³»åˆ—æ›´ä½Žæˆæœ¬ã€æ›´ä¾¿æ·çš„æœåŠ¡ã€‚è¿™ç§äº’è”äº’é€šä¹Ÿä½¿æ›´å¤šçš„äººèƒ½å¤Ÿè¿›å…¥é‡‘èžç”Ÿæ€ç³»ç»Ÿã€‚ç„¶è€Œï¼Œå°½ç®¡å–å¾—äº†è¿™äº›è¿›å±•ï¼Œå¯¹é‚£äº›æœ€éœ€è¦é‡‘èžæœåŠ¡çš„äººæ¥è¯´ï¼ŒèŽ·å¾—é‡‘èžæœåŠ¡çš„æœºä¼šä»ç„¶æœ‰é™ã€‚ Libraçš„ä»»åŠ¡æ˜¯æ”¹å˜è¿™ç§çŠ¶å†µã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°çš„ç¼–ç¨‹è¯­è¨€Moveï¼Œç”¨äºŽåœ¨Libraåè®®ä¸­å®žçŽ°è‡ªå®šä¹‰äº‹åŠ¡é€»è¾‘å’Œæ™ºèƒ½åˆçº¦ã€‚ä¸ºä»‹ç»Moveï¼Œæˆ‘ä»¬: æè¿°åœ¨åŒºå—é“¾ä¸Šè¡¨ç¤ºæ•°å­—èµ„äº§çš„æŒ‘æˆ˜ (ç¬¬äºŒèŠ‚). è§£é‡Šæˆ‘ä»¬çš„Moveè®¾è®¡å¦‚ä½•è§£å†³è¿™äº›æŒ‘æˆ˜ (ç¬¬ä¸‰èŠ‚). ç»™å‡ºä¸€ä¸ªæ ·ä¾‹ç”¨ä»¥æ¦‚è¿°Moveçš„ä¸»è¦ç‰¹æ€§å’Œç¼–ç¨‹æ¨¡åž‹ (ç¬¬å››èŠ‚). æ·±å…¥ç ”ç©¶è¯­è¨€å’Œè™šæ‹Ÿæœºè®¾è®¡çš„æŠ€æœ¯ç»†èŠ‚ (ç¬¬äº”èŠ‚, ç¬¬å…­èŠ‚,å’Œé™„å½•A). æœ€åŽï¼Œæ€»ç»“ä¸€ä¸‹æˆ‘ä»¬åœ¨Moveæ–¹é¢å–å¾—çš„è¿›å±•ï¼Œæè¿°æˆ‘ä»¬çš„è¯­è¨€å‘å±•è®¡åˆ’ï¼Œå¹¶æ¦‚è¿°æˆ‘ä»¬åœ¨LibraåŒºå—é“¾ä¸Šæ”¯æŒç¬¬ä¸‰æ–¹Moveä»£ç çš„è·¯çº¿å›¾ è§‚ä¼— æœ¬æ–‡é’ˆå¯¹ä¸¤ç§ä¸åŒçš„å—ä¼—ç¾¤ä½“: ä¸ç†Ÿæ‚‰åŒºå—é“¾ç³»ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ç ”ç©¶äººå‘˜ã€‚æˆ‘ä»¬é¼“åŠ±è¿™äº›è¯»è€…ä»Žå¤´åˆ°å°¾é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œä½†æ˜¯æˆ‘ä»¬è­¦å‘Šè¯´ï¼Œæˆ‘ä»¬æœ‰æ—¶å¯èƒ½åœ¨æ²¡æœ‰ä¸ºä¸ç†Ÿæ‚‰çš„è¯»è€…æä¾›è¶³å¤Ÿä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹å¼•ç”¨åŒºå—é“¾æ¦‚å¿µã€‚ åŒºå—é“¾å¼€å‘äººå‘˜å¯èƒ½ä¸ç†Ÿæ‚‰ç¼–ç¨‹è¯­è¨€çš„ç ”ç©¶ï¼Œä½†æœ‰å…´è¶£å­¦ä¹ ç§»åŠ¨è¯­è¨€ã€‚æˆ‘ä»¬é¼“åŠ±è§‚ä¼—ä»Žè¿™é‡Œå¼€å§‹(ç¬¬ä¸‰èŠ‚)ã€‚æˆ‘ä»¬æ³¨æ„ï¼Œç¬¬5ã€ç¬¬6éƒ¨åˆ†å’Œé™„å½•Aä¸­åŒ…å«ä¸€äº›ç¼–ç¨‹è¯­è¨€æœ¯è¯­å’Œå½¢å¼åŒ–ï¼Œè¿™äº›æœ¯è¯­å’Œå½¢å¼åŒ–å¯èƒ½æ˜¯ä¸ç†Ÿæ‚‰çš„ã€‚ åœ¨åŒºå—é“¾ä¸Šç®¡ç†æ•°å­—èµ„äº§æˆ‘ä»¬å°†ä»ŽæŠ½è±¡å±‚æ¬¡ç®€è¦è§£é‡ŠåŒºå—é“¾å¼€å§‹ï¼Œä»¥å¸®åŠ©è¯»è€…ç†è§£åƒMoveè¿™æ ·çš„â€œåŒºå—é“¾ç¼–ç¨‹è¯­è¨€â€æ‰€æ‰®æ¼”çš„è§’è‰²ã€‚æœ¬è®¨è®ºæœ‰æ„çœç•¥äº†åŒºå—é“¾ç³»ç»Ÿçš„è®¸å¤šé‡è¦ç»†èŠ‚ï¼Œä»¥ä¾¿é›†ä¸­è®¨è®ºä¸Žè¯­è¨€è§’åº¦ç›¸å…³çš„ç‰¹æ€§ã€‚ åŒºå—é“¾çš„æŠ½è±¡è§†å›¾åŒºå—é“¾æ˜¯ä¸€ä¸ªå¤åˆ¶çŠ¶æ€æœºã€‚ç³»ç»Ÿä¸­çš„å¤åˆ¶å™¨ç§°ä¸ºéªŒè¯å™¨ã€‚ç³»ç»Ÿç”¨æˆ·å‘éªŒè¯å™¨å‘é€äº‹åŠ¡ã€‚æ¯ä¸ªéªŒè¯å™¨éƒ½äº†è§£å¦‚ä½•æ‰§è¡Œäº‹åŠ¡ï¼Œä»¥ä¾¿å°†å…¶å†…éƒ¨çŠ¶æ€æœºä»Žå½“å‰çŠ¶æ€è½¬æ¢åˆ°æ–°çŠ¶æ€. éªŒè¯å™¨åˆ©ç”¨å®ƒä»¬å¯¹äº‹åŠ¡æ‰§è¡Œçš„å…±äº«ç†è§£ï¼Œéµå¾ªä¸€è‡´åè®®æ¥é›†ä½“å®šä¹‰å’Œç»´æŠ¤å¤åˆ¶çŠ¶æ€ã€‚å¦‚æžœ éªŒè¯å™¨ä»Žç›¸åŒçš„åˆå§‹çŠ¶æ€å¼€å§‹ï¼Œ éªŒè¯å™¨å°±ä¸‹ä¸€ä¸ªäº‹åŠ¡åº”è¯¥æ˜¯ä»€ä¹ˆè¾¾æˆä¸€è‡´, éªŒè¯å™¨ä¼šäº§ç”Ÿç¡®å®šçš„çŠ¶æ€è½¬æ¢ ç„¶åŽéªŒè¯å™¨è¿˜å°†å¯¹ä¸‹ä¸€ä¸ªçŠ¶æ€è¾¾æˆä¸€è‡´ã€‚åå¤åº”ç”¨æ­¤æ–¹æ¡ˆå…è®¸éªŒè¯å™¨å¤„ç†äº‹åŠ¡ï¼ŒåŒæ—¶ç»§ç»­å°±å½“å‰çŠ¶æ€è¾¾æˆä¸€è‡´ã€‚ æ³¨æ„ï¼Œåå•†ä¸€è‡´åè®®å’ŒçŠ¶æ€è½¬æ¢ç»„ä»¶å¯¹å½¼æ­¤çš„å®žçŽ°ç»†èŠ‚å¹¶ä¸æ•æ„Ÿã€‚åªè¦åå•†ä¸€è‡´åè®®ç¡®ä¿äº‹åŠ¡ä¹‹é—´çš„æ€»é¡ºåºå’ŒçŠ¶æ€è½¬æ¢æ–¹æ¡ˆæ˜¯ç¡®å®šçš„ï¼Œç»„ä»¶å°±å¯ä»¥å’Œè°åœ°äº¤äº’ã€‚ åœ¨å¼€æ”¾ç³»ç»Ÿä¸­ç¼–ç æ•°å­—èµ„äº§åƒMoveè¿™æ ·çš„åŒºå—é“¾ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨æ˜¯å†³å®šå¦‚ä½•è¡¨ç¤ºè½¬æ¢å’ŒçŠ¶æ€ã€‚ä¸ºäº†æ”¯æŒä¸°å¯Œçš„é‡‘èžåŸºç¡€è®¾æ–½ï¼ŒLibraçš„åŒºå—é“¾çŠ¶æ€å¿…é¡»èƒ½å¤Ÿåœ¨ç»™å®šçš„æ—¶é—´ç‚¹å¯¹æ•°å­—èµ„äº§çš„æ‰€æœ‰è€…è¿›è¡Œç¼–ç ã€‚æ­¤å¤–ï¼ŒçŠ¶æ€è½¬æ¢åº”è¯¥å…è®¸èµ„äº§çš„è½¬ç§»ã€‚ åœ¨åŒºå—é“¾ç¼–ç¨‹è¯­è¨€çš„è®¾è®¡ä¸­å¿…é¡»è€ƒè™‘å¦ä¸€ä¸ªå› ç´ ã€‚ä¸Žå…¶ä»–å…¬å…±åŒºå—é“¾ä¸€æ ·ï¼ŒLibraåŒºå—é“¾æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç³»ç»Ÿ,ä»»ä½•äººéƒ½å¯ä»¥æŸ¥çœ‹å½“å‰çš„åŒºå—é“¾çŠ¶æ€æˆ–å°†äº‹åŠ¡æäº¤ç»™éªŒè¯å™¨(å³ï¼Œå»ºè®®çŠ¶æ€è½¬æ¢)ã€‚ä¼ ç»Ÿä¸Šï¼Œç®¡ç†æ•°å­—èµ„äº§çš„è½¯ä»¶(å¦‚é“¶è¡Œè½¯ä»¶)æ˜¯åœ¨ä¸€ä¸ªå°é—­çš„ç³»ç»Ÿä¸­è¿è¡Œçš„ï¼Œå…·æœ‰ç‰¹æ®Šç®¡ç†æŽ§åˆ¶.æ‰€æœ‰å‚ä¸Žè€…åœ°ä½å¹³ç­‰ã€‚å‚ä¸Žè€…å¯ä»¥æå‡ºä»»ä½•å¥¹å–œæ¬¢çš„çŠ¶æ€è½¬æ¢ï¼Œä½†æ˜¯ç³»ç»Ÿä¸åº”è¯¥å…è®¸æ‰€æœ‰çš„çŠ¶æ€è½¬æ¢ã€‚ä¾‹å¦‚ï¼ŒAliceå¯ä»¥è‡ªç”±åœ°æå‡ºä¸€ä¸ªè½¬ç§»Bobæ‹¥æœ‰çš„èµ„äº§çš„çŠ¶æ€è½¬æ¢ã€‚çŠ¶æ€è½¬æ¢å‡½æ•°å¿…é¡»èƒ½å¤Ÿè¯†åˆ«æ­¤çŠ¶æ€è½¬æ¢æ— æ•ˆå¹¶æ‹’ç»å®ƒ. åœ¨ä¸€ä¸ªå¼€æ”¾çš„è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œé€‰æ‹©è½¬æ¢å’ŒçŠ¶æ€çš„è¡¨ç¤ºå½¢å¼æ¥ç¼–ç æ•°å­—èµ„äº§çš„æ‰€æœ‰æƒæ˜¯å¾ˆæœ‰æŒ‘æˆ˜æ€§çš„ã€‚ç‰¹åˆ«æ˜¯ï¼Œç‰©ç†èµ„äº§æœ‰ä¸¤ä¸ªå±žæ€§å¾ˆéš¾åœ¨æ•°å­—èµ„äº§ä¸­ç¼–ç  ç¨€ç¼ºæ€§ã€‚åº”è¯¥æŽ§åˆ¶ç³»ç»Ÿä¸­çš„èµ„äº§ä¾›åº”ã€‚åº”è¯¥ç¦æ­¢å¤åˆ¶çŽ°æœ‰èµ„äº§ï¼Œåˆ›å»ºæ–°èµ„äº§åº”è¯¥æ˜¯ä¸€é¡¹ç‰¹æƒæ“ä½œã€‚ è®¿é—®æŽ§åˆ¶.ç³»ç»Ÿçš„å‚ä¸Žè€…åº”è¯¥èƒ½å¤Ÿé€šè¿‡è®¿é—®ç­–ç•¥ä¿æŠ¤æ¥è®¿é—®å¥¹çš„èµ„äº§ ä¸ºäº†ç›´è§‚çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¿™äº›é—®é¢˜æ˜¯å¦‚ä½•åœ¨è¡¨ç¤ºçŠ¶æ€è½¬æ¢çš„ä¸€ç³»åˆ—strawmanåŽŸåž‹ä¸­å‡ºçŽ°çš„ã€‚æˆ‘ä»¬å°†å‡è®¾åŒºå—é“¾è·Ÿè¸ªä¸€ä¸ªç§°ä¸ºStrawCoinçš„æ•°å­—èµ„äº§ï¼ŒåŒºå—é“¾çŠ¶æ€Gç»“æž„ä¸ºæ˜ å°„ç”¨æˆ·æ ‡è¯†çš„é”®å€¼å­˜å‚¨(ç”¨åŠ å¯†å…¬é’¥è¡¨ç¤º)åˆ°è‡ªç„¶æ•°å€¼ï¼Œè‡ªç„¶æ•°å€¼ç¼–ç æ¯ä¸ªç”¨æˆ·æŒæœ‰çš„ç¨»è‰å¸ææ¡ˆç”±ä¸€ä¸ªäº‹åŠ¡è„šæœ¬ç»„æˆï¼Œè¯¥è„šæœ¬å°†ä½¿ç”¨ç»™å®šçš„è¯„ä¼°è§„åˆ™è¿›è¡Œè¯„ä¼°ï¼Œç”Ÿæˆä¸€ä¸ªåº”ç”¨äºŽå…¨å±€çŠ¶æ€çš„æ›´æ–°ã€‚æˆ‘ä»¬å°†ç¼–å†™G[ð¾]:=ð‘› è¡¨ç¤ºå­˜å‚¨åœ¨å¯†é’¥ð¾åœ¨å…¨çƒåŒºå—é“¾çŠ¶æ€çš„ä»·å€¼ä¸ºnã€‚ æ¯ä¸ªææ¡ˆçš„ç›®æ ‡éƒ½æ˜¯è®¾è®¡ä¸€ä¸ªè¶³å¤Ÿæœ‰è¡¨çŽ°åŠ›çš„ç³»ç»Ÿï¼Œä½¿Aliceèƒ½å¤Ÿå‘é€StrawCoinåˆ°Bobï¼Œä½†å…¶é™åˆ¶è¶³ä»¥é˜²æ­¢ä»»ä½•ç”¨æˆ·è¿åç¨€ç¼ºæ€§æˆ–è®¿é—®æŽ§åˆ¶å±žæ€§ã€‚è¿™äº›æè®®å¹¶ä¸è¯•å›¾è§£å†³è¯¸å¦‚é‡æ”¾æ”»å‡»ä¹‹ç±»çš„å®‰å…¨é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å¾ˆé‡è¦ï¼Œä½†ä¸Žæˆ‘ä»¬è®¨è®ºçš„ç¨€ç¼ºæ€§å’Œè®¿é—®æŽ§åˆ¶æ— å…³ã€‚ ç¨€ç¼ºæ€§ã€‚ æœ€ç®€å•çš„å»ºè®®æ˜¯ç›´æŽ¥å°†æ›´æ–°ç¼–ç åˆ°äº‹åŠ¡è„šæœ¬ä¸­çš„çŠ¶æ€ è¿™ä¸ªè¡¨ç¤ºå¯ä»¥ç¼–ç å°†StrawCoinä»ŽAliceå‘é€åˆ°Bobã€‚ä½†å®ƒæœ‰å‡ ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚é¦–å…ˆï¼Œè¿™ä¸€æè®®å¹¶æ²¡æœ‰å¼ºåŒ–StrawCoinçš„ç¨€ç¼ºæ€§ã€‚Aliceèƒ½ç»™å°½å¯èƒ½å¤šçš„StrawCoinå¥¹é«˜å…´â€œå‡­ç©ºâ€é€šè¿‡å‘é€äº‹åŠ¡âŸ¨Alice,100âŸ©ã€‚å› æ­¤ï¼ŒAliceå‘é€ç»™Bobçš„StrawCoinå®žé™…ä¸Šæ˜¯æ²¡æœ‰ä»·å€¼çš„ï¼Œå› ä¸ºBobä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸ºè‡ªå·±åˆ›å»ºè¿™äº›Coin. ç¨€ç¼ºæ€§æ˜¯æœ‰ä»·å€¼å®žç‰©èµ„äº§çš„é‡è¦å±žæ€§ã€‚åƒé»„é‡‘è¿™æ ·çš„ç¨€æœ‰é‡‘å±žè‡ªç„¶æ˜¯ç¨€ç¼ºçš„ï¼Œä½†æ•°å­—èµ„äº§å¹¶ä¸å­˜åœ¨å›ºæœ‰çš„ç‰©ç†ç¨€ç¼ºã€‚ä»¥å­—èŠ‚åºåˆ—ç¼–ç çš„æ•°å­—èµ„äº§ï¼Œå¦‚G[Alice]â†’10ï¼Œåœ¨ç‰©ç†ä¸Šå¹¶ä¸æ¯”å¦ä¸€ä¸ªå­—èŠ‚åºåˆ—(å¦‚G[Alice]â†’100)æ›´éš¾ç”Ÿæˆæˆ–å¤åˆ¶ã€‚ç›¸åï¼Œè¯„ä¼°è§„åˆ™å¿…é¡»ä»¥ç¼–ç¨‹æ–¹å¼å®žæ–½ç¨€ç¼ºæ€§ã€‚ è®©æˆ‘ä»¬è€ƒè™‘ç¬¬äºŒä¸ªè€ƒè™‘åˆ°ç¨€ç¼ºæ€§çš„æè®®: åœ¨è¿™ä¸ªæ–¹æ¡ˆä¸‹,äº‹åŠ¡è„šæœ¬æŒ‡å®šçš„å…¬é’¥ð¾ð‘Žå‘ä»¶äºº,Alice,å’Œå…¬é’¥ð¾ð‘æŽ¥æ”¶è€… Bobã€‚è¯„ä»·è§„åˆ™çŽ°åœ¨æ£€æŸ¥çš„æ•°é‡StrawCoinå‚¨å­˜åœ¨ð¾ð‘Žè‡³å°‘ð‘›ä¹‹å‰æ‰§è¡Œä»»ä½•æ›´æ–°ã€‚å¦‚æžœæ£€æŸ¥æˆåŠŸ,è¯„ä»·è§„åˆ™å‡åŽ»ä»ŽStrawCoin ð‘› å‚¨å­˜åœ¨å‘é€æ–¹çš„å¯†é’¥å’Œ ð‘›è¡¥å……åˆ°å‚¨å­˜åœ¨æ”¶ä»¶äººé’¥åŒ™ä¸‹çš„StrawCoinã€‚åœ¨æ­¤æ–¹æ¡ˆä¸‹ï¼Œæ‰§è¡Œä¸€ä¸ªæœ‰æ•ˆçš„äº‹åŠ¡è„šæœ¬é€šè¿‡ä¿å­˜ç³»ç»Ÿä¸­çš„StrawCoinæ•°é‡æ¥å¼ºåˆ¶æ‰§è¡Œç¨€ç¼ºæ€§ã€‚Aliceä¸èƒ½å†åˆ›é€ äº†ï¼Œä»–åªèƒ½ä»Žè´¦æˆ·ä¸­ç»™Bob StrawCoinã€‚ è®¿é—®æŽ§åˆ¶ã€‚ å°½ç®¡ç¬¬äºŒé¡¹ææ¡ˆè§£å†³äº†èµ„æºç¨€ç¼ºçš„é—®é¢˜ï¼Œä½†å®ƒä»ç„¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜:Bobå¯ä»¥å‘é€ä½¿ç”¨å±žäºŽAliceçš„ç¨»è‰å¸çš„äº¤æ˜“ã€‚ä¾‹å¦‚,æ²¡æœ‰è¯„ä»·è§„åˆ™å°†é˜»æ­¢Bobå‘é€äº‹åŠ¡âŸ¨Alice,100,BobâŸ©ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ åŸºäºŽæ•°å­—ç­¾åçš„è®¿é—®æŽ§åˆ¶æœºåˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜: è¿™ä¸ªæ–¹æ¡ˆè¦æ±‚Aliceç”¨å¥¹çš„ç§é’¥ç­¾ç½²äº‹åŠ¡è„šæœ¬ã€‚æˆ‘ä»¬å†™ð‘†ð¾(ð‘š)ç­¾ç½²æ¶ˆæ¯ð‘šä½¿ç”¨ç§é’¥ä¸Žå…¬é’¥ð¾é…å¯¹ã€‚è¯„ä»·è§„åˆ™ä½¿ç”¨verify_sigå‡½æ•°å¯¹Aliceçš„æ£€æŸ¥ç­¾åå…¬é’¥ð¾ð‘Žã€‚å¦‚æžœæ²¡æœ‰éªŒè¯ç­¾åï¼Œåˆ™ä¸æ‰§è¡Œæ›´æ–°ã€‚è¿™ä¸ªæ–°è§„åˆ™é€šè¿‡ä½¿ç”¨æ•°å­—ç­¾åçš„ä¸å¯ä¼ªé€ æ€§æ¥é˜²æ­¢Aliceä»Žå¥¹è‡ªå·±çš„è´¦æˆ·ä»¥å¤–çš„ä»»ä½•è´¦æˆ·å€Ÿè®°StrawCoinï¼Œä»Žè€Œè§£å†³äº†ä¹‹å‰æè®®çš„é—®é¢˜. å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œåœ¨ç¬¬ä¸€ä¸ªstrawmanåŽŸåž‹ä¸­å®žé™…ä¸Šä¸éœ€è¦è¯„ä¼°è§„åˆ™â€”â€”æè®®çš„çŠ¶æ€æ›´æ–°ç›´æŽ¥åº”ç”¨äºŽé”®å€¼å­˜å‚¨ã€‚ä½†æ˜¯ï¼Œéšç€æˆ‘ä»¬å¯¹è¿™äº›å»ºè®®çš„æ·±å…¥ç ”ç©¶ï¼Œåœ¨æ‰§è¡Œæ›´æ–°çš„å…ˆå†³æ¡ä»¶å’Œæ›´æ–°æœ¬èº«ä¹‹é—´å‡ºçŽ°äº†æ˜Žæ˜¾çš„åˆ†ç¦»,è¯„ä¼°è§„åˆ™é€šè¿‡è¯„ä¼°è„šæœ¬æ¥å†³å®šæ˜¯å¦æ‰§è¡Œæ›´æ–°ä»¥åŠæ‰§è¡Œä»€ä¹ˆæ›´æ–°ã€‚è¿™ç§åˆ†ç¦»æ˜¯åŸºæœ¬çš„ï¼Œå› ä¸ºæ‰§è¡Œè®¿é—®æŽ§åˆ¶å’Œç¨€ç¼ºæ€§ç­–ç•¥ä¸å¯é¿å…åœ°éœ€è¦æŸç§å½¢å¼çš„è¯„ä¼°â€”â€”ç”¨æˆ·æå‡ºçŠ¶æ€æ›´æ”¹å¿…é¡»æ‰§è¡Œè®¡ç®—ä»¥ç¡®å®šçŠ¶æ€æ›´æ”¹æ˜¯å¦ç¬¦åˆç­–ç•¥ã€‚åœ¨ä¸€ä¸ªå¼€æ”¾çš„ç³»ç»Ÿä¸­ï¼Œä¸èƒ½ä¿¡ä»»å‚ä¸Žè€…æ‰§è¡Œç­–ç•¥å¹¶å‘çŠ¶æ€æäº¤ç›´æŽ¥æ›´æ–°(å¦‚ç¬¬ä¸€ä¸ªå»ºè®®ä¸­æ‰€è¿°)ã€‚ç›¸åï¼Œè®¿é—®æŽ§åˆ¶ç­–ç•¥å¿…é¡»ç”±è¯„ä¼°è§„åˆ™åœ¨é“¾ä¸Šå¼ºåˆ¶æ‰§è¡Œ. çŽ°æœ‰çš„åŒºå—é“¾è¯­è¨€StrawCoinæ˜¯ä¸€ç§çŽ©å…·è¯­è¨€ï¼Œä½†å®ƒè¯•å›¾æ•æ‰æ¯”ç‰¹å¸è„šæœ¬çš„æœ¬è´¨å’Œå’ŒEthereumè™šæ‹Ÿæœºå­—èŠ‚ç è¯­è¨€(å°¤å…¶æ˜¯åŽè€…)ã€‚è™½ç„¶è¿™äº›è¯­è¨€æ¯”StrawCoinæ›´å¤æ‚ï¼Œä½†å®ƒä»¬é¢ä¸´è®¸å¤šç›¸åŒçš„é—®é¢˜: èµ„äº§çš„é—´æŽ¥è¡¨ç¤ºã€‚èµ„äº§ä½¿ç”¨æ•´æ•°ç¼–ç ï¼Œä½†æ•´æ•°å€¼ä¸Žèµ„äº§ä¸åŒã€‚å®žé™…ä¸Šï¼Œæ²¡æœ‰è¡¨ç¤ºçš„ç±»åž‹æˆ–å€¼åœ¨ Bitcoin/Ether/ StrawCoin ä¸­ï¼Œ è¿™ä½¿å¾—ç¼–å†™ä½¿ç”¨èµ„äº§çš„ç¨‹åºå˜å¾—éžå¸¸å›°éš¾ï¼Œå¹¶ä¸”å®¹æ˜“å‡ºé”™ã€‚è¯¸å¦‚å°†èµ„äº§ä¼ å…¥/ä¼ å‡ºè¿‡ç¨‹æˆ–å°†èµ„äº§å­˜å‚¨åœ¨æ•°æ®ç»“æž„ä¸­çš„æ¨¡å¼éœ€è¦ç‰¹æ®Šçš„è¯­è¨€æ”¯æŒã€‚ ç¨€ç¼ºæ€§æ˜¯ä¸å¯æ‰©å±•çš„ã€‚è¯­è¨€åªä»£è¡¨ä¸€ç§ç¨€ç¼ºèµ„äº§ã€‚æ­¤å¤–ï¼Œç¨€ç¼ºæ€§ä¿æŠ¤ç›´æŽ¥ç¡¬ç¼–ç åœ¨è¯­è¨€è¯­ä¹‰ä¸­ã€‚å¸Œæœ›åˆ›å»ºè‡ªå®šä¹‰èµ„äº§çš„ç¨‹åºå‘˜å¿…é¡»åœ¨æ²¡æœ‰è¯­è¨€æ”¯æŒçš„æƒ…å†µä¸‹ä»”ç»†åœ°é‡æ–°å®žçŽ°ç¨€ç¼ºæ€§ã€‚ è®¿é—®æŽ§åˆ¶ä¸çµæ´»ã€‚æ¨¡åž‹æ‰§è¡Œçš„å”¯ä¸€è®¿é—®æŽ§åˆ¶ç­–ç•¥æ˜¯åŸºäºŽå…¬é’¥çš„ç­¾åæ–¹æ¡ˆã€‚ä¸Žç¨€ç¼ºæ€§ä¿æŠ¤ä¸€æ ·ï¼Œè®¿é—®æŽ§åˆ¶ç­–ç•¥ä¹Ÿæ·±æ·±åœ°åµŒå…¥åˆ°è¯­è¨€è¯­ä¹‰ä¸­ã€‚å¦‚ä½•æ‰©å±•è¯¥è¯­è¨€ä»¥å…è®¸ç¨‹åºå‘˜å®šä¹‰è‡ªå®šä¹‰è®¿é—®æŽ§åˆ¶ç­–ç•¥å¹¶ä¸æ˜Žæ˜¾ã€‚ Bitcoin Script ã€‚ Bitcoin Scriptæœ‰ä¸€ä¸ªç®€å•è€Œä¼˜é›…çš„è®¾è®¡ï¼Œä¸“æ³¨äºŽè¡¨ç¤ºç”¨äºŽæ¶ˆè´¹æ¯”ç‰¹å¸çš„è‡ªå®šä¹‰è®¿é—®æŽ§åˆ¶ç­–ç•¥ã€‚å…¨å±€çŠ¶æ€ç”±ä¸€ç»„æœªä½¿ç”¨çš„äº‹åŠ¡è¾“å‡º(UTXOs)ç»„æˆã€‚æ¯”ç‰¹å¸è„šæœ¬ç¨‹åºæä¾›çš„è¾“å…¥(ä¾‹å¦‚æ•°å­—ç­¾å)æ»¡è¶³å®ƒæ‰€ä½¿ç”¨çš„æ—§UTXOsçš„è®¿é—®æŽ§åˆ¶ç­–ç•¥ï¼Œå¹¶ä¸ºå®ƒåˆ›å»ºçš„æ–°UTXOsæŒ‡å®šå®šåˆ¶çš„è®¿é—®æŽ§åˆ¶ç­–ç•¥ã€‚ç”±äºŽæ¯”ç‰¹å¸è„šæœ¬åŒ…å«å¼ºå¤§çš„æ•°å­—ç­¾åæ£€æŸ¥æŒ‡ä»¤(åŒ…æ‹¬å¤šç­¾åæ”¯æŒ)ï¼Œç¨‹åºå‘˜å¯ä»¥ç¼–ç å¤šç§è®¿é—®æŽ§åˆ¶ã€‚ ç„¶è€Œæ¯”ç‰¹å¸è„šæœ¬çš„è¡¨è¾¾èƒ½åŠ›ä»Žæ ¹æœ¬ä¸Šæ˜¯æœ‰é™çš„ã€‚ç¨‹åºå‘˜ä¸èƒ½å®šä¹‰è‡ªå®šä¹‰æ•°æ®ç±»åž‹(å› æ­¤ä¹Ÿä¸èƒ½å®šä¹‰è‡ªå®šä¹‰èµ„äº§)æˆ–è¿‡ç¨‹ï¼Œè€Œä¸”è¯­è¨€ä¹Ÿä¸å®Œæ•´ã€‚åˆä½œå„æ–¹å¯ä»¥é€šè¿‡å¤æ‚çš„å¤šäº‹åŠ¡åè®®æˆ–é€šè¿‡â€œå½©è‰²ç¡¬å¸â€éžæ­£å¼åœ°å®šä¹‰è‡ªå®šä¹‰èµ„äº§æ¥æ‰§è¡Œæ›´ä¸°å¯Œçš„è®¡ç®—ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ¡ˆçš„å·¥ä½œåŽŸç†æ˜¯å°†å¤æ‚æ€§æŽ¨åˆ°è¯­è¨€ä¹‹å¤–ï¼Œå› æ­¤ä¸æ”¯æŒçœŸæ­£çš„å¯æ‰©å±•æ€§ã€‚ Ethereum Virtual Machine bytecode ã€‚ Ethereumæ˜¯ä¸€ä¸ªå¼€åˆ›æ€§çš„ç³»ç»Ÿï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨åŒºå—é“¾ç³»ç»Ÿä¸ä»…ä»…ç”¨äºŽæ”¯ä»˜ã€‚Ethereumè™šæ‹Ÿæœº(EVM)å­—èŠ‚ç ç¨‹åºå‘˜å¯ä»¥å‘å¸ƒä¸Žetherä¹‹ç±»çš„èµ„äº§äº¤äº’çš„æ™ºèƒ½åˆçº¦ï¼Œå¹¶ä½¿ç”¨å›¾çµå®Œå¤‡è¯­è¨€å®šä¹‰æ–°èµ„äº§ã€‚EVMæ”¯æŒæ¯”ç‰¹å¸è„šæœ¬æ‰€ä¸èƒ½æ”¯æŒçš„ä¸œè¥¿ï¼Œä¾‹å¦‚ç”¨æˆ·å®šä¹‰çš„è¿‡ç¨‹ã€è™šæ‹Ÿè°ƒç”¨ã€å¾ªçŽ¯å’Œæ•°æ®ç»“æž„ã€‚ ç„¶è€Œï¼ŒEVMçš„çš„è¡¨çŽ°ä¸ºä»£ä»·é«˜æ˜‚çš„ç¼–ç¨‹é”™è¯¯æ‰“å¼€äº†å¤§é—¨ã€‚å°±åƒStrawCoinæ˜¯ä¸€ç§etherè´§å¸ï¼Œåœ¨è¯­è¨€ä¸­å…·æœ‰ç‰¹æ®Šçš„åœ°ä½ï¼Œå®ƒçš„å®žçŽ°æ–¹å¼å¼ºè°ƒäº†ç¨€ç¼ºæ€§,ä½†æ˜¯å®šåˆ¶èµ„äº§çš„å®žçŽ°è€…(ä¾‹å¦‚ï¼Œé€šè¿‡ERC20æ ‡å‡†)ä¸ç»§æ‰¿è¿™äº›ä¿æŠ¤(å¦‚ç¬¬(2)æ‰€è¿°)-ä»–ä»¬å¿…é¡»å°å¿ƒä¸è¦å¼•å…¥å…è®¸å¤åˆ¶ã€é‡ç”¨æˆ–ä¸¢å¤±èµ„äº§çš„bugã€‚è¿™æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œå› ä¸ºç»“åˆäº†é—´æŽ¥è¡¨ç¤ºé—®é¢˜ä¸­æè¿°,ä»¥åŠEVMçš„é«˜åº¦åŠ¨æ€è¡Œä¸ºã€‚ç‰¹åˆ«æ˜¯ï¼Œå°†etherè½¬ç§»åˆ°æ™ºèƒ½åˆçº¦æ¶‰åŠåˆ°åŠ¨æ€åˆ†æ´¾ï¼Œè¿™å¯¼è‡´äº†ä¸€ç±»æ–°çš„bugï¼Œç§°ä¸ºå¯é‡å…¥æ€§æ¼æ´žã€‚å¼•äººæ³¨ç›®çš„æ¼æ´žï¼Œå¦‚DAOæ”»å‡»å’ŒParity Walletæ”»å‡»ï¼Œå·²ç»å…è®¸æ”»å‡»è€…çªƒå–ä»·å€¼æ•°ç™¾ä¸‡ç¾Žå…ƒçš„åŠ å¯†è´§å¸ã€‚ Moveè®¾è®¡ç›®æ ‡Libraçš„ä½¿å‘½æ˜¯ä½¿ä¸€ä¸ªç®€å•çš„å…¨çƒè´§å¸å’Œé‡‘èžåŸºç¡€è®¾æ–½ï¼Œä½¿æ•°åäº¿äººçš„å—ç›Šã€‚Moveè¯­è¨€çš„è®¾è®¡ç›®çš„æ˜¯æä¾›ä¸€ä¸ªå®‰å…¨çš„ã€å¯ç¼–ç¨‹çš„åŸºç¡€ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå¯ä»¥æž„å»ºè¿™ä¸ªæ„¿æ™¯ã€‚Moveå¿…é¡»èƒ½å¤Ÿä»¥ç²¾ç¡®ã€å¯ç†è§£å’Œå¯éªŒè¯çš„æ–¹å¼è¡¨è¾¾Libraçš„è´§å¸å’Œæ²»ç†è§„åˆ™ã€‚ä»Žé•¿è¿œæ¥çœ‹ï¼ŒMoveå¿…é¡»èƒ½å¤Ÿç¼–ç æž„æˆé‡‘èžåŸºç¡€è®¾æ–½çš„ä¸°å¯Œå¤šæ ·çš„èµ„äº§å’Œç›¸åº”çš„ä¸šåŠ¡é€»è¾‘ã€‚ ä¸ºäº†æ»¡è¶³è¿™äº›éœ€æ±‚ï¼Œæˆ‘ä»¬è®¾è®¡Moveæ—¶è€ƒè™‘äº†å››ä¸ªå…³é”®ç›®æ ‡:å¤´ç­‰èµ„äº§ã€çµæ´»æ€§ã€å®‰å…¨æ€§å’Œå¯éªŒè¯æ€§ èµ„æºæ˜¯å¤´ç­‰å…¬æ°‘åŒºå—é“¾ç³»ç»Ÿå…è®¸ç”¨æˆ·ç¼–å†™ä¸Žæ•°å­—èµ„äº§ç›´æŽ¥äº¤äº’çš„ç¨‹åºã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬2.2èŠ‚ä¸­è®¨è®ºçš„ï¼Œæ•°å­—èµ„äº§å…·æœ‰ç‰¹æ®Šçš„ç‰¹æ€§ï¼Œè¿™äº›ç‰¹æ€§å°†å®ƒä»¬ä¸Žä¼ ç»Ÿç¼–ç¨‹ä¸­ä½¿ç”¨çš„å€¼(å¦‚å¸ƒå°”å€¼ã€æ•´æ•°å’Œå­—ç¬¦ä¸²)åŒºåˆ†å¼€æ¥ã€‚ä½¿ç”¨èµ„äº§è¿›è¡Œç¼–ç¨‹çš„å¥å£®è€Œä¼˜é›…çš„æ–¹æ³•éœ€è¦ä¿æŒè¿™äº›ç‰¹å¾çš„è¡¨ç¤ºå½¢å¼ã€‚ Moveçš„å…³é”®ç‰¹æ€§æ˜¯èƒ½å¤Ÿä½¿ç”¨çº¿æ€§é€»è¾‘æ¿€å‘çš„è¯­ä¹‰å®šä¹‰è‡ªå®šä¹‰èµ„æºç±»åž‹:èµ„æºæ°¸è¿œä¸èƒ½å¤åˆ¶æˆ–éšå¼ä¸¢å¼ƒï¼Œåªèƒ½åœ¨ç¨‹åºå­˜å‚¨ä½ç½®ä¹‹é—´ç§»åŠ¨ã€‚è¿™äº›å®‰å…¨ä¿è¯ç”±Moveçš„ç±»åž‹ç³»ç»Ÿé™æ€æ‰§è¡Œã€‚å°½ç®¡æœ‰è¿™äº›ç‰¹æ®Šçš„ä¿æŠ¤ï¼Œèµ„æºä»ç„¶æ˜¯æ™®é€šçš„ç¨‹åºå€¼â€”â€”å®ƒä»¬å¯ä»¥å­˜å‚¨åœ¨æ•°æ®ç»“æž„ä¸­ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿‡ç¨‹ï¼Œç­‰ç­‰ã€‚èµ„æºæ”¾åœ¨ç¬¬ä¸€ä½ç½®æ˜¯ä¸€ä¸ªéžå¸¸æ™®éçš„æ¦‚å¿µï¼Œç¨‹åºå‘˜ä¸ä»…å¯ä»¥ä½¿ç”¨å®ƒæ¥å®žçŽ°å®‰å…¨çš„æ•°å­—èµ„äº§ï¼Œè¿˜å¯ä»¥ç”¨å®ƒæ¥ç¼–å†™æ­£ç¡®çš„ä¸šåŠ¡é€»è¾‘æ¥åŒ…è£…èµ„äº§å’Œæ‰§è¡Œè®¿é—®æŽ§åˆ¶ç­–ç•¥ã€‚ Libra coinæœ¬èº«å°±æ˜¯ä¸€ç§æ™®é€šçš„Moveèµ„æºï¼Œåœ¨è¯­è¨€ä¸­æ²¡æœ‰ç‰¹æ®Šçš„åœ°ä½ã€‚ç”±äºŽLibra coinä»£è¡¨Libra å‚¨å¤‡ç®¡ç†çš„çœŸå®žä¸–ç•Œèµ„äº§ï¼Œå› æ­¤Moveå¿…é¡»å…è®¸åˆ›å»ºèµ„æº(ä¾‹å¦‚ï¼Œå½“æ–°çš„çœŸå®žä¸–ç•Œèµ„äº§è¿›å…¥Libraå‚¨å¤‡æ—¶)ã€ä¿®æ”¹(ä¾‹å¦‚ï¼Œå½“æ•°å­—èµ„äº§æ›´æ”¹æ‰€æœ‰æƒæ—¶)å’Œé”€æ¯(ä¾‹å¦‚ï¼Œå½“æ”¯æŒæ•°å­—èµ„äº§çš„ç‰©ç†èµ„äº§è¢«å‡ºå”®æ—¶)ã€‚Moveç¨‹åºå‘˜å¯ä»¥ä½¿ç”¨æ¨¡å—ä¿æŠ¤å¯¹è¿™äº›å…³é”®æ“ä½œçš„è®¿é—®ã€‚Moveæ¨¡å—ç±»ä¼¼äºŽå…¶ä»–åŒºå—é“¾è¯­è¨€ä¸­çš„æ™ºèƒ½åˆçº¦ã€‚æ¨¡å—å£°æ˜Žèµ„æºç±»åž‹å’Œè¿‡ç¨‹ï¼Œè¿™äº›ç±»åž‹å’Œè¿‡ç¨‹ç¼–ç ç”¨äºŽåˆ›å»ºã€é”€æ¯å’Œæ›´æ–°å…¶å£°æ˜Žçš„èµ„æºçš„è§„åˆ™ã€‚æ¨¡å—å¯ä»¥è°ƒç”¨å…¶ä»–æ¨¡å—å£°æ˜Žçš„è¿‡ç¨‹å¹¶ä½¿ç”¨å…¶ä»–æ¨¡å—å£°æ˜Žçš„ç±»åž‹ã€‚ç„¶è€Œï¼Œæ¨¡å—å¼ºåˆ¶æ‰§è¡Œå¼ºæ•°æ®æŠ½è±¡â€”â€”ç±»åž‹åœ¨å…¶å£°æ˜Žæ¨¡å—å†…éƒ¨æ˜¯é€æ˜Žçš„ï¼Œè€Œåœ¨å…¶å¤–éƒ¨æ˜¯ä¸é€æ˜Žçš„ã€‚æ­¤å¤–ï¼Œå¯¹èµ„æºç±»åž‹Tçš„å…³é”®æ“ä½œåªèƒ½åœ¨å®šä¹‰Tçš„æ¨¡å—ä¸­æ‰§è¡Œã€‚ çµæ´»æ€§Moveé€šè¿‡äº‹åŠ¡è„šæœ¬ä¸ºLibraå¢žåŠ äº†çµæ´»æ€§ã€‚æ¯ä¸ªLibraäº‹åŠ¡éƒ½åŒ…å«ä¸€ä¸ªäº‹åŠ¡è„šæœ¬ï¼Œè¯¥è„šæœ¬å®žé™…ä¸Šæ˜¯äº‹åŠ¡çš„ä¸»è¦è¿‡ç¨‹ã€‚äº‹åŠ¡è„šæœ¬æ˜¯ä¸€ä¸ªåŒ…å«ä»»æ„ç§»åŠ¨ä»£ç çš„è¿‡ç¨‹ï¼Œå…è®¸å®šåˆ¶äº‹åŠ¡ã€‚ä¸€ä¸ªè„šæœ¬å¯ä»¥è°ƒç”¨å‘å¸ƒåœ¨åŒºå—é“¾ä¸­çš„å¤šä¸ªæ¨¡å—çš„è¿‡ç¨‹ï¼Œå¹¶å¯¹ç»“æžœæ‰§è¡Œæœ¬åœ°è®¡ç®—ã€‚è¿™æ„å‘³ç€è„šæœ¬å¯ä»¥æ‰§è¡Œè¡¨è¾¾æ€§çš„ä¸€æ¬¡æ€§è¡Œä¸º(ä¾‹å¦‚å‘ä¸€ç»„ç‰¹å®šçš„æŽ¥æ”¶è€…ä»˜è´¹)æˆ–å¯é‡ç”¨è¡Œä¸º(é€šè¿‡è°ƒç”¨å°è£…å¯é‡ç”¨é€»è¾‘çš„å•ä¸ªè¿‡ç¨‹)ã€‚ é€šè¿‡å®‰å…¨è€Œçµæ´»çš„ä»£ç ç»„åˆï¼ŒMoveæ¨¡å—æä¾›äº†ä¸€ç§ä¸åŒçš„çµæ´»æ€§ã€‚åœ¨é«˜å±‚æ¬¡ä¸Šï¼ŒMoveä¸­modules/resources/procedures ä¹‹é—´çš„å…³ç³»ç±»ä¼¼äºŽé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ç±»/å¯¹è±¡/æ–¹æ³•ä¹‹é—´çš„å…³ç³»ã€‚ç„¶è€Œï¼Œæœ‰ä¸€äº›é‡è¦çš„åŒºåˆ«â€”â€”ä¸€ä¸ªMoveæ¨¡å—å¯ä»¥å£°æ˜Žå¤šä¸ªèµ„æºç±»åž‹(æˆ–é›¶èµ„æºç±»åž‹)ï¼Œè€ŒMoveè¿‡ç¨‹æ²¡æœ‰selfæˆ–è¿™ä¸ªå€¼çš„æ¦‚å¿µã€‚Moveæ¨¡å—ä¸Žmlé£Žæ ¼çš„æ¨¡å—çš„é™å®šç‰ˆæœ¬æœ€ä¸ºç›¸ä¼¼ã€‚ å®‰å…¨æ€§Moveå¿…é¡»æ‹’ç»ä¸æ»¡è¶³å…³é”®å±žæ€§(å¦‚èµ„æºå®‰å…¨æ€§ã€ç±»åž‹å®‰å…¨æ€§å’Œå†…å­˜å®‰å…¨æ€§)çš„ç¨‹åºã€‚æˆ‘ä»¬å¦‚ä½•é€‰æ‹©ä¸€ä¸ªå¯æ‰§è¡Œçš„è¡¨ç¤ºï¼Œä»¥ç¡®ä¿æ¯ä¸€ä¸ªåœ¨åŒºå—é“¾ä¸Šæ‰§è¡Œçš„ç¨‹åºæ»¡è¶³è¿™äº›æ€§è´¨?ä¸¤ç§å¯èƒ½çš„æ–¹æ³•æ˜¯:(a)ä½¿ç”¨å¸¦æœ‰æ£€æŸ¥è¿™äº›å±žæ€§çš„ç¼–è¯‘å™¨çš„é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼Œæˆ–è€…(b)ä½¿ç”¨ä½Žçº§éžç±»åž‹åŒ–ç¨‹åºé›†å¹¶åœ¨è¿è¡Œæ—¶æ‰§è¡Œè¿™äº›å®‰å…¨æ£€æŸ¥ã€‚Moveé‡‡å–çš„æ–¹æ³•ä»‹äºŽè¿™ä¸¤ä¸ªæžç«¯ä¹‹é—´ã€‚Moveçš„å¯æ‰§è¡Œæ ¼å¼æ˜¯ä¸€ç§ç±»åž‹å­—èŠ‚ç ï¼Œå®ƒæ¯”assemblyçº§åˆ«é«˜ï¼Œä½†æ¯”source language çº§åˆ«ä½Žã€‚åœ¨é“¾ä¸Šæ£€æŸ¥èµ„æºã€ç±»åž‹å’Œå†…å­˜å®‰å…¨æ€§ï¼Œç„¶åŽç”±å­—èŠ‚ç è§£é‡Šå™¨ç›´æŽ¥æ‰§è¡Œã€‚æ­¤é€‰é¡¹å…è®¸Moveæä¾›é€šå¸¸ä¸Žæºè¯­è¨€å…³è”çš„å®‰å…¨ä¿è¯ï¼Œä½†ä¸éœ€è¦å°†æºç¼–è¯‘å™¨æ·»åŠ åˆ°å¯ä¿¡è®¡ç®—åŸºç¡€ä¸­ï¼Œä¹Ÿä¸éœ€è¦å°†ç¼–è¯‘æˆæœ¬æ·»åŠ åˆ°äº‹åŠ¡æ‰§è¡Œçš„å…³é”®è·¯å¾„ä¸­ã€‚ å¯éªŒè¯æ€§ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†é€šè¿‡é“¾ä¸Šå­—èŠ‚ç åˆ†æžæˆ–è¿è¡Œæ—¶æ£€æŸ¥æ£€æŸ¥Moveç¨‹åºçš„æ¯ä¸ªå®‰å…¨å±žæ€§ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ˜¯ä¸å¯è¡Œçš„ã€‚æˆ‘ä»¬å¿…é¡»ä»”ç»†æƒè¡¡å®‰å…¨ä¿è¯çš„é‡è¦æ€§å’Œé€šç”¨æ€§ï¼Œä»¥åŠä½¿ç”¨é“¾ä¸ŠéªŒè¯æ¥æ‰§è¡Œå®‰å…¨ä¿è¯çš„è®¡ç®—æˆæœ¬å’Œå¢žåŠ çš„åè®®å¤æ‚æ€§ã€‚ æˆ‘ä»¬çš„æ–¹æ³•æ˜¯å°½å¯èƒ½å¤šåœ°æ‰§è¡Œå…³é”®å®‰å…¨ç‰¹æ€§çš„è½»é‡çº§é“¾ä¸ŠéªŒè¯ï¼Œä½†æ˜¯è®¾è®¡Moveè¯­è¨€æ¥æ”¯æŒé«˜çº§çš„ç¦»çº¿é™æ€éªŒè¯å·¥å…·ã€‚æˆ‘ä»¬åšäº†å‡ ä¸ªè®¾è®¡å†³å®šï¼Œä½¿å¾—Moveæ¯”å¤§å¤šæ•°é€šç”¨è¯­è¨€æ›´é€‚åˆé™æ€éªŒè¯: æ²¡æœ‰åŠ¨æ€è°ƒç”¨ã€‚å¯ä»¥é™æ€åœ°ç¡®å®šæ¯ä¸ªè°ƒç”¨ç«™ç‚¹çš„ç›®æ ‡ã€‚è¿™ä½¿å¾—éªŒè¯å·¥å…·å¯ä»¥å¾ˆå®¹æ˜“åœ°ç²¾ç¡®åœ°æŽ¨æ–­è¿‡ç¨‹è°ƒç”¨çš„æ•ˆæžœï¼Œè€Œæ— éœ€æ‰§è¡Œå¤æ‚çš„è°ƒç”¨å›¾æž„é€ åˆ†æžã€‚ æœ‰é™çš„å¯å˜æ€§ã€‚ å¯¹Moveå€¼çš„æ¯ä¸ªçªå˜éƒ½æ˜¯é€šè¿‡å¼•ç”¨å‘ç”Ÿçš„,å¼•ç”¨æ˜¯å¿…é¡»åœ¨å•ä¸ªäº‹åŠ¡è„šæœ¬çš„èŒƒå›´å†…åˆ›å»ºå’Œé”€æ¯çš„ä¸´æ—¶å€¼ã€‚Moveçš„å­—èŠ‚ç éªŒè¯å™¨ä½¿ç”¨ç±»ä¼¼äºŽRustçš„â€œå€Ÿç”¨æ£€æŸ¥â€æ–¹æ¡ˆï¼Œä»¥ç¡®ä¿åœ¨ä»»ä½•æ—¶é—´ç‚¹æœ€å¤šå­˜åœ¨ä¸€ä¸ªå¯¹å€¼çš„å¯å˜å¼•ç”¨ã€‚æ­¤å¤–ï¼Œè¯¥è¯­è¨€ç¡®ä¿å…¨å±€å­˜å‚¨å§‹ç»ˆæ˜¯æ ‘è€Œä¸æ˜¯ä»»æ„å›¾ã€‚è¿™å…è®¸éªŒè¯å·¥å…·æ¨¡å—åŒ–æœ‰å…³å†™æ“ä½œæ•ˆæžœçš„æŽ¨ç†ã€‚ æ¨¡å—åŒ– ã€‚ Moveæ¨¡å—æ‰§è¡Œæ•°æ®æŠ½è±¡å¹¶æœ¬åœ°åŒ–èµ„æºä¸Šçš„å…³é”®æ“ä½œã€‚æ¨¡å—å¯ç”¨çš„å°è£…ä¸ŽMoveç±»åž‹ç³»ç»Ÿå¼ºåˆ¶å®žæ–½çš„ä¿æŠ¤ç›¸ç»“åˆï¼Œç¡®ä¿ä¸ºæ¨¡å—ç±»åž‹å»ºç«‹çš„å±žæ€§ä¸ä¼šè¢«æ¨¡å—å¤–éƒ¨çš„ä»£ç è¿åã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡è¿™ç§è®¾è®¡ï¼Œå¯ä»¥åœ¨ä¸è€ƒè™‘å…¶å®¢æˆ·æœºçš„æƒ…å†µä¸‹å•ç‹¬æŸ¥çœ‹æ¨¡å—ï¼Œä»Žè€Œå¯¹é‡è¦çš„æ¨¡å—ä¸å˜é‡è¿›è¡Œè¯¦å°½çš„åŠŸèƒ½éªŒè¯ã€‚ é™æ€éªŒè¯å·¥å…·å¯ä»¥åˆ©ç”¨Moveçš„è¿™äº›å±žæ€§æ¥å‡†ç¡®æœ‰æ•ˆåœ°æ£€æŸ¥è¿è¡Œæ—¶æ˜¯å¦æ²¡æœ‰å‡ºçŽ°æ•…éšœ(ä¾‹å¦‚æ•´æ•°æº¢å‡º)ï¼Œä»¥åŠé‡è¦çš„ç‰¹å®šäºŽç¨‹åºçš„åŠŸèƒ½æ­£ç¡®æ€§å±žæ€§(ä¾‹å¦‚ï¼Œé”å®šåœ¨æ”¯ä»˜é€šé“ä¸­çš„èµ„æºæœ€ç»ˆå¯ä»¥ç”±å‚ä¸Žè€…å£°æ˜Ž)ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬7èŠ‚ä¸­åˆ†äº«å…³äºŽåŠŸèƒ½éªŒè¯è®¡åˆ’çš„æ›´å¤šç»†èŠ‚ã€‚ Moveæ¦‚è¿°æˆ‘ä»¬å°†ä»‹ç»Moveçš„åŸºç¡€çŸ¥è¯†ï¼Œæ–¹æ³•æ˜¯éåŽ†ç®€å•å¯¹ç­‰æ”¯ä»˜ä¸­æ¶‰åŠçš„äº‹åŠ¡è„šæœ¬å’Œæ¨¡å—ã€‚è¯¥æ¨¡å—æ˜¯å®žé™…Libra Coinå®žçŽ°çš„ç®€åŒ–ç‰ˆæœ¬ã€‚ç¤ºä¾‹äº‹åŠ¡è„šæœ¬æ¼”ç¤ºäº†æ¨¡å—å¤–éƒ¨æ¶æ„æˆ–ç²—å¿ƒçš„ç¨‹åºå‘˜ä¸èƒ½è¿åæ¨¡å—èµ„æºçš„å…³é”®å®‰å…¨ä¸å˜é‡ã€‚ç¤ºä¾‹æ¨¡å—å±•ç¤ºäº†å¦‚ä½•å®žçŽ°ä¸€ä¸ªåˆ©ç”¨å¼ºå¤§çš„æ•°æ®æŠ½è±¡æ¥å»ºç«‹å’Œç»´æŠ¤è¿™äº›ä¸å˜é‡çš„èµ„æºã€‚ æœ¬èŠ‚ä¸­çš„ä»£ç ç‰‡æ®µæ˜¯ç”¨Moveä¸­é—´ä»£ç (IR)ç¼–å†™çš„ã€‚Move IRçš„çº§åˆ«è¶³å¤Ÿé«˜ï¼Œå¯ä»¥ç¼–å†™äººç±»å¯è¯»çš„ä»£ç ï¼Œä½†åˆè¶³å¤Ÿä½Žï¼Œå¯ä»¥ç›´æŽ¥è½¬æ¢æ¥Moveå­—èŠ‚ç ã€‚æˆ‘ä»¬æä¾› Move IRä»£ç ï¼Œå› ä¸ºåŸºäºŽå †æ ˆçš„Moveå­—èŠ‚ç æ›´éš¾ä»¥è¯»å–ï¼Œè€Œä¸”æˆ‘ä»¬ç›®å‰æ­£åœ¨è®¾è®¡ä¸€ç§Moveæºä»£ç è¯­è¨€(è¯·å‚é˜…ç¬¬ä¸ƒèŠ‚ï¼‰æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨æ‰§è¡Œä»£ç ä¹‹å‰ï¼ŒMoveç±»åž‹ç³»ç»Ÿæä¾›çš„æ‰€æœ‰å®‰å…¨ä¿è¯éƒ½åœ¨å­—èŠ‚ç çº§åˆ«è¿›è¡Œæ£€æŸ¥ã€‚ ç‚¹å¯¹ç‚¹æ”¯ä»˜äº¤æ˜“è„šæœ¬ æ­¤è„šæœ¬æŽ¥å—ä¸¤ä¸ªè¾“å…¥:ä»˜æ¬¾æŽ¥æ”¶æ–¹çš„å¸æˆ·åœ°å€å’Œè¡¨ç¤ºè¦è½¬ç§»åˆ°æŽ¥æ”¶æ–¹çš„Coinæ•°é‡çš„æ— ç¬¦å·æ•´æ•°ã€‚æ‰§è¡Œæ­¤è„šæœ¬çš„æ•ˆæžœå¾ˆç®€å•: amountæ•°é‡çš„Coinå°†ä»Žsenderè½¬ç§»åˆ°payeeã€‚è¿™éœ€è¦ä¸¤ä¸ªæ­¥éª¤ã€‚åœ¨ç¬¬ä¸€æ­¥ä¸­ï¼Œå‘é€æ–¹ä»Žå­˜å‚¨åœ¨0x0.Currencyçš„æ¨¡å—è°ƒç”¨ä¸€ä¸ªåä¸ºæŠ½å‡ºwithdraw_from_senderçš„è¿‡ç¨‹ ,æ­£å¦‚æˆ‘ä»¬å°†åœ¨ç¬¬4.2èŠ‚ä¸­è§£é‡Šçš„é‚£æ ·, 0x0æ˜¯å­˜å‚¨åœ¨æ¨¡å—é‡Œçš„å¸æˆ·åœ°å€ï¼ŒCurrencyæ˜¯æ¨¡å—çš„åç§°ã€‚è¿™ä¸ªè¿‡ç¨‹è¿”å›žçš„å€¼coinæ˜¯ä¸€ä¸ªèµ„æºå€¼ï¼Œå…¶ç±»åž‹ä¸º0x0.Currency.Coin ,åœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œå‘é€æ–¹é€šè¿‡å°†coinèµ„æºå€¼ç§»åŠ¨åˆ°0x0.Currency çš„ depositè¿‡ç¨‹ï¼Œ å°†èµ„é‡‘è½¬ç§»åˆ°payeeã€‚ è¿™ä¸ªä¾‹å­å¾ˆæœ‰è¶£ï¼Œå› ä¸ºå®ƒéžå¸¸å¾®å¦™ã€‚Moveçš„ç±»åž‹ç³»ç»Ÿå°†æ‹’ç»ç›¸åŒä»£ç ä¸­å¯èƒ½å¯¼è‡´ä¸è‰¯è¡Œä¸ºçš„å°å˜ä½“ã€‚ç‰¹åˆ«æ˜¯ï¼Œç±»åž‹ç³»ç»Ÿç¡®ä¿èµ„æºæ°¸è¿œä¸ä¼šè¢«å¤åˆ¶ã€é‡ç”¨æˆ–ä¸¢å¤±ã€‚ä¾‹å¦‚ï¼Œç±»åž‹ç³»ç»Ÿä¼šæ‹’ç»ä»¥ä¸‹ä¸‰ä¸ªå¯¹è„šæœ¬çš„æ›´æ”¹: é€šè¿‡æ”¹å˜ move(coin) to copy(coin)æ¥å¤åˆ¶è´§å¸ã€‚ æ³¨æ„ï¼Œç¤ºä¾‹ä¸­å˜é‡çš„æ¯æ¬¡ä½¿ç”¨éƒ½è¢«åŒ…è£…åœ¨copy()æˆ–move()ä¸­ã€‚ ç»§Rustå’Œc++ä¹‹åŽï¼ŒMoveå®žçŽ°äº†Moveè¯­ä¹‰ã€‚æ¯æ¬¡è¯»å–ç§»åŠ¨å˜é‡xæ—¶ï¼Œå¿…é¡»æŒ‡å®šä½¿ç”¨æ˜¯å°†xçš„å€¼ç§»å‡ºè¯¥å˜é‡(ä½¿xä¸å¯ç”¨)ï¼Œè¿˜æ˜¯å¤åˆ¶è¯¥å€¼(ä½¿xå¯ç»§ç»­ä½¿ç”¨)ã€‚æ— é™åˆ¶çš„å€¼ç±»ä¼¼u64 å’Œ address æ—¢å¯ä»¥è¢«move ä¹Ÿå¯ä»¥è¢«copyã€‚ ä½†æ˜¯èµ„æºå€¼åªèƒ½è¢« moveï¼Œè¯•å›¾copyèµ„æºå€¼(ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ä½¿ç”¨copy(coin))å°†åœ¨å­—èŠ‚ç éªŒè¯æ—¶å¯¼è‡´é”™è¯¯ã€‚ é€šè¿‡ä¸¤æ¬¡ç¼–å†™move(coin)æ¥é‡ç”¨è´§å¸ æ·»åŠ  0x0.Currency.deposit(copy(some_other_payee), move(coin))è¿™ä¸€è¡Œåœ¨ä»¥ä¸Šçš„ä¾‹å­ä¼šè®©æŠ•å¸äººâ€œèŠ±â€ä¸¤æ¬¡Coinï¼Œç¬¬ä¸€æ¬¡èŠ±åœ¨æ”¶æ¬¾äººèº«ä¸Šï¼Œç¬¬äºŒæ¬¡èŠ±åœ¨å…¶ä»–æ”¶æ¬¾äººèº«ä¸Šã€‚è¿™ç§ä¸å—æ¬¢è¿Žçš„è¡Œä¸ºå¯¹äºŽç‰©ç†èµ„äº§æ˜¯ä¸å¯èƒ½çš„ï¼Œ å¹¸è¿çš„æ˜¯ï¼Œæ­¤ä¸¾å°†è¢«æ‹’ç»ã€‚å˜é‡coinåœ¨ç¬¬ä¸€æ¬¡ç§»åŠ¨åŽä¸å¯ç”¨ï¼Œç¬¬äºŒæ¬¡ç§»åŠ¨å°†è§¦å‘ä¸€ä¸ªå­—èŠ‚ç éªŒè¯é”™è¯¯ã€‚ å¿˜è®°move(coin)è€Œä¸¢å¤±è´§å¸ ã€‚ Moveè¯­è¨€å®žçŽ°äº†çº¿æ€§çš„èµ„æºï¼Œè¿™äº›èµ„æºå¿…é¡»è¢«ç²¾ç¡®åœ°ç§»åŠ¨ä¸€æ¬¡ã€‚æœªèƒ½moveèµ„æº(ä¾‹å¦‚ï¼Œåˆ é™¤ä¸Šé¢ç¤ºä¾‹ä¸­åŒ…å«move(coin)çš„è¡Œ)å°†è§¦å‘å­—èŠ‚ç éªŒè¯é”™è¯¯ã€‚è¿™å¯ä»¥é˜²æ­¢ç¨‹åºå‘˜æ„å¤–åœ°(æˆ–æœ‰æ„åœ°)ä¸¢å¤±å¯¹èµ„æºçš„è·Ÿè¸ªã€‚è¿™äº›æ‹…ä¿è¶…å‡ºäº†çº¸å¸ç­‰å®žç‰©èµ„äº§æ‰€èƒ½æä¾›çš„èŒƒå›´ã€‚ æˆ‘ä»¬ä½¿ç”¨â€œèµ„æºå®‰å…¨â€è¿™ä¸ªæœ¯è¯­æ¥æè¿°ç§»åŠ¨èµ„æºæ°¸è¿œä¸ä¼šè¢«å¤åˆ¶ã€é‡ç”¨æˆ–ä¸¢å¤±çš„ä¿è¯ã€‚è¿™äº›ä¿è¯éžå¸¸å¼ºå¤§ï¼Œå› ä¸ºMoveç¨‹åºå‘˜å¯ä»¥å®žçŽ°åŒæ ·äº«å—è¿™äº›ä¿æŠ¤çš„è‡ªå®šä¹‰èµ„æºã€‚æ­£å¦‚æˆ‘ä»¬åœ¨3.1èŠ‚ä¸­æåˆ°çš„ï¼Œå³ä½¿æ˜¯Libraè´§å¸ä¹Ÿè¢«å®žçŽ°ä¸ºè‡ªå®šä¹‰èµ„æºï¼Œåœ¨Moveè¯­è¨€ä¸­æ²¡æœ‰ç‰¹æ®Šçš„åœ°ä½ã€‚ Currencyæ¨¡å—åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å±•ç¤ºä¸Šé¢ç¤ºä¾‹ä¸­ä½¿ç”¨çš„Currencyæ¨¡å—çš„å®žçŽ°å¦‚ä½•åˆ©ç”¨èµ„æºå®‰å…¨æ€§æ¥å®žçŽ°å®‰å…¨çš„å¯æ›¿æ¢èµ„äº§ã€‚æˆ‘ä»¬å°†é¦–å…ˆè§£é‡Šä¸€ä¸‹è¿è¡Œmoveä»£ç çš„åŒºå—é“¾çŽ¯å¢ƒ å…¥é—¨ï¼š Moveæ‰§è¡Œæ¨¡åž‹ æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬3.2èŠ‚ä¸­è§£é‡Šçš„ï¼ŒMoveæœ‰ä¸¤ç§ä¸åŒçš„ç¨‹åº:äº‹åŠ¡è„šæœ¬(å¦‚ç¬¬4.1èŠ‚ä¸­æ¦‚è¿°çš„ç¤ºä¾‹)å’Œæ¨¡å—(å¦‚è´§å¸æ¨¡å—ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šè®²åˆ° ç±»ä¼¼äºŽç¤ºä¾‹çš„äº‹åŠ¡è„šæœ¬åŒ…å«åœ¨æ¯ä¸ªç”¨æˆ·æäº¤çš„äº‹åŠ¡å’Œæ¨¡å—çš„è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œä»¥æ›´æ–°å…¨å±€çŠ¶æ€ã€‚æ‰§è¡Œäº‹åŠ¡è„šæœ¬æ˜¯å…¨æœ‰æˆ–å…¨æ— çš„â€”â€”è¦ä¹ˆæ‰§è¡ŒæˆåŠŸå®Œæˆï¼Œè„šæœ¬æ‰§è¡Œçš„æ‰€æœ‰å†™æ“ä½œéƒ½æäº¤åˆ°å…¨å±€å­˜å‚¨ï¼Œè¦ä¹ˆæ‰§è¡Œç»ˆæ­¢æ—¶å‡ºçŽ°é”™è¯¯(ä¾‹å¦‚ï¼Œç”±äºŽæ–­è¨€å¤±è´¥æˆ–è€—å°½gasé”™è¯¯)ï¼Œä»€ä¹ˆä¹Ÿä¸æäº¤ã€‚äº‹åŠ¡è„šæœ¬æ˜¯ä¸€æ®µä¸€æ¬¡æ€§ä½¿ç”¨çš„ä»£ç â€”â€”åœ¨æ‰§è¡Œä¹‹åŽï¼Œå…¶ä»–äº‹åŠ¡è„šæœ¬æˆ–æ¨¡å—ä¸èƒ½å†æ¬¡è°ƒç”¨å®ƒã€‚ ç›¸åï¼Œæ¨¡å—æ˜¯ä¸€æ®µä»¥å…¨å±€çŠ¶æ€å‘å¸ƒçš„é•¿ç”Ÿå‘½å‘¨æœŸä»£ç ã€‚æ¨¡å—åç§°0x0.Currencyã€‚ä¸Šé¢ç¤ºä¾‹ä¸­ä½¿ç”¨çš„è´§å¸åŒ…å«å‘å¸ƒæ¨¡å—ä»£ç çš„å¸æˆ·åœ°å€0x0ã€‚å…¨å±€çŠ¶æ€ç»“æž„ä¸ºä»Žå¸æˆ·åœ°å€åˆ°å¸æˆ·çš„æ˜ å°„ã€‚ æ¯ä¸ªå¸æˆ·å¯ä»¥åŒ…å«0ä¸ªæˆ–å¤šä¸ªæ¨¡å—(ä»¥çŸ©å½¢è¡¨ç¤º)å’Œä¸€ä¸ªæˆ–å¤šä¸ªèµ„æºå€¼(ä»¥æŸ±é¢è¡¨ç¤º)ã€‚ ä¾‹å¦‚ï¼Œåœ°å€0x0å¤„çš„å¸æˆ·åŒ…å«ä¸€ä¸ªæ¨¡å—0x0.Currencyå’Œç±»åž‹0x0.Currency.Coinçš„èµ„æºå€¼ã€‚åœ°å€0x1çš„è´¦æˆ·æœ‰ä¸¤ä¸ªèµ„æºå’Œä¸€ä¸ªæ¨¡å—;åœ°å€ä¸º0x2çš„å¸æˆ·æœ‰ä¸¤ä¸ªæ¨¡å—å’Œä¸€ä¸ªèµ„æºå€¼ã€‚ å¸æˆ·æœ€å¤šå¯ä»¥åŒ…å«ä¸€ä¸ªç»™å®šç±»åž‹çš„èµ„æºå€¼ï¼Œæœ€å¤šå¯ä»¥åŒ…å«ä¸€ä¸ªå…·æœ‰ç»™å®šåç§°çš„æ¨¡å—ã€‚åœ°å€0x0å¤„çš„å¸æˆ·å°†ä¸å…è®¸åŒ…å«é¢å¤–çš„0x0. Currency.Coin æˆ–è€…å…¶ä»–å«åšCurrencyçš„æ¨¡å—ã€‚ä½†æ˜¯ï¼Œåœ°å€0x1çš„å¸æˆ·å¯ä»¥æ·»åŠ ä¸€ä¸ªåä¸ºCurrencyçš„æ¨¡å—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ0x0ä¹Ÿå¯ä»¥ä¿å­˜0x1.Currency.Coinç±»åž‹çš„èµ„æºã€‚0x0.currency.coinå’Œ0 x1.currency.coinæ˜¯ä¸åŒçš„ç±»åž‹ï¼Œä¸èƒ½äº’æ¢ä½¿ç”¨;å£°æ˜Žæ¨¡å—çš„åœ°å€æ˜¯ç±»åž‹çš„ä¸€éƒ¨åˆ† æ³¨æ„ï¼Œåœ¨å¸æˆ·ä¸­æœ€å¤šå…è®¸ç»™å®šç±»åž‹çš„å•ä¸€èµ„æºå¹¶ä¸å—é™åˆ¶ã€‚æ­¤è®¾è®¡ä¸ºé¡¶çº§å¸æˆ·å€¼æä¾›äº†ä¸€ä¸ªå¯é¢„æµ‹çš„å­˜å‚¨æ¨¡å¼ã€‚ç¨‹åºå‘˜ä»ç„¶å¯ä»¥é€šè¿‡å®šä¹‰è‡ªå®šä¹‰åŒ…è£…å™¨èµ„æº(ä¾‹å¦‚ï¼Œèµ„æºTwoCoins {c1: 0x0.Currency.Coin, c2: 0x0.currency.Coin}) å£°æ˜ŽCoinèµ„æºã€‚åœ¨è§£é‡Šäº†æ¨¡å—å¦‚ä½•é€‚åˆäºŽMoveæ‰§è¡Œæ¨¡åž‹ä¹‹åŽï¼Œæˆ‘ä»¬ç»ˆäºŽå‡†å¤‡å¥½æŸ¥çœ‹è´§å¸Currencyæ¨¡å—å†…éƒ¨äº† æ­¤ä»£ç å£°æ˜Žä¸€ä¸ªåä¸ºCurrencyçš„æ¨¡å—å’Œä¸€ä¸ªç”±æ¨¡å—ç®¡ç†çš„åä¸ºCoinçš„èµ„æºç±»åž‹ã€‚Coinæ˜¯ä¸€ç§Structç±»åž‹ï¼Œå…¶å•ä¸ªå­—æ®µå€¼ç±»åž‹ä¸ºu64(64ä½æ— ç¬¦å·æ•´æ•°)ã€‚Coinçš„ç»“æž„åœ¨è´§å¸æ¨¡å—ä¹‹å¤–æ˜¯ä¸é€æ˜Žçš„ã€‚å…¶ä»–æ¨¡å—å’Œäº‹åŠ¡è„šæœ¬åªèƒ½é€šè¿‡æ¨¡å—å…¬å¼€çš„å…¬å…±è¿‡ç¨‹ç¼–å†™æˆ–å¼•ç”¨valueå­—æ®µã€‚åŒæ ·ï¼Œåªæœ‰Currencyæ¨¡å—çš„è¿‡ç¨‹æ‰èƒ½åˆ›å»ºæˆ–é”€æ¯ç±»åž‹Coinçš„å€¼ã€‚æ­¤æ–¹æ¡ˆæ”¯æŒå¼ºæ•°æ®æŠ½è±¡â€”â€”æ¨¡å—ä½œè€…å¯ä»¥å®Œå…¨æŽ§åˆ¶å…¶å£°æ˜Žèµ„æºçš„è®¿é—®ã€åˆ›å»ºå’Œé”€æ¯ã€‚åœ¨è´§å¸æ¨¡å—å…¬å¼€çš„APIä¹‹å¤–ï¼Œå…¶ä»–æ¨¡å—åªèƒ½å¯¹ç¡¬å¸æ‰§è¡Œç§»åŠ¨æ“ä½œã€‚èµ„æºå®‰å…¨æ€§ç¦æ­¢å…¶ä»–æ¨¡å—å¤åˆ¶ã€é”€æ¯æˆ–é‡å¤ç§»åŠ¨èµ„æºã€‚ Implementing deposit ã€‚è®©æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹å‰é¢å°èŠ‚ä¸­çš„äº‹åŠ¡è„šæœ¬è°ƒç”¨çš„Currency.depositè¿‡ç¨‹æ˜¯å¦‚ä½•å·¥ä½œçš„ åœ¨è¾ƒé«˜çš„çº§åˆ«ä¸Šï¼Œæ­¤è¿‡ç¨‹ä»¥Coinèµ„æºä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶ä¸Žå­˜å‚¨åœ¨æ”¶æ¬¾äººå¸æˆ·ä¸­çš„Coinèµ„æºç›¸ç»“åˆã€‚å®ƒé€šè¿‡: é”€æ¯è¾“å…¥ç¡¬å¸å¹¶è®°å½•å…¶ä»·å€¼ èŽ·å–å¯¹æ”¶æ¬¾äººå¸æˆ·ä¸‹å­˜å‚¨çš„å”¯ä¸€Coinèµ„æºçš„å¼•ç”¨ å°†æ”¶æ¬¾äººçš„Coinçš„ä»·å€¼ä¸Žä¼ é€’ç»™ç¨‹åºçš„Coinçš„ä»·å€¼ç›¸åŠ  è¿™ä¸ªè¿‡ç¨‹çš„åº•å±‚æœºåˆ¶æœ‰ä¸€äº›æ–¹é¢å€¼å¾—è§£é‡Šã€‚ç»‘å®šåˆ°to_depositçš„Coinèµ„æºç”±å­˜æ¬¾ç¨‹åºæ‹¥æœ‰ã€‚è¦è°ƒç”¨è¯¥è¿‡ç¨‹ï¼Œè°ƒç”¨è€…éœ€è¦å°†ç»‘å®šåˆ°to_depositçš„ç¡¬å¸ç§»åŠ¨åˆ°è¢«è°ƒç”¨è€…ä¸­(è¿™å°†é˜²æ­¢è°ƒç”¨è€…é‡ç”¨å®ƒ) ç¬¬ä¸€è¡Œè°ƒç”¨çš„Unpackè¿‡ç¨‹æ˜¯ç”¨äºŽæ“ä½œæ¨¡å—å£°æ˜Žçš„ç±»åž‹çš„å‡ ä¸ªæ¨¡å—å†…ç½®ç¨‹åºä¹‹ä¸€,Unpack&lt;T&gt; æ˜¯åˆ é™¤ä¸€ä¸ªèµ„æºç±»åž‹Tçš„å”¯ä¸€æ–¹å¼ã€‚å®ƒæŽ¥å—ç±»åž‹ä¸ºTçš„èµ„æºä½œä¸ºè¾“å…¥ï¼Œé”€æ¯å®ƒï¼Œå¹¶è¿”å›žç»‘å®šåˆ°èµ„æºå­—æ®µçš„å€¼ã€‚åƒUnpackè¿™æ ·çš„æ¨¡å—å†…å»ºåªèƒ½ç”¨äºŽå½“å‰æ¨¡å—ä¸­å£°æ˜Žçš„èµ„æºã€‚åœ¨Unpackçš„æƒ…å†µä¸‹ï¼Œæ­¤çº¦æŸå¯é˜²æ­¢å…¶ä»–ä»£ç ç ´åCoinï¼Œä»Žè€Œå…è®¸Currencyæ¨¡å—è®¾ç½®è‡ªå®šä¹‰çš„é”€æ¯Coinèµ„æºçš„å‰ææ¡ä»¶(ä¾‹å¦‚ï¼Œå®ƒåªèƒ½é€‰æ‹©å…è®¸é”€æ¯é›¶å€¼é’±å¸) ç¬¬ä¸‰è¡Œè°ƒç”¨çš„BorrowGlobalè¿‡ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªæ¨¡å—æž„å»ºï¼ŒBorrowGlobal&lt;T&gt;å°†ä¸€ä¸ªåœ°å€ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›žå¯¹åœ¨è¯¥åœ°å€ä¸‹å‘å¸ƒçš„Tçš„æƒŸä¸€å®žä¾‹çš„å¼•ç”¨ã€‚ è¿™æ„å‘³ç€ä¸Šé¢ä»£ç ä¸­çš„coin_refç±»åž‹æ˜¯&amp;mut Coin å¯¹Coinèµ„æºçš„å¯å˜å¼•ç”¨,è¿™ä¸æ˜¯Coin-è¿™æ˜¯ä¸€ä¸ªæ‹¥æœ‰çš„Coinèµ„æºã€‚ä¸‹ä¸€è¡Œå°†å¼•ç”¨å€¼ç»‘å®šåˆ°coin_refï¼Œä»¥ä¾¿èŽ·å¾—æŒ‡å‘ç¡¬å¸å€¼å­—æ®µçš„coin_value_refå¼•ç”¨ã€‚ç¨‹åºçš„æœ€åŽå‡ è¡Œè¯»å–æ”¶æ¬¾äººCoinèµ„æºçš„å‰ä¸€ä¸ªå€¼ï¼Œå¹¶ä¿®æ”¹coin_value_refä»¥åæ˜ å­˜æ¬¾é‡‘é¢ æˆ‘ä»¬æ³¨æ„åˆ°ï¼ŒMoveç±»åž‹ç³»ç»Ÿä¸èƒ½æ•èŽ·æ¨¡å—ä¸­æ‰€æœ‰çš„å®žçŽ°é”™è¯¯ã€‚ä¾‹å¦‚ï¼Œç±»åž‹ç³»ç»Ÿä¸ä¼šç¡®ä¿æ‰€æœ‰çŽ°å­˜Coinçš„æ€»ä»·å€¼éƒ½é€šè¿‡å­˜æ¬¾é€šçŸ¥æ¥ä¿å­˜, å¦‚æžœç¨‹åºå‘˜å†™é”™äº†*move(coin_value_ref) = 1 + move(coin_value) + move(to_deposit_value)åœ¨æœ€åŽä¸€è¡Œï¼Œç±»åž‹ç³»ç»Ÿå°†æ¯«æ— ç–‘é—®åœ°æŽ¥å—ä»£ç ,è¿™å°±æ˜Žç¡®äº†èŒè´£åˆ’åˆ†:åœ¨æ¨¡å—å†…éƒ¨ä¸ºCoinå»ºç«‹åˆé€‚çš„å®‰å…¨ä¸å˜é‡æ˜¯ç¨‹åºå‘˜çš„å·¥ä½œï¼Œç¡®ä¿æ¨¡å—å¤–éƒ¨çš„Coinå®¢æˆ·ç«¯ä¸èƒ½è¿åè¿™äº›ä¸å˜é‡æ˜¯ç±»åž‹ç³»ç»Ÿçš„å·¥ä½œã€‚ Implementing withdraw_from_senderã€‚ åœ¨ä¸Šè¿°å®žçŽ°ä¸­ï¼Œé€šè¿‡å­˜æ¬¾ç¨‹åºå­˜å…¥èµ„é‡‘ä¸éœ€è¦ä»»ä½•æŽˆæƒâ€”â€”ä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨å­˜æ¬¾ã€‚ç›¸åï¼Œä»Žå¸æˆ·ä¸­å–æ¬¾å¿…é¡»å—åˆ°è®¿é—®æŽ§åˆ¶ç­–ç•¥çš„ä¿æŠ¤ï¼Œè¯¥ç­–ç•¥å‘è´§å¸èµ„æºçš„æ‰€æœ‰è€…æŽˆäºˆç‹¬å ç‰¹æƒã€‚è®©æˆ‘ä»¬çœ‹çœ‹ç”±å¯¹ç­‰æ”¯ä»˜äº‹åŠ¡è„šæœ¬è°ƒç”¨çš„æŠ½å‡ºwithdraw_from_senderè¿‡ç¨‹å¦‚ä½•å®žçŽ°æ­¤æŽˆæƒ è¿™ä¸ªè¿‡ç¨‹å‡ ä¹Žä¸Žå­˜æ¬¾ç›¸åï¼Œä½†ä¹Ÿä¸å®Œå…¨ç›¸åã€‚å®ƒ: èŽ·å–å¯¹å‘é€æ–¹å¸æˆ·ä¸‹å‘å¸ƒçš„Coinç±»åž‹çš„æƒŸä¸€èµ„æºçš„å¼•ç”¨ å°†referenced Coin çš„å€¼å‡åŽ»è¾“å…¥é‡ åˆ›å»ºå¹¶è¿”å›žä¸€ä¸ªå¸¦æœ‰value amountçš„æ–°Coinèµ„æº è¿™ä¸ªè¿‡ç¨‹æ‰§è¡Œçš„è®¿é—®æŽ§åˆ¶æ£€æŸ¥æœ‰ç‚¹å¾®å¦™ã€‚depositè¿‡ç¨‹å…è®¸è°ƒç”¨è€…æŒ‡å®šä¼ é€’ç»™BorrowGlobalçš„åœ°å€ï¼Œä½†æ˜¯withdraw_from_senderåªèƒ½ä¼ é€’GetTxnSenderAddressè¿”å›žçš„åœ°å€ï¼Œæ­¤è¿‡ç¨‹æ˜¯å‡ ä¸ªå†…ç½®äº‹åŠ¡ä¹‹ä¸€ï¼Œå…è®¸Moveä»£ç ä»Žå½“å‰æ­£åœ¨æ‰§è¡Œçš„äº‹åŠ¡ä¸­è¯»å–æ•°æ®ã€‚Move virtual machineåœ¨æ‰§è¡Œäº‹åŠ¡ä¹‹å‰å¯¹å‘é€æ–¹åœ°å€è¿›è¡Œèº«ä»½éªŒè¯ã€‚ä½¿ç”¨å€Ÿç”¨å…¨å±€å†…ç½®å‡½æ•°ä»¥è¿™ç§æ–¹å¼ç¡®ä¿äº¤æ˜“çš„å‘é€æ–¹åªèƒ½ä»Žè‡ªå·±çš„Coinèµ„æºä¸­æå–èµ„é‡‘ã€‚ ä¸Žæ‰€æœ‰å†…ç½®æ¨¡å—ä¸€æ ·ï¼ŒBorrowGlobal&lt;Coin&gt;åªèƒ½åœ¨å£°æ˜Žçš„æ¨¡å—ä¸­è°ƒç”¨Coinã€‚å¦‚æžœCurrencyæ¨¡å—æ²¡æœ‰å…¬å¼€ä¸€ä¸ªè¿”å›žBorrowGlobalç»“æžœçš„è¿‡ç¨‹ï¼Œåˆ™Currencyæ¨¡å—ä¹‹å¤–çš„ä»£ç æ— æ³•èŽ·å¾—å¯¹å…¨å±€å­˜å‚¨ä¸­å‘å¸ƒçš„Coinèµ„æºçš„å¼•ç”¨ã€‚ åœ¨é™ä½Žäº‹åŠ¡å‘é€æ–¹çš„Coinèµ„æºçš„å€¼ä¹‹å‰ï¼Œè¯¥è¿‡ç¨‹æ–­è¨€ç¡¬å¸çš„å€¼å¤§äºŽæˆ–ç­‰äºŽä½¿ç”¨RejectUnlessæŒ‡ä»¤è¾“å…¥çš„æ­£å¼é‡‘é¢ã€‚è¿™å¯ä»¥ç¡®ä¿å‘é€è€…ä¸èƒ½å–æ¯”å¥¹å¤šçš„é’±ã€‚å¦‚æžœè¯¥æ£€æŸ¥å¤±è´¥ï¼Œå½“å‰äº‹åŠ¡è„šæœ¬çš„æ‰§è¡Œå°†åœæ­¢ï¼Œå®ƒæ‰§è¡Œçš„ä»»ä½•æ“ä½œéƒ½ä¸ä¼šåº”ç”¨åˆ°å…¨å±€çŠ¶æ€ã€‚ æœ€åŽï¼Œè¯¥è¿‡ç¨‹æŒ‰æ•°é‡å‡å°‘å‘é€æ–¹ç¡¬å¸çš„ä»·å€¼ï¼Œå¹¶ä½¿ç”¨Pack(Pack module builtin)åˆ›å»ºä¸€ä¸ªæ–°çš„Coinèµ„æºã€‚Pack&lt;T&gt;åˆ›å»ºäº†ä¸€ä¸ªTç±»åž‹çš„æ–°èµ„æºï¼Œå°±åƒUnpack&lt;T&gt;ä¸€æ ·ï¼ŒPack&lt;T&gt;åªèƒ½åœ¨èµ„æºTçš„å£°æ˜Žæ¨¡å—ä¸­è°ƒç”¨ã€‚åœ¨è¿™é‡Œï¼ŒPackç”¨äºŽåˆ›å»ºä¸€ä¸ªç±»åž‹ä¸ºCoinçš„èµ„æºnew_coinå¹¶å°†å…¶ç§»åŠ¨åˆ°è°ƒç”¨æ–¹ã€‚è°ƒç”¨è€…çŽ°åœ¨æ‹¥æœ‰è¿™ä¸ªCoinèµ„æºï¼Œå¯ä»¥å°†å®ƒç§»åŠ¨åˆ°ä»»ä½•å¥¹å–œæ¬¢çš„åœ°æ–¹ã€‚åœ¨ç¬¬4.1èŠ‚çš„ç¤ºä¾‹äº‹åŠ¡è„šæœ¬ä¸­ï¼Œè°ƒç”¨è€…é€‰æ‹©å°†Coinå­˜å…¥æ”¶æ¬¾äººçš„å¸æˆ·ã€‚ Moveè¯­è¨€åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»Moveè¯­è¨€ã€å­—èŠ‚ç éªŒè¯å™¨å’Œè™šæ‹Ÿæœºçš„åŠå½¢å¼åŒ–æè¿°ã€‚é™„å½•Aè¯¦ç»†åœ°åˆ—å‡ºäº†æ‰€æœ‰è¿™äº›ç»„ä»¶ï¼Œä½†æ²¡æœ‰é™„å¸¦ä»»ä½•æ–‡å­—ã€‚æˆ‘ä»¬è¿™é‡Œçš„è®¨è®ºå°†ä½¿ç”¨é™„å½•ä¸­çš„æ‘˜å½•ï¼Œå¹¶å¶å°”å¼•ç”¨å…¶ä¸­å®šä¹‰çš„ç¬¦å·ã€‚ Moveçš„ç›®æ ‡æ˜¯ä½¿ç¨‹åºå‘˜èƒ½å¤Ÿå®šä¹‰å…¨å±€åŒºå—é“¾çŠ¶æ€ï¼Œå¹¶å®‰å…¨åœ°å®žçŽ°æ›´æ–°å…¨å±€çŠ¶æ€çš„æ“ä½œã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬4.2èŠ‚ä¸­æ‰€è§£é‡Šçš„ï¼Œå…¨å±€çŠ¶æ€è¢«ç»„ç»‡ä¸ºä»Žåœ°å€åˆ°å¸æˆ·çš„éƒ¨åˆ†æ˜ å°„ã€‚å¸æˆ·åŒæ—¶åŒ…å«èµ„æºæ•°æ®å€¼å’Œæ¨¡å—ä»£ç å€¼ã€‚å¸æˆ·ä¸­çš„ä¸åŒèµ„æºå¿…é¡»å…·æœ‰ä¸åŒçš„æ ‡è¯†ç¬¦ã€‚å¸æˆ·ä¸­çš„ä¸åŒæ¨¡å—å¿…é¡»æœ‰ä¸åŒçš„åç§°ã€‚ æ¨¡å—ç”±åç§°ã€ç»“æž„å£°æ˜Ž(åŒ…æ‹¬èµ„æºï¼Œç¨åŽæˆ‘ä»¬å°†è§£é‡Š)å’Œç¨‹åºå£°æ˜Žã€‚ä»£ç å¯ä»¥ä½¿ç”¨ç”±æ¨¡å—çš„å¸æˆ·åœ°å€å’Œæ¨¡å—åç§°ç»„æˆçš„å”¯ä¸€æ ‡è¯†ç¬¦å¼•ç”¨å·²å‘å¸ƒçš„æ¨¡å—ã€‚æ¨¡å—æ ‡è¯†ç¬¦å……å½“ä¸€ä¸ªå‘½åç©ºé—´ï¼Œå®ƒé™å®šæ¨¡å—å¤–éƒ¨ä»£ç çš„ç»“æž„ç±»åž‹å’Œè¿‡ç¨‹çš„æ ‡è¯†ç¬¦ã€‚Moveæ¨¡å—æ”¯æŒå¼ºå¤§çš„æ•°æ®æŠ½è±¡ã€‚æ¨¡å—çš„è¿‡ç¨‹ç¼–ç ç”¨äºŽåˆ›å»ºã€ç¼–å†™å’Œé”€æ¯æ¨¡å—å£°æ˜Žçš„ç±»åž‹çš„è§„åˆ™ã€‚ç±»åž‹åœ¨å…¶å£°æ˜Žæ¨¡å—å†…éƒ¨æ˜¯é€æ˜Žçš„ï¼Œåœ¨å¤–éƒ¨æ˜¯ä¸é€æ˜Žçš„ã€‚Moveæ¨¡å—è¿˜å¯ä»¥é€šè¿‡MoveToSenderæŒ‡ä»¤å¼ºåˆ¶å‘å¸ƒå¸æˆ·ä¸‹çš„èµ„æºçš„å…ˆå†³æ¡ä»¶ï¼Œé€šè¿‡BorrowGlobalæŒ‡ä»¤èŽ·å–å¯¹å¸æˆ·ä¸‹èµ„æºçš„å¼•ç”¨ï¼Œå¹¶é€šè¿‡MoveFromæŒ‡ä»¤ä»Žå¸æˆ·ä¸­åˆ é™¤èµ„æºã€‚ æ¨¡å—ä½¿Moveç¨‹åºå‘˜èƒ½å¤Ÿçµæ´»åœ°ä¸ºèµ„æºå®šä¹‰ä¸°å¯Œçš„è®¿é—®æŽ§åˆ¶ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œæ¨¡å—å¯ä»¥å®šä¹‰ä¸€ä¸ªåªèƒ½åœ¨få­—æ®µä¸ºé›¶æ—¶é”€æ¯çš„èµ„æºç±»åž‹ï¼Œæˆ–è€…ä¸€ä¸ªåªèƒ½åœ¨ç‰¹å®šå¸æˆ·åœ°å€ä¸‹å‘å¸ƒçš„èµ„æºã€‚ Moveæ”¯æŒåŸºæœ¬ç±»åž‹ï¼ŒåŒ…æ‹¬å¸ƒå°”å€¼ã€64ä½æ— ç¬¦å·æ•´æ•°ã€256ä½å¸æˆ·åœ°å€å’Œå›ºå®šå¤§å°çš„å­—èŠ‚æ•°ç»„ã€‚structæ˜¯ç”±æ¨¡å—å£°æ˜Žçš„ç”¨æˆ·å®šä¹‰ç±»åž‹ã€‚é€šè¿‡ç”¨èµ„æºç±»åž‹æ ‡è®°ç»“æž„ç±»åž‹ï¼Œå¯ä»¥å°†å…¶æŒ‡å®šä¸ºèµ„æºã€‚æ‰€æœ‰å…¶ä»–ç±»åž‹ï¼ŒåŒ…æ‹¬éžèµ„æºç»“æž„ç±»åž‹å’ŒåŸºæœ¬ç±»åž‹ï¼Œéƒ½ç§°ä¸ºæ— é™åˆ¶ç±»åž‹ã€‚ èµ„æºç±»åž‹çš„å˜é‡æ˜¯èµ„æºå˜é‡;æ— çº¦æŸç±»åž‹çš„å˜é‡æ˜¯æ— çº¦æŸå˜é‡ã€‚å­—èŠ‚ç éªŒè¯å™¨å¯¹èµ„æºç±»åž‹çš„èµ„æºå˜é‡å’Œç»“æž„å­—æ®µæ–½åŠ é™åˆ¶ï¼Œèµ„æºå˜é‡ä¸èƒ½å¤åˆ¶ï¼Œå¿…é¡»å§‹ç»ˆç§»åŠ¨ã€‚èµ„æºå˜é‡å’Œèµ„æºç±»åž‹çš„structå­—æ®µéƒ½ä¸èƒ½é‡æ–°åˆ†é…â€”â€”è¿™æ ·åšä¼šç ´åå…ˆå‰ä¿å­˜åœ¨å­˜å‚¨ä½ç½®ä¸­çš„èµ„æºå€¼ã€‚æ­¤å¤–ï¼Œå¯¹èµ„æºç±»åž‹çš„å¼•ç”¨ä¸èƒ½å–æ¶ˆå¼•ç”¨ï¼Œå› ä¸ºè¿™å°†ç”ŸæˆåŸºç¡€èµ„æºçš„å‰¯æœ¬ã€‚ç›¸åï¼Œä¸å—é™åˆ¶çš„ç±»åž‹å¯ä»¥å¤åˆ¶ã€é‡æ–°åˆ†é…å’Œå–æ¶ˆå¼•ç”¨ã€‚ æœ€åŽï¼Œä¸å—é™åˆ¶çš„ç»“æž„ç±»åž‹å¯èƒ½ä¸åŒ…å«å…·æœ‰èµ„æºç±»åž‹çš„å­—æ®µã€‚æ­¤é™åˆ¶ç¡®ä¿(a)å¤åˆ¶æ— é™åˆ¶ç»“æž„ä¸ä¼šå¯¼è‡´å¤åˆ¶åµŒå¥—èµ„æºï¼Œ(b)é‡æ–°åˆ†é…æ— é™åˆ¶ç»“æž„ä¸ä¼šå¯¼è‡´é”€æ¯åµŒå¥—èµ„æºã€‚ å¼•ç”¨ç±»åž‹å¯ä»¥æ˜¯å¯å˜çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸å¯å˜çš„;ä¸å…è®¸é€šè¿‡ä¸å¯å˜å¼•ç”¨è¿›è¡Œå†™æ“ä½œã€‚å­—èŠ‚ç éªŒè¯å™¨æ‰§è¡Œå¼•ç”¨å®‰å…¨æ£€æŸ¥ï¼Œæ‰§è¡Œè¿™äº›è§„åˆ™ä»¥åŠå¯¹èµ„æºç±»åž‹çš„é™åˆ¶(å‚è§5.2èŠ‚)ã€‚ é™¤äº†ç»“æž„å’ŒåŸºæœ¬å€¼ä¹‹å¤–ï¼ŒMoveè¿˜æ”¯æŒå¼•ç”¨å€¼ã€‚å¼•ç”¨ä¸Žå…¶ä»–ç§»åŠ¨å€¼ä¸åŒï¼Œå› ä¸ºå®ƒä»¬æ˜¯çž¬æ€çš„ã€‚å­—èŠ‚ç éªŒè¯å™¨ä¸å…è®¸å¼•ç”¨ç±»åž‹çš„å­—æ®µã€‚è¿™æ„å‘³ç€å¿…é¡»åœ¨äº‹åŠ¡è„šæœ¬æ‰§è¡ŒæœŸé—´åˆ›å»ºå¼•ç”¨ï¼Œå¹¶åœ¨äº‹åŠ¡è„šæœ¬ç»“æŸä¹‹å‰é‡Šæ”¾å¼•ç”¨ã€‚ å¯¹structå€¼å½¢çŠ¶çš„é™åˆ¶ç¡®ä¿å…¨å±€çŠ¶æ€å§‹ç»ˆæ˜¯æ ‘è€Œä¸æ˜¯ä»»æ„å›¾ï¼ŒçŠ¶æ€æ ‘ä¸­çš„æ¯ä¸ªå­˜å‚¨ä½ç½®å¯ä»¥ä½¿ç”¨å…¶æ­£è§„çš„ä»£è¡¨è®¿é—®è·¯å¾„â€”â€”ä¸€ä¸ªå­˜å‚¨æ ‘ä¸­çš„è·¯å¾„ä»Žä¸€ä¸ªæ ¹(ä¸€ä¸ªå±€éƒ¨å˜é‡ð‘¥æˆ–å…¨çƒèµ„æºå…³é”®ð‘”)åˆ°åŽä»£èŠ‚ç‚¹è¢«å­—æ®µæ ‡è¯†ç¬¦ð‘“åºåˆ—æ ‡è®°ã€‚ è¯¥è¯­è¨€å…è®¸å¯¹åŽŸå§‹å€¼å’Œç»“æž„çš„å¼•ç”¨ï¼Œä½†ä¸å…è®¸å¯¹å…¶ä»–å¼•ç”¨çš„å¼•ç”¨ã€‚Moveç¨‹åºå‘˜å¯ä»¥ä½¿ç”¨BorrowLocæŒ‡ä»¤èŽ·å–å¯¹æœ¬åœ°å˜é‡çš„å¼•ç”¨ï¼Œä½¿ç”¨BorrowFieldæŒ‡ä»¤èŽ·å–å¯¹ç»“æž„çš„å­—æ®µçš„å¼•ç”¨ï¼Œä»¥åŠä½¿ç”¨BorrowGlobalæŒ‡ä»¤ã€‚åŽä¸¤ç§æž„é€ åªèƒ½ç”¨äºŽå½“å‰æ¨¡å—ä¸­å£°æ˜Žçš„ç»“æž„ç±»åž‹ã€‚ è¿‡ç¨‹ç­¾åç”±å¯è§æ€§ã€ç±»åž‹åŒ–å½¢å¼å‚æ•°å’Œè¿”å›žç±»åž‹ç»„æˆã€‚è¿‡ç¨‹å£°æ˜ŽåŒ…å«ç­¾åã€ç±»åž‹åŒ–å±€éƒ¨å˜é‡å’Œå­—èŠ‚ç æŒ‡ä»¤æ•°ç»„ã€‚è¿‡ç¨‹å¯è§æ€§å¯ä»¥æ˜¯å…¬å¼€çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å†…éƒ¨çš„ã€‚å†…éƒ¨è¿‡ç¨‹åªèƒ½ç”±åŒä¸€æ¨¡å—ä¸­çš„å…¶ä»–è¿‡ç¨‹è°ƒç”¨ã€‚ä»»ä½•æ¨¡å—æˆ–äº‹åŠ¡è„šæœ¬éƒ½å¯ä»¥è°ƒç”¨å…¬å…±è¿‡ç¨‹ã€‚ åŒºå—é“¾çŠ¶æ€ç”±ä¸€ä¸ªäº‹åŠ¡è„šæœ¬æ›´æ–°ï¼Œè¯¥è„šæœ¬å¯ä»¥è°ƒç”¨å½“å‰å‘å¸ƒåœ¨å¸æˆ·ä¸‹çš„ä»»ä½•æ¨¡å—çš„å…¬å…±è¿‡ç¨‹ã€‚äº‹åŠ¡è„šæœ¬åªæ˜¯ä¸€ä¸ªæ²¡æœ‰å…³è”æ¨¡å—çš„è¿‡ç¨‹å£°æ˜Žã€‚ ä¸€ä¸ªè¿‡ç¨‹å¯ä»¥ç”±å®ƒçš„æ¨¡å—æ ‡è¯†ç¬¦å’Œå®ƒçš„ç­¾åå”¯ä¸€åœ°æ ‡è¯†ã€‚è°ƒç”¨å­—èŠ‚ç æŒ‡ä»¤éœ€è¦ä¸€ä¸ªæƒŸä¸€çš„è¿‡ç¨‹IDä½œä¸ºè¾“å…¥ã€‚è¿™ç¡®ä¿äº†Moveä¸­çš„æ‰€æœ‰è¿‡ç¨‹è°ƒç”¨éƒ½æ˜¯é™æ€ç¡®å®šçš„â€”â€”æ²¡æœ‰å‡½æ•°æŒ‡é’ˆæˆ–è™šæ‹Ÿè°ƒç”¨ã€‚æ­¤å¤–ï¼Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»é€šè¿‡æž„é€ æ˜¯éžå¾ªçŽ¯çš„ã€‚æ¨¡å—åªèƒ½ä¾èµ–äºŽçº¿æ€§äº‹åŠ¡åŽ†å²ä¸­è¾ƒæ—©å‘å¸ƒçš„æ¨¡å—ã€‚æ— å¾ªçŽ¯æ¨¡å—ä¾èµ–å…³ç³»å›¾å’Œç¼ºä¹åŠ¨æ€åˆ†æ´¾çš„ç»„åˆå¼ºåˆ¶æ‰§è¡Œä¸€ä¸ªå¼ºæ‰§è¡Œä¸å˜é‡:å±žäºŽæ¨¡å—ä¸­çš„è¿‡ç¨‹çš„æ‰€æœ‰å †æ ˆå¸§å¿…é¡»æ˜¯è¿žç»­çš„ã€‚å› æ­¤ï¼Œåœ¨Moveæ¨¡å—ä¸­æ²¡æœ‰ä¸ŽEthereumæ™ºèƒ½åˆçº¦çš„å¯é‡å…¥æ€§é—®é¢˜ç­‰ä»·çš„é—®é¢˜ã€‚ åœ¨æœ¬èŠ‚çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å­—èŠ‚ç æ“ä½œåŠå…¶è¯­ä¹‰(ç¬¬5.1èŠ‚)ï¼Œå¹¶æè¿°å­—èŠ‚ç éªŒè¯å™¨åœ¨å…è®¸æ‰§è¡Œæˆ–å­˜å‚¨æ¨¡å—ä»£ç ä¹‹å‰æ‰§è¡Œçš„é™æ€åˆ†æž(ç¬¬5.2èŠ‚)ã€‚ å­—èŠ‚ç è§£é‡Šå™¨ Moveå­—èŠ‚ç æŒ‡ä»¤ç”±åŸºäºŽå †æ ˆçš„è§£é‡Šå™¨æ‰§è¡Œï¼Œç±»ä¼¼äºŽå…¬å…±è¯­è¨€è¿è¡Œæ—¶å’ŒJavaè™šæ‹Ÿæœºã€‚ä¸€æ¡æŒ‡ä»¤ä»Žå †æ ˆä¸­ä½¿ç”¨æ“ä½œæ•°å¹¶å°†ç»“æžœæŽ¨å…¥å †æ ˆã€‚æŒ‡ä»¤ä¹Ÿå¯ä»¥ä»Žå½“å‰è¿‡ç¨‹çš„å±€éƒ¨å˜é‡(åŒ…æ‹¬å½¢å¼å‚æ•°)ä¸­ç§»åŠ¨å’Œå¤åˆ¶å€¼ã€‚ å­—èŠ‚ç è§£é‡Šå™¨æ”¯æŒè¿‡ç¨‹è°ƒç”¨ã€‚ä¼ é€’ç»™è¢«è°ƒç”¨æ–¹çš„è¾“å…¥å€¼å’Œè¿”å›žç»™è°ƒç”¨æ–¹çš„è¾“å‡ºå€¼ä¹Ÿé€šè¿‡å †æ ˆè¿›è¡Œé€šä¿¡ã€‚é¦–å…ˆï¼Œè°ƒç”¨è€…å°†å‚æ•°æŽ¨é€åˆ°å †æ ˆä¸Šçš„è¿‡ç¨‹ã€‚æŽ¥ä¸‹æ¥ï¼Œè°ƒç”¨è€…è°ƒç”¨CallæŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä¸ºè¢«è°ƒç”¨è€…åˆ›å»ºä¸€ä¸ªæ–°çš„è°ƒç”¨å †æ ˆå¸§ï¼Œå¹¶å°†æŽ¨å…¥çš„å€¼åŠ è½½åˆ°è¢«è°ƒç”¨è€…çš„æœ¬åœ°å˜é‡ä¸­ã€‚æœ€åŽï¼Œå­—èŠ‚ç è§£é‡Šå™¨å¼€å§‹æ‰§è¡Œè¢«è°ƒç”¨è¿‡ç¨‹çš„å­—èŠ‚ç æŒ‡ä»¤ã€‚ å­—èŠ‚ç çš„æ‰§è¡Œé€šè¿‡æŒ‰é¡ºåºæ‰§è¡Œæ“ä½œæ¥è¿›è¡Œï¼Œé™¤éžæœ‰åˆ†æ”¯æ“ä½œå¯¼è‡´è·³è½¬åˆ°å½“å‰è¿‡ç¨‹ä¸­é™æ€ç¡®å®šçš„åç§»é‡ã€‚å½“è¢«è°ƒç”¨æ–¹å¸Œæœ›è¿”å›žæ—¶ï¼Œå®ƒå°†è¿”å›žå€¼æŽ¨å…¥å †æ ˆå¹¶è°ƒç”¨ReturnæŒ‡ä»¤ã€‚æŽ§åˆ¶è¿”å›žç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…å°†æŸ¥æ‰¾å †æ ˆä¸Šçš„è¾“å‡ºå€¼ã€‚ Moveç¨‹åºçš„æ‰§è¡Œä»¥ç±»ä¼¼EVMçš„æ–¹å¼è¿›è¡Œè®¡é‡ã€‚æ¯ä¸ªå­—èŠ‚ç æŒ‡ä»¤éƒ½æœ‰ä¸€ä¸ªç›¸å…³çš„gaså•ä½æˆæœ¬ï¼Œä»»ä½•è¦æ‰§è¡Œçš„äº‹åŠ¡éƒ½å¿…é¡»åŒ…æ‹¬gaså•ä½é¢„ç®—ã€‚è§£é‡Šå™¨è·Ÿè¸ªæ‰§è¡Œè¿‡ç¨‹ä¸­å‰©ä½™çš„gaså•å…ƒï¼Œå¦‚æžœå‰©ä½™æ•°é‡ä¸ºé›¶ï¼Œåˆ™åœæ­¢æ‰§è¡Œå¹¶å‡ºçŽ°é”™è¯¯ã€‚ æˆ‘ä»¬è€ƒè™‘äº†åŸºäºŽå¯„å­˜å™¨å’ŒåŸºäºŽå †æ ˆçš„å­—èŠ‚ç è§£é‡Šå™¨ï¼Œå‘çŽ°å…·æœ‰ç±»åž‹åŒ–å±€éƒ¨å˜é‡çš„å †æ ˆæœºå™¨éžå¸¸é€‚åˆäºŽMoveçš„èµ„æºè¯­ä¹‰ã€‚åœ¨å±€éƒ¨å˜é‡ã€å †æ ˆå’Œè°ƒç”¨è€…/è¢«è°ƒç”¨è€…ä¹‹é—´æ¥å›žç§»åŠ¨å€¼çš„ä½Žçº§æœºåˆ¶ç´§å¯†åœ°åæ˜ äº†ç§»åŠ¨ç¨‹åºçš„é«˜çº§æ„å›¾ã€‚æ²¡æœ‰å±€éƒ¨å˜é‡çš„å †æ ˆæœºå™¨å°†æ›´åŠ å†—é•¿ï¼Œè€Œå¯„å­˜å™¨æœºå™¨å°†ä½¿è·¨è¿‡ç¨‹è¾¹ç•Œç§»åŠ¨èµ„æºå˜å¾—æ›´åŠ å¤æ‚ã€‚ æŒ‡ä»¤ã€‚Moveæ”¯æŒå…­å¤§ç±»å­—èŠ‚ç æŒ‡ä»¤: è¯¸å¦‚CopyLoc/MoveLocä¹‹ç±»çš„æ“ä½œç”¨äºŽå°†æ•°æ®ä»Žæœ¬åœ°å˜é‡å¤åˆ¶/ç§»åŠ¨åˆ°å †æ ˆï¼ŒStoreLocç”¨äºŽå°†æ•°æ®ä»Žå †æ ˆç§»åŠ¨åˆ°æœ¬åœ°å˜é‡ å¯¹ç±»åž‹åŒ–å †æ ˆå€¼çš„æ“ä½œï¼Œå¦‚å°†å¸¸é‡æŽ¨å…¥å †æ ˆï¼Œä»¥åŠå¯¹å †æ ˆæ“ä½œæ•°çš„ç®—æœ¯/é€»è¾‘æ“ä½œã€‚ æ¨¡å—å†…ç½®ç¨‹åºï¼Œä¾‹å¦‚åˆ›å»º/é”€æ¯æ¨¡å—å£°æ˜Žç±»åž‹çš„Packå’ŒUnpackï¼ŒMoveToSender /MoveFromç”¨äºŽåœ¨å¸æˆ·ä¸‹å‘å¸ƒ/å–æ¶ˆå‘å¸ƒæ¨¡å—çš„ç±»åž‹ï¼Œè€ŒBorrowFieldç”¨äºŽèŽ·å–å¯¹æ¨¡å—ç±»åž‹ä¹‹ä¸€çš„å­—æ®µçš„å¼•ç”¨ ä¸Žå¼•ç”¨ç›¸å…³çš„æŒ‡ä»¤ï¼Œå¦‚è¯»å–å¼•ç”¨çš„ReadRefã€å†™å…¥å¼•ç”¨çš„WriteRefã€é”€æ¯å¼•ç”¨çš„ReleaseRefå’Œå°†å¯å˜å¼•ç”¨è½¬æ¢ä¸ºä¸å¯å˜å¼•ç”¨çš„FreezeRefã€‚ æŽ§åˆ¶æµæ“ä½œï¼Œå¦‚æ¡ä»¶åˆ†æ”¯å’Œä»Žè¿‡ç¨‹ä¸­è°ƒç”¨/è¿”å›žã€‚ ç‰¹å®šåŒºå—é“¾çš„å†…ç½®æ“ä½œï¼Œå¦‚èŽ·å–äº‹åŠ¡è„šæœ¬çš„å‘é€æ–¹åœ°å€å’Œåˆ›å»ºæ–°å¸æˆ·ã€‚ é™„å½•Aç»™å‡ºäº†å®Œæ•´çš„Moveå­—èŠ‚ç æŒ‡ä»¤åˆ—è¡¨ã€‚Moveè¿˜æä¾›äº†è¯¸å¦‚sha3ä¹‹ç±»çš„å¯†ç åŽŸè¯­ï¼Œä½†æ˜¯è¿™äº›åŽŸè¯­æ˜¯ä½œä¸ºæ ‡å‡†åº“ä¸­çš„æ¨¡å—å®žçŽ°çš„ï¼Œè€Œä¸æ˜¯ä½œä¸ºå­—èŠ‚ç æŒ‡ä»¤å®žçŽ°çš„ã€‚åœ¨è¿™äº›æ ‡å‡†åº“æ¨¡å—ä¸­ï¼Œè¿‡ç¨‹è¢«å£°æ˜Žä¸ºnativeçš„ï¼Œå¤„ç†è¿‡ç¨‹ç”±Move VMæä¾›ã€‚åªæœ‰VMå¯ä»¥å®šä¹‰æ–°çš„naviteè¿‡ç¨‹ï¼Œè¿™æ„å‘³ç€è¿™äº›å¯†ç åŽŸè¯­å¯ä»¥ä½œä¸ºæ™®é€šçš„å­—èŠ‚ç æŒ‡ä»¤å®žçŽ°ã€‚ä½†æ˜¯ï¼Œnaviteè¿‡ç¨‹éžå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºVMå¯ä»¥ä¾èµ–çŽ°æœ‰çš„æœºåˆ¶æ¥è°ƒç”¨è¿‡ç¨‹ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªå¯†ç åŽŸè¯­é‡æ–°å®žçŽ°è°ƒç”¨çº¦å®šã€‚ å­—èŠ‚ç éªŒè¯å™¨ å­—èŠ‚ç éªŒè¯å™¨çš„ç›®æ ‡æ˜¯ä¸ºæäº¤ç»™å‘å¸ƒçš„ä»»ä½•æ¨¡å—å’Œæäº¤ç»™æ‰§è¡Œçš„ä»»ä½•äº‹åŠ¡è„šæœ¬é™æ€åœ°å¼ºåˆ¶æ‰§è¡Œå®‰å…¨å±žæ€§ã€‚å¦‚æžœä¸é€šè¿‡å­—èŠ‚ç éªŒè¯å™¨ï¼Œå°±ä¸èƒ½å‘å¸ƒæˆ–æ‰§è¡Œä»»ä½•Moveç¨‹åºã€‚ å­—èŠ‚ç éªŒè¯å™¨å¼ºåˆ¶æ‰§è¡Œä»»ä½•æ ¼å¼è‰¯å¥½çš„Moveç¨‹åºéƒ½å¿…é¡»å…·å¤‡çš„ä¸€èˆ¬å®‰å…¨ç‰¹æ€§ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨æœªæ¥çš„å·¥ä½œä¸­ä¸ºç‰¹å®šäºŽç¨‹åºçš„å±žæ€§å¼€å‘ä¸€ä¸ªå•ç‹¬çš„ç¦»çº¿éªŒè¯å™¨(è§ç¬¬7èŠ‚)ã€‚ Moveæ¨¡å—æˆ–äº‹åŠ¡è„šæœ¬çš„äºŒè¿›åˆ¶æ ¼å¼ç¼–ç å®žä½“è¡¨çš„é›†åˆï¼Œå¦‚å¸¸é‡ã€ç±»åž‹ç­¾åã€ç»“æž„å®šä¹‰å’Œè¿‡ç¨‹å®šä¹‰ã€‚éªŒè¯äººè¿›è¡Œçš„æ£€æŸ¥åˆ†ä¸ºä¸‰ç±»: ç»“æž„æ£€æŸ¥ï¼Œç¡®ä¿å­—èŠ‚ç è¡¨æ˜¯æ ¼å¼è‰¯å¥½çš„ã€‚è¿™äº›æ£€æŸ¥ä¼šå‘çŽ°é”™è¯¯ï¼Œå¦‚éžæ³•è¡¨ç´¢å¼•ã€é‡å¤çš„è¡¨é¡¹å’Œéžæ³•ç±»åž‹ç­¾å(å¦‚å¯¹å¼•ç”¨çš„å¼•ç”¨)ã€‚ è¿‡ç¨‹ä½“çš„è¯­ä¹‰æ£€æŸ¥ã€‚è¿™äº›æ£€æŸ¥æ£€æµ‹é”™è¯¯ï¼Œå¦‚ä¸æ­£ç¡®çš„è¿‡ç¨‹å‚æ•°ã€ç©ºå¼•ç”¨å’Œå¤åˆ¶èµ„æºã€‚ å°†ç»“æž„ç±»åž‹å’Œè¿‡ç¨‹ç­¾åçš„ä½¿ç”¨ä¸Žå®ƒä»¬çš„å£°æ˜Žæ¨¡å—ç›¸é“¾æŽ¥ã€‚è¿™äº›æ£€æŸ¥æ£€æµ‹é”™è¯¯ï¼Œä¾‹å¦‚éžæ³•è°ƒç”¨å†…éƒ¨è¿‡ç¨‹å’Œä½¿ç”¨ä¸Žå…¶å£°æ˜Žä¸åŒ¹é…çš„è¿‡ç¨‹æ ‡è¯†ç¬¦ã€‚ åœ¨æœ¬èŠ‚çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†æè¿°è¯­ä¹‰éªŒè¯å’Œé“¾æŽ¥çš„å„ä¸ªé˜¶æ®µã€‚ æŽ§åˆ¶æµå›¾æž„é€  ã€‚ éªŒè¯è€…é€šè¿‡å°†æŒ‡ä»¤åºåˆ—åˆ†è§£ä¸ºä¸€ç»„åŸºæœ¬å—(æ³¨æ„ï¼Œè¿™äº›åŸºæœ¬å—ä¸ŽåŒºå—é“¾ä¸­çš„äº‹åŠ¡â€œå—â€æ— å…³)æ¥æž„é€ ä¸€ä¸ªæŽ§åˆ¶æµå›¾ã€‚æ¯ä¸ªåŸºæœ¬å—åŒ…å«ä¸€ä¸ªè¿žç»­çš„æŒ‡ä»¤åºåˆ—;æ‰€æœ‰æŒ‡ä»¤é›†éƒ½è¢«åˆ’åˆ†åˆ°å—ä¸­ã€‚è¿™ç§åˆ†è§£ä¿è¯äº†åˆ†æ”¯åªä»¥æŸäº›å¼€å§‹çš„åŸºæœ¬å—ä¸ºç›®æ ‡ã€‚åˆ†è§£è¿˜è¯•å›¾ç¡®ä¿ç”Ÿæˆçš„å—æ˜¯æœ€å¤§çš„ã€‚ç„¶è€Œï¼Œå­—èŠ‚ç éªŒè¯å™¨çš„å¯é æ€§å¹¶ä¸ä¾èµ–äºŽæœ€å¤§æ€§ã€‚ å †æ ˆå¹³è¡¡æ£€æŸ¥ ã€‚ å †æ ˆå¹³è¡¡æ£€æŸ¥ç¡®ä¿è¢«è°ƒç”¨æ–¹ä¸èƒ½è®¿é—®å±žäºŽè°ƒç”¨æ–¹çš„å †æ ˆä½ç½®ã€‚åŸºæœ¬å—çš„æ‰§è¡Œå‘ç”Ÿåœ¨å±€éƒ¨æ•°ç»„çš„ä¸Šä¸‹æ–‡çš„å˜é‡å’Œå †æ ˆä¸­ã€‚è¯¥è¿‡ç¨‹çš„å‚æ•°æ˜¯å±€éƒ¨å˜é‡æ•°ç»„çš„å‰ç¼€ã€‚è·¨è¿‡ç¨‹è°ƒç”¨ä¼ é€’å‚æ•°å’Œè¿”å›žå€¼æ˜¯é€šè¿‡å †æ ˆå®Œæˆçš„ã€‚å½“ä¸€ä¸ªè¿‡ç¨‹å¼€å§‹æ‰§è¡Œæ—¶ï¼Œå®ƒçš„å‚æ•°å·²ç»åŠ è½½åˆ°å®ƒçš„å‚æ•°ä¸­ã€‚å‡è®¾å½“ä¸€ä¸ªè¿‡ç¨‹å¼€å§‹æ‰§è¡Œæ—¶ï¼Œå †æ ˆé«˜åº¦ä¸ºnï¼Œæœ‰æ•ˆçš„å­—èŠ‚ç å¿…é¡»æ»¡è¶³ä¸€ä¸ªä¸å˜æ¡ä»¶ï¼Œå³å½“æ‰§è¡Œåˆ°ä¸€ä¸ªåŸºæœ¬å—çš„æœ«å°¾æ—¶ï¼Œæ ˆé«˜ä¸ºnã€‚éªŒè¯è€…é€šè¿‡å•ç‹¬åˆ†æžæ¯ä¸ªåŸºæœ¬å—å¹¶è®¡ç®—æ¯ä¸ªæŒ‡ä»¤å¯¹æ ˆé«˜çš„å½±å“æ¥ç¡®ä¿è¿™ä¸€ç‚¹ã€‚å®ƒæ£€æŸ¥é«˜åº¦ä¸ä½ŽäºŽnï¼Œå¹¶ä¸”åœ¨åŸºæœ¬å—å‡ºå£ä¸ºnã€‚å”¯ä¸€çš„ä¾‹å¤–æ˜¯ä¸€ä¸ªä»¥è¿”å›žæŒ‡ä»¤ç»“å°¾çš„å—ï¼Œå…¶ä¸­é«˜åº¦å¿…é¡»æ˜¯n+m(å…¶ä¸­mæ˜¯è¿‡ç¨‹è¿”å›žçš„å€¼çš„æ•°é‡)ã€‚ ç±»åž‹æ£€æŸ¥ ã€‚ éªŒè¯å™¨çš„ç¬¬äºŒé˜¶æ®µæ£€æŸ¥æ¯æ¡æŒ‡ä»¤å’Œè¿‡ç¨‹(åŒ…æ‹¬æž„å»ºè¿‡ç¨‹å’Œç”¨æˆ·å®šä¹‰è¿‡ç¨‹)æ˜¯å¦ä½¿ç”¨é€‚å½“ç±»åž‹çš„å‚æ•°è°ƒç”¨ã€‚æŒ‡ä»¤çš„æ“ä½œæ•°æ˜¯ä½äºŽå±€éƒ¨å˜é‡æˆ–å †æ ˆä¸Šçš„å€¼ã€‚è¿‡ç¨‹çš„å±€éƒ¨å˜é‡ç±»åž‹å·²ç»åœ¨å­—èŠ‚ç ä¸­æä¾›ã€‚ç„¶è€Œï¼Œå †æ ˆå€¼çš„ç±»åž‹æ˜¯æŽ¨æ–­å‡ºæ¥çš„ã€‚æ¯ä¸ªåŸºæœ¬å—åˆ†åˆ«æ‰§è¡Œæ­¤æŽ¨ç†å’Œæ¯ä¸ªæ“ä½œçš„ç±»åž‹æ£€æŸ¥ã€‚ç”±äºŽæ¯ä¸ªåŸºæœ¬å—å¼€å§‹æ—¶çš„å †æ ˆé«˜åº¦ä¸ºnï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œè¯¥å—æ—¶ä¸ä¼šä½ŽäºŽnï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸ºä»Žnå¼€å§‹çš„å †æ ˆåŽç¼€å»ºæ¨¡ï¼Œä»¥æ£€æŸ¥å—æŒ‡ä»¤çš„ç±»åž‹ã€‚æˆ‘ä»¬ä½¿ç”¨ç±»åž‹å †æ ˆå¯¹è¿™ä¸ªåŽç¼€è¿›è¡Œå»ºæ¨¡ï¼Œå½“å¤„ç†åŸºæœ¬å—ä¸­çš„æŒ‡ä»¤åºåˆ—æ—¶ï¼Œç±»åž‹å°†è¢«æŽ¨å…¥å’Œå¼¹å‡ºã€‚ç±»åž‹å †æ ˆå’Œé™æ€å·²çŸ¥çš„å±€éƒ¨å˜é‡ç±»åž‹è¶³ä»¥å¯¹æ¯ä¸ªå­—èŠ‚ç æŒ‡ä»¤è¿›è¡Œç±»åž‹æ£€æŸ¥ã€‚ ç±»åˆ«æ£€æŸ¥ ã€‚ éªŒè¯è€…åœ¨ç±»åž‹æ£€æŸ¥é˜¶æ®µé€šè¿‡ä»¥ä¸‹é™„åŠ æ£€æŸ¥å¼ºåˆ¶æ‰§è¡Œèµ„æºå®‰å…¨: èµ„æºä¸å¯å¤åˆ¶:CopyLocä¸ç”¨äºŽresourseç±»åž‹çš„æœ¬åœ°å˜é‡ï¼Œå¹¶ä¸”ReadRefä¸ç”¨äºŽç±»åž‹ä¸ºresourceå€¼å¼•ç”¨çš„å †æ ˆå€¼ã€‚ èµ„æºä¸èƒ½è¢«é”€æ¯:PopUnrestrictedä¸ç”¨äºŽresourseç±»åž‹çš„å †æ ˆä½ç½®ï¼ŒStoreLocä¸ç”¨äºŽå·²ç»æ‹¥æœ‰èµ„æºçš„æœ¬åœ°å˜é‡ï¼ŒWriteRefä¸ç”¨äºŽå¯¹resourceç±»åž‹å€¼çš„å¼•ç”¨ã€‚ èµ„æºå¿…é¡»è¢«ä½¿ç”¨: å½“ä¸€ä¸ªè¿‡ç¨‹è¿”å›žæ—¶ï¼Œæ²¡æœ‰å±€éƒ¨å˜é‡å¯ä»¥ä¿å­˜èµ„æºå€¼ï¼Œå¹¶ä¸”è®¡ç®—å †æ ˆä¸­è¢«è°ƒç”¨æ–¹çš„å­—æ®µå¿…é¡»åªä¿å­˜è¿‡ç¨‹çš„è¿”å›žå€¼ã€‚ no-resourceç»“æž„ç±»åž‹ä¸èƒ½å…·æœ‰resourceç±»åž‹å­—æ®µï¼Œå› æ­¤ä¸èƒ½é€šè¿‡(ä¾‹å¦‚)ç”¨resourceå­—æ®µå¤åˆ¶no-resourceç»“æž„æ¥ç ´åè¿™äº›æ£€æŸ¥ã€‚ èµ„æºä¸èƒ½è¢«å› é”™è¯¯è€Œä¸­æ–­çš„ç¨‹åºæ‰§è¡Œæ‰€ç ´åã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬4.2èŠ‚ä¸­æ‰€è§£é‡Šçš„ï¼Œäº‹åŠ¡è„šæœ¬çš„éƒ¨åˆ†æ‰§è¡Œæ‰€äº§ç”Ÿçš„ä»»ä½•çŠ¶æ€æ›´æ”¹éƒ½ä¸ä¼šæäº¤ç»™å…¨å±€çŠ¶æ€ã€‚è¿™æ„å‘³ç€åœ¨è¿è¡Œæ—¶å¤±è´¥æ—¶ä½äºŽå †æ ˆæˆ–å±€éƒ¨å˜é‡ä¸­çš„èµ„æºå°†(æœ‰æ•ˆåœ°)è¿”å›žåˆ°äº‹åŠ¡å¼€å§‹æ‰§è¡Œä¹‹å‰çš„ä½ç½®ã€‚ åŽŸåˆ™ä¸Šï¼Œå¯ä»¥é€šè¿‡ä¸ç»ˆæ­¢çš„ç¨‹åºæ‰§è¡Œä½¿èµ„æºä¸å¯è®¿é—®ã€‚ç„¶è€Œï¼Œç¬¬5.1èŠ‚ä¸­æè¿°çš„æ°”ä½“è®¡é‡æ–¹æ¡ˆç¡®ä¿äº†Moveç¨‹åºçš„æ‰§è¡Œæ€»æ˜¯ç»ˆæ­¢ã€‚ç”¨å®Œgasçš„æ‰§è¡Œä¼šå› é”™è¯¯è€Œåœæ­¢ï¼Œè¿™ä¸ä¼šå¯¼è‡´èµ„æºçš„ä¸¢å¤±(å¦‚ä¸Šæ‰€è¿°)ã€‚ å¼•ç”¨æ£€æŸ¥ ã€‚ ä½¿ç”¨é™æ€å’ŒåŠ¨æ€åˆ†æžç›¸ç»“åˆçš„æ–¹æ³•æ£€æŸ¥å¼•ç”¨çš„å®‰å…¨æ€§ã€‚é™æ€åˆ†æžä»¥ç±»ä¼¼äºŽRustç±»åž‹ç³»ç»Ÿçš„æ–¹å¼ä½¿ç”¨borrowæ£€æŸ¥ï¼Œä½†æ˜¯åœ¨å­—èŠ‚ç çº§åˆ«è€Œä¸æ˜¯æºä»£ç çº§åˆ«æ‰§è¡Œã€‚è¿™äº›å‚è€ƒæ£€æŸ¥ç¡®ä¿äº†ä¸¤ä¸ªå¼ºå±žæ€§: æ‰€æœ‰å¼•ç”¨éƒ½æŒ‡å‘å·²åˆ†é…çš„å­˜å‚¨(å³ï¼Œæ²¡æœ‰ç©ºå¼•ç”¨) æ‰€æœ‰å¼•ç”¨éƒ½å…·æœ‰å®‰å…¨çš„è¯»å’Œå†™è®¿é—®æƒé™ã€‚å¼•ç”¨è¦ä¹ˆæ˜¯å…±äº«çš„(æ²¡æœ‰å†™è®¿é—®å’Œè‡ªç”±è¯»è®¿é—®)ï¼Œè¦ä¹ˆæ˜¯ç‹¬å çš„(åªæœ‰æœ‰é™çš„è¯»å’Œå†™è®¿é—®) ä¸ºäº†ç¡®ä¿è¿™äº›å±žæ€§å¯¹é€šè¿‡BorrowGlobalåˆ›å»ºçš„å…¨å±€å­˜å‚¨ä¸­çš„å¼•ç”¨æœ‰æ•ˆï¼Œå­—èŠ‚ç è§£é‡Šå™¨æ‰§è¡Œè½»é‡çº§åŠ¨æ€å¼•ç”¨è®¡æ•°ã€‚è§£é‡Šå™¨è·Ÿè¸ªæ¯ä¸ªå·²å‘å¸ƒèµ„æºçš„æœªå®Œæˆå¼•ç”¨çš„æ•°é‡ã€‚å¦‚æžœåœ¨å¯¹å…¨å±€èµ„æºçš„å¼•ç”¨ä»ç„¶å­˜åœ¨æ—¶å€Ÿç”¨æˆ–ç§»åŠ¨äº†è¯¥èµ„æºï¼Œåˆ™ä½¿ç”¨æ­¤ä¿¡æ¯åœæ­¢ï¼Œå¹¶å‡ºçŽ°é”™è¯¯ã€‚ ä¸Žå…¨å±€çŠ¶æ€è¿žæŽ¥ åœ¨å­—èŠ‚ç éªŒè¯è¿‡ç¨‹ä¸­ï¼ŒéªŒè¯å™¨å‡è®¾å½“å‰ä»£ç å•å…ƒä½¿ç”¨çš„å¤–éƒ¨ç»“æž„ç±»åž‹å’Œè¿‡ç¨‹IDå­˜åœ¨å¹¶è¢«çœŸå®žåœ°è¡¨ç¤ºã€‚é“¾æŽ¥æ­¥éª¤æ£€æŸ¥è¿™ç§å‡è®¾é€šè¿‡é˜…è¯»çš„ç»“æž„å’Œè¿‡ç¨‹å£°æ˜Žå…¨å±€çŠ¶æ€Î£å’Œç¡®ä¿å£°æ˜ŽåŒ¹é…ä½¿ç”¨ã€‚å…·ä½“åœ°è¯´ï¼Œé“¾æŽ¥å™¨æ£€æŸ¥å…¨å±€çŠ¶æ€ä¸­çš„ä¸‹åˆ—å£°æ˜Žæ˜¯å¦åŒ¹é…å®ƒä»¬åœ¨å½“å‰ä»£ç å•å…ƒä¸­çš„ç”¨æ³•: ç»“æž„å£°æ˜Ž(åç§°å’Œç±»åž‹): è¿‡ç¨‹ç­¾å(åç§°ã€å¯è§æ€§ã€å½¢å¼å‚æ•°ç±»åž‹å’Œè¿”å›žç±»åž‹)ã€‚ Moveè™šæ‹Ÿæœº ï¼šæŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½æ”¾ä¸€èµ· Moveè™šæ‹Ÿæœºçš„ä½œç”¨æ˜¯æ‰§è¡Œä¸€ä¸ªåŒºå—ðµä»Žå…¨çƒçš„äº¤æ˜“çŠ¶æ€Î£å¹¶äº§ç”Ÿä¸€ä¸ªäº‹åŠ¡å½±å“ð¸ä»£è¡¨ä¿®æ”¹å…¨å±€çŠ¶æ€ã€‚å½±å“ð¸å¯ä»¥åº”ç”¨äºŽÎ£ç”ŸæˆçŠ¶æ€Î£â€²ä½œä¸ºåŒºå—ðµçš„æ‰§è¡Œçš„ç»“æžœã€‚å°†æ•ˆæžœä¸Žå®žé™…çŠ¶æ€æ›´æ–°åˆ†ç¦»ï¼Œå…è®¸VMåœ¨æ‰§è¡Œå¤±è´¥çš„æƒ…å†µä¸‹å®žçŽ°äº‹åŠ¡è¯­ä¹‰ã€‚ ç›´è§‚åœ°è¯´ï¼Œäº‹åŠ¡æ•ˆæžœè¡¨ç¤ºå¯¹å¸æˆ·å­é›†çš„å…¨å±€çŠ¶æ€çš„æ›´æ–°ã€‚äº‹åŠ¡æ•ˆæžœå…·æœ‰ä¸Žå…¨å±€çŠ¶æ€ç›¸åŒçš„ç»“æž„:å®ƒæ˜¯ä¸€ä¸ªä»Žå¸æˆ·åœ°å€åˆ°å¸æˆ·çš„éƒ¨åˆ†æ˜ å°„ï¼Œå…¶ä¸­åŒ…å«Moveæ¨¡å—å’Œèµ„æºå€¼çš„è§„èŒƒåŒ–åºåˆ—åŒ–è¡¨ç¤ºã€‚è§„èŒƒåŒ–åºåˆ—åŒ–å®žçŽ°äº†ä»ŽMoveæ¨¡å—æˆ–èµ„æºåˆ°å­—èŠ‚æ•°ç»„çš„ä¸Žè¯­è¨€æ— å…³çš„1-1 functionã€‚ ä¸ºäº†ä»ŽçŠ¶æ€Î£ð‘–âˆ’1æ‰§è¡ŒåŒºå—ðµ, VMä»ŽBä¸­èŽ·å–ä¸€ä¸ªäº‹åŠ¡ð‘‡ð‘– ã€‚æ‰§è¡Œå®ƒå¹¶äº§ç”Ÿäº§ç”Ÿå½±å“ð¸ð‘–ã€‚,ç„¶åŽåº”ç”¨ð¸ð‘–åˆ°Î£ð‘–âˆ’1ä¸ŠåŽ»ç”Ÿäº§çŠ¶æ€Î£ð‘–ï¼Œç”¨ä½œåŒºå—ä¸­ç”Ÿäº§ä¸€ä¸ªäº¤æ˜“çš„åˆå§‹çŠ¶æ€ã€‚æ•´ä¸ªå—çš„effectæœ‰åºç»„åˆæž„æˆäº†åŒºå—çš„effectsã€‚ æ¯ä¸ªäº‹åŠ¡éƒ½æ ¹æ®å·¥ä½œæµè¿›è¡Œå¤„ç†ï¼Œå·¥ä½œæµåŒ…æ‹¬éªŒè¯äº‹åŠ¡ä¸­çš„å­—èŠ‚ç å’Œæ£€æŸ¥äº‹åŠ¡å‘é€æ–¹çš„ç­¾åç­‰æ­¥éª¤ã€‚ çŽ°åœ¨ï¼Œå—ä¸­çš„äº‹åŠ¡ç”±VMæŒ‰é¡ºåºæ‰§è¡Œï¼Œä½†æ˜¯Moveè¯­è¨€è¢«è®¾è®¡ä¸ºæ”¯æŒå¹¶è¡Œæ‰§è¡Œã€‚åŽŸåˆ™ä¸Š,æ‰§è¡Œä¸€ä¸ªäº‹åŠ¡å¯ä»¥äº§ç”Ÿä¸€ç³»åˆ—çš„è¯»å–ä»¥åŠä¸€ç»„å†™ð¸å½±å“ã€‚å—ä¸­çš„æ¯ä¸ªäº‹åŠ¡éƒ½å¯ä»¥æŽ¨æµ‹åœ°å¹¶è¡Œæ‰§è¡Œï¼Œåªæœ‰å½“å…¶è¯»/å†™é›†ä¸Žå—ä¸­çš„å¦ä¸€ä¸ªäº‹åŠ¡å†²çªæ—¶æ‰å¯ä»¥é‡æ–°æ‰§è¡Œã€‚æ£€æŸ¥å†²çªéžå¸¸ç®€å•ï¼Œå› ä¸ºMoveçš„æ ‘å†…å­˜æ¨¡åž‹å…è®¸æˆ‘ä»¬ä½¿ç”¨å…¨å±€å†…å­˜å•å…ƒçš„è®¿é—®è·¯å¾„æƒŸä¸€åœ°æ ‡è¯†å®ƒã€‚å¦‚æžœè™šæ‹Ÿæœºæ€§èƒ½æˆä¸ºLibraåŒºå—é“¾çš„ç“¶é¢ˆï¼Œæˆ‘ä»¬å°†åœ¨æœªæ¥æŽ¢ç´¢æŠ•æœºæ€§çš„æ‰§è¡Œæ–¹æ¡ˆã€‚ moveä¸‹ä¸€æ­¥åšä»€ä¹ˆåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»è®¾è®¡å¹¶å®žçŽ°äº†Moveçš„ä»¥ä¸‹ç»„ä»¶: ä¸€ä¸ªé€‚åˆåŒºå—é“¾æ‰§è¡Œçš„ç¼–ç¨‹æ¨¡åž‹ã€‚ ä¸€ç§é€‚åˆè¿™ç§å¯ç¼–ç¨‹æ¨¡åž‹çš„å­—èŠ‚ç è¯­è¨€ ç”¨äºŽå®žçŽ°å…·æœ‰å¼ºå¤§æ•°æ®æŠ½è±¡å’Œè®¿é—®æŽ§åˆ¶çš„åº“çš„æ¨¡å—ç³»ç»Ÿ ç”±åºåˆ—åŒ–å™¨/ååºåˆ—åŒ–å™¨ã€å­—èŠ‚ç éªŒè¯å™¨å’Œå­—èŠ‚ç è§£é‡Šå™¨ç»„æˆçš„è™šæ‹Ÿæœºã€‚ å°½ç®¡å–å¾—äº†è¿™äº›è¿›å±•ï¼Œä½†å‰é¢è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚æœ€åŽï¼Œæˆ‘ä»¬è®¨è®ºäº†ä¸€äº›è¿‘æœŸçš„ä¸‹ä¸€æ­¥ä¸¾æŽªå’Œé•¿æœŸçš„Moveè®¡åˆ’ã€‚ å®žçŽ°æ ¸å¿ƒlibraåŒºå—é“¾åŠŸèƒ½: æˆ‘ä»¬å°†ä½¿ç”¨Moveæ¥å®žçŽ°LibraåŒºå—é“¾çš„æ ¸å¿ƒåŠŸèƒ½:è´¦æˆ·ã€libra coinã€libraå‚¨å¤‡ç®¡ç†ã€éªŒè¯å™¨èŠ‚ç‚¹çš„æ·»åŠ å’Œåˆ é™¤ã€æ”¶å–å’Œåˆ†é…äº¤æ˜“è´¹ç”¨ã€å†·é’±åŒ…ç­‰ã€‚è¿™é¡¹å·¥ä½œå·²åœ¨è¿›è¡Œä¸­ æ–°çš„è¯­è¨€ç‰¹æ€§: æˆ‘ä»¬å°†å‘Moveè¯­è¨€æ·»åŠ å‚æ•°å¤šæ€æ€§(æ³›åž‹)ã€é›†åˆå’Œäº‹ä»¶ã€‚å‚æ•°å¤šæ€æ€§ä¸ä¼šç ´åMoveçŽ°æœ‰çš„å®‰å…¨æ€§å’Œå¯éªŒè¯æ€§ä¿è¯ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬å°†å¼€å‘ä¸€ä¸ªå¯ä¿¡çš„æœºåˆ¶ï¼Œç”¨äºŽç‰ˆæœ¬æŽ§åˆ¶å’Œæ›´æ–°Moveæ¨¡å—ã€äº‹åŠ¡è„šæœ¬å’Œå‘å¸ƒèµ„æºã€‚ æé«˜å¼€å‘äººå‘˜çš„ä½“éªŒï¼š Move IR æ˜¯è¢«æ¥å¼€å‘ç”¨ä½œ Moveå­—èŠ‚ç æ ¡éªŒå™¨å’Œè™šæ‹Ÿæœºçš„æµ‹è¯•å·¥å…·ã€‚è¦è¿è¡Œè¿™äº›ç»„ä»¶ï¼ŒIRç¼–è¯‘å™¨å¿…é¡»æ•…æ„ç”Ÿæˆåçš„å­—èŠ‚ç ï¼Œè¿™äº›åçš„å­—èŠ‚ç å°†è¢«(ä¾‹å¦‚)å­—èŠ‚ç éªŒè¯å™¨æ‹’ç»ã€‚è¿™æ„å‘³ç€å°½ç®¡IRé€‚ç”¨äºŽåŽŸåž‹åŒ–ç§»åŠ¨ç¨‹åºï¼Œä½†å®ƒå¹¶ä¸ç‰¹åˆ«å‹å¥½ã€‚ä¸ºäº†ä½¿Moveå¯¹ç¬¬ä¸‰æ–¹å¼€å‘æ›´å…·å¸å¼•åŠ›ï¼Œæˆ‘ä»¬å°†æ”¹è¿›IRå¹¶è‡´åŠ›äºŽå¼€å‘ç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„Moveæºè¯­è¨€ã€‚ å½¢å¼åŒ–æè¿°ä¸ŽéªŒè¯æ–¹æ³•: æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªé€»è¾‘è§„èŒƒè¯­è¨€å’Œè‡ªåŠ¨åŒ–çš„å½¢å¼åŒ–éªŒè¯å·¥å…·ï¼Œè¯¥å·¥å…·åˆ©ç”¨äº†Moveçš„éªŒè¯å‹å¥½è®¾è®¡(å‚è§3.4èŠ‚)ã€‚éªŒè¯å·¥å…·é“¾å°†æ£€æŸ¥ç‰¹å®šäºŽç¨‹åºçš„åŠŸèƒ½æ­£ç¡®æ€§å±žæ€§ï¼Œè¿™äº›å±žæ€§è¶…å‡ºäº†Moveå­—èŠ‚ç éªŒè¯å™¨æ‰§è¡Œçš„å®‰å…¨ä¿è¯(ç¬¬5.2èŠ‚)ã€‚æˆ‘ä»¬æœ€åˆçš„é‡ç‚¹æ˜¯æŒ‡å®šå’ŒéªŒè¯å®žçŽ°LibraåŒºå—é“¾æ ¸å¿ƒåŠŸèƒ½çš„æ¨¡å— æˆ‘ä»¬çš„é•¿æœŸç›®æ ‡æ˜¯ä¿ƒè¿›ä¸€ç§æ­£ç¡®æ€§æ–‡åŒ–ï¼Œåœ¨è¿™ç§æ–‡åŒ–ä¸­ï¼Œç”¨æˆ·å°†é€šè¿‡æ¨¡å—çš„æ­£å¼è§„èŒƒæ¥äº†è§£å…¶åŠŸèƒ½ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæ²¡æœ‰ä¸€ä¸ªMoveç¨‹åºå‘˜æ„¿æ„ä¸Žæ¨¡å—äº¤äº’ï¼Œé™¤éžå®ƒæœ‰ä¸€ä¸ªå…¨é¢çš„æ­£å¼è§„èŒƒï¼Œå¹¶ä¸”ç»è¿‡éªŒè¯ç¬¦åˆè¯¥è§„èŒƒã€‚ç„¶è€Œï¼Œå®žçŽ°è¿™ä¸€ç›®æ ‡å°†é¢ä¸´è‹¥å¹²æŠ€æœ¯å’Œç¤¾ä¼šæŒ‘æˆ˜ã€‚éªŒè¯å·¥å…·åº”è¯¥æ˜¯ç²¾ç¡®å’Œç›´è§‚çš„ã€‚è§„èŒƒå¿…é¡»æ˜¯æ¨¡å—åŒ–å’Œå¯é‡ç”¨çš„ï¼Œä½†æ˜¯å¯è¯»æ€§è¶³å¤Ÿå¼ºï¼Œå¯ä»¥ä½œä¸ºæ¨¡å—è¡Œä¸ºçš„æœ‰ç”¨æ–‡æ¡£ã€‚ æ”¯æŒç¬¬ä¸‰æ–¹ç§»åŠ¨æ¨¡å—ï¼š æˆ‘ä»¬å°†å¼€å‘ä¸€æ¡ç¬¬ä¸‰æ–¹æ¨¡å—å‘å¸ƒçš„è·¯å¾„ã€‚ä¸ºLibraç”¨æˆ·å’Œç¬¬ä¸‰æ–¹å¼€å‘äººå‘˜åˆ›é€ è‰¯å¥½çš„ä½“éªŒæ˜¯ä¸€ä¸ªé‡å¤§çš„æŒ‘æˆ˜ã€‚é¦–å…ˆï¼Œå‘ä¸€èˆ¬åº”ç”¨ç¨‹åºæ•žå¼€å¤§é—¨ä¸€å®šä¸èƒ½å½±å“ç³»ç»Ÿå¯¹æ ¸å¿ƒæ”¯ä»˜åœºæ™¯å’Œç›¸å…³é‡‘èžåº”ç”¨ç¨‹åºçš„å¯ç”¨æ€§ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬å¸Œæœ›é¿å…æ¬ºè¯ˆã€æŠ•æœºå’Œæ¼æ´žç™¾å‡ºçš„è½¯ä»¶å¸¦æ¥çš„å£°èª‰é£Žé™©ã€‚åœ¨é¼“åŠ±é«˜è´¨é‡è½¯ä»¶çš„åŒæ—¶å»ºç«‹ä¸€ä¸ªå¼€æ”¾çš„ç³»ç»Ÿæ˜¯ä¸€ä¸ªéš¾é¢˜ã€‚ä¸ºé«˜å¯ä¿¡æ¨¡å—åˆ›å»ºä¸€ä¸ªå¸‚åœºï¼Œå¹¶ä¸ºéªŒè¯ç§»åŠ¨ä»£ç æä¾›æœ‰æ•ˆçš„å·¥å…·ç­‰æ­¥éª¤å°†ä¼šæœ‰æ‰€å¸®åŠ©ã€‚ é™„å½•A Move è¯­è¨€å‚è€ƒ []]></content>
      <categories>
        <category>libra</category>
        <category>moveè¯­è¨€</category>
      </categories>
      <tags>
        <tag>libra</tag>
        <tag>moveè¯­è¨€</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pbftå…±è¯†ç®—æ³•é—®é¢˜ç­”æ¡ˆ]]></title>
    <url>%2F2019%2F07%2F10%2Fconsensus-pbft-QA%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦æ˜¯é’ˆå¯¹ä¸Šä¸€ç¯‡æå‡ºçš„è¿›è¡Œä¸€ä¸ªè¯¦ç»†çš„è§£ç­” pfbtå…±è¯†ä¸ºä»€ä¹ˆè‡³å°‘éœ€è¦3f+ 1ä¸ªèŠ‚ç‚¹ï¼Ÿæœ€åçš„æƒ…å†µï¼Œç³»ç»Ÿæ‹œå åº­èŠ‚ç‚¹ä¸ºfä¸ªï¼Œç”±äºŽæ¶ˆæ¯åˆ°è¾¾é¡ºåºçš„é—®é¢˜ï¼Œæœ‰å¯èƒ½fä¸ªæœ‰é—®é¢˜çš„èŠ‚ç‚¹å…ˆæ¯”fä¸ªæ­£å¸¸çš„èŠ‚ç‚¹å…ˆè¿”å›žæ¶ˆæ¯ï¼Œæ­¤æ—¶åˆè¦ä¿è¯æ­£ç¡®çš„æ¶ˆæ¯æ¯”æœ‰é—®é¢˜çš„æ¶ˆæ¯å¤šï¼Œæ‰€ä»¥è‡³å°‘3f+ 1ä¸ªèŠ‚ç‚¹ N - f- f > f => N > 3fpbftå…±è¯† parpareå’Œcommit é˜¶æ®µä¸ºä»€ä¹ˆæ”¶åˆ°éœ€è¦2f+ 1ä¸ªç›¸åŒçš„å›žå¤ï¼ˆåŒ…æ‹¬è‡ªå·±çš„ï¼‰ï¼Œf + 1ä¸ªä¸è¡Œå—ï¼ŸæŸå‰¯æœ¬æ”¶åˆ°äº†f+ 1ç›¸åŒçš„æ¶ˆæ¯åé¦ˆ,å¦‚æžœè¿™ä¸ªf+ 1ä¸ªåé¦ˆä¸­åŒ…å«faulty èŠ‚ç‚¹ï¼Œæ­¤æ—¶æ¶ˆæ¯æ˜¯ä¸èƒ½ä½œæ•°çš„ï¼Œå› ä¸ºfaultyå¯èƒ½ä¼šå‘é€é”™è¯¯æ¶ˆæ¯ç»™ä¸åŒçš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥éœ€è¦å¿…é¡»è¦2f+1ä¸ªç›¸åŒçš„åé¦ˆç¡®è®¤æ‰èƒ½ä¿è¯f+1ä¸ªnon-faultyèŠ‚ç‚¹æ­£å¸¸ï¼Œè¿™æ—¶å€™å³ä¾¿fä¸ªfaultyèŠ‚ç‚¹ç»™ä¸åŒäººå‘ä¸åŒæ¶ˆæ¯ä¹Ÿæ²¡å…³ç³»ï¼Œf+1ä¸ªnon-faultyèŠ‚ç‚¹å·²ç»å½¢æˆäº†ç»Ÿä¸€æˆ˜çº¿ï¼Œä»–ä»¬åœ¨äººæ•°ä¸Šå·²ç»å¤šäºŽé‚£äº›å¢™å¤´è‰äº†ï¼Œå¯ä»¥è¾¾æˆä¸€è‡´äº†ã€‚ pbft å…±è¯† å®¢æˆ·ç«¯ä¸ºä»€ä¹ˆéœ€è¦f + 1ä¸ªèŠ‚ç‚¹çš„ç›¸åŒå›žå¤ï¼Œfä¸ªä¸è¡Œå—ï¼Ÿå‡è®¾åªéœ€è¦ä»Žfä¸ªä¸åŒçš„èŠ‚ç‚¹é‚£é‡Œæ‹¿åˆ°ç›¸åŒçš„replyï¼Œä½†æˆ‘ä»¬ä¸å¾—ä¸è€ƒè™‘ä¸€ç§æƒ…å†µï¼Œå³è¿™fä¸ªç›¸åŒçš„replyå…¨æ˜¯æ¥è‡ªfä¸ªfaultyèŠ‚ç‚¹ã€ç³»ç»Ÿä¸­è‡³å¤šæœ‰fä¸ªfaultyèŠ‚ç‚¹ã€‘ã€‚å¦‚æžœçœŸæ˜¯è¿™æ ·çš„è¯ï¼Œå¾ˆæœ‰å¯èƒ½å®¢æˆ·ç«¯å°±å¾—åˆ°é”™è¯¯çš„ç»“æžœã€‚å› æ­¤ä¸ºäº†è¿›ä¸€æ­¥å¢žå¼ºreplyçš„å¯ä¿¡åº¦ï¼Œæˆ‘ä»¬éœ€è¦æ¥è‡ªä¸åŒèŠ‚ç‚¹çš„æ€»è®¡(f+1)ä¸ªç›¸åŒreplyã€‚å¤šå‡ºçš„é‚£ä¸€ä¸ªå¯ä»¥ä½œä¸ºå¯¹æ¯”ï¼ pbftå…±è¯† ä¸ºä»€ä¹ˆéœ€è¦ä¸‰é˜¶æ®µï¼ŸåŽ»é™¤æŽ‰commité˜¶æ®µå¯ä»¥å—ï¼Ÿå‡è®¾æˆ‘ä»¬åŽ»æŽ‰commitï¼Œæ‰€æœ‰èŠ‚ç‚¹æ”¶åˆ°2f+1(åŒ…æ‹¬è‡ªå·±)çš„prepareä¹‹åŽå°±æ‰§è¡Œæ“ä½œï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å…¶å®žå¦‚æžœé¡ºåˆ©çš„è¯ï¼Œå³ä½¿æœ‰fä¸ªä½œæ¶èŠ‚ç‚¹ï¼Œä¾ç„¶æœ‰f+1ä¸ªæ­£å¸¸èŠ‚ç‚¹æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šæ”¶åˆ°æ­£ç¡®çš„ç»“æžœï¼Œæœ€åŽæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½èƒ½é¡ºåˆ©çš„è¾¾æˆä¸€è‡´çš„ç»“è®ºã€‚è¿™æ ·çœ‹æ¥ä¼¼ä¹Žæˆ‘ä»¬å®Œå…¨ä¸éœ€è¦commitå—ï¼Ÿ ä½†æ˜¯å¦‚æžœä¸»èŠ‚ç‚¹å´©æºƒå‘ç”Ÿæ¢ä¸»ï¼Œå…¶ä¸­åªæœ‰ä¸€ä¸ªæˆ–å‡ ä¸ªï¼ˆä¸æ˜¯å¤§å¤šæ•°ï¼‰å·²ç»æ”¶åˆ°äº†è¶³å¤Ÿçš„prepareï¼Œå…¶ä»–èŠ‚ç‚¹å› ä¸ºç½‘ç»œåŽŸå› æ²¡æœ‰æ”¶åˆ°æœ¬åº”è¯¥æ”¶åˆ°çš„è¶³å¤Ÿå¤šçš„prepareï¼ˆå¼‚æ­¥ç½‘ç»œçŽ¯å¢ƒæ²¡æœ‰ä»»ä½•é€šä¿¡ä¿è¯ï¼Œåªæœ‰æœ€ç»ˆä¸€å®šä¼šæ”¶åˆ°çš„ä¿è¯ï¼‰ï¼Œé‚£ä¹ˆé‚£ä¸ªæ‰§è¡Œäº†æ“ä½œçš„èŠ‚ç‚¹å°±æ‚²å‰§äº†ï¼Œè¿™ä¸ªæ—¶å€™æ–°ä¸»å‘èµ·æ–°ä¸€è½®å…±è¯†ï¼Œsequenceè·Ÿå·²ç»æ‰§è¡Œçš„æ“ä½œä¸€è‡´ï¼Œé‚£ä¸ªèŠ‚ç‚¹åˆ°åº•æ‰§è¡Œå¥½è¿˜æ˜¯ä¸æ‰§è¡ŒåŒæ ·sequenceçš„æ“ä½œï¼Ÿ é‚£ä¹ˆcommitæ˜¯æ€Žä¹ˆåšåˆ°çš„å‘¢ï¼Ÿå‡è®¾èŠ‚ç‚¹æ”¶åˆ°è¶³å¤Ÿå¤šçš„prepareè¿›å…¥commité˜¶æ®µï¼Œè¿™ä¸ªæ—¶å€™å‘ç”Ÿäº†ä¸€æ ·çš„æ¢ä¸»æƒ…å½¢ï¼Œç”±äºŽèŠ‚ç‚¹è¿˜æ²¡æ‰§è¡Œï¼Œç»§ç»­æŒ‰ç…§æ–°ä¸€è½®çš„æµç¨‹èµ°å³å¯ï¼Œè¿™ä¸ªæ—¶å€™sequenceä¸å˜ï¼Œä½†æ˜¯viewæ”¹å˜ã€‚ å¦‚æžœå·²ç»æ”¶åˆ°äº†è¶³å¤Ÿçš„commitï¼Œå¹¶ä¸”å·²ç»æ‰§è¡Œäº†æ“ä½œå‘¢ï¼Ÿä»¿ä½›é™·å…¥äº†prepareä¸€æ ·çš„åœ°æ­¥â€¦ä½†æ˜¯å®žé™…ä¸Šå› ä¸ºè¦äº§ç”Ÿcommitæ¶ˆæ¯ï¼Œè¯´æ˜Ž2f+1ä¸ªèŠ‚ç‚¹å·²ç»prepareäº†ï¼Œæ¢ä¸»çš„æ—¶å€™ä¸»ä¼šåŽ»æœé›†è¦é‡æ”¾çš„pre-prepareï¼ˆ2f+1ä¸ªèŠ‚ç‚¹çš„ï¼Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªè¯šå®žèŠ‚ç‚¹å¹¶ä¸”æœ‰å¯¹åº”çš„pre-prepareï¼‰,å› æ­¤ä¼šæŠŠåŒæ ·çš„digestå¯¹åº”çš„æ¶ˆæ¯viewæ”¹ä¸ºè‡ªå·±é‡å‘ä¸€æ¬¡ï¼Œå¹¶ä¸”æ³¨æ„åˆ°commitåªéœ€è¦è·Ÿå½“å‰çš„viewç›¸åŒå°±å¯ä»¥æŽ¥å—ï¼Œé‚£ä¹ˆå®žé™…ä¸Šcommitæ˜¯å¯¹viewä¸æ•æ„Ÿçš„ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œprepareé”å®šåŒä¸€ä¸ªviewä¸‹çš„sequenceï¼Œcommité”å®šsequenceã€‚ åœ¨ä¸€ä¸ªèŠ‚ç‚¹æ•°ä¸ºNçš„èŠ‚ç‚¹ä¸­ï¼Œè¯šå®žèŠ‚ç‚¹çš„æ•°é‡æ˜¯å¤šå°‘ä¸ªï¼Ÿ(non-faulty)=(2/3)*N+1 CAPå®šç†åœ¨pbftä¸­æ˜¯å¦‚ä½•å–èˆçš„ï¼ŸPBFTç®—æ³•å°†ä¸€è‡´æ€§ï¼ˆCï¼‰æ‘†åœ¨é¦–ä½ï¼Œå¯¹å¯ç”¨æ€§ï¼ˆAï¼‰ä½œäº†å¦¥åã€‚ä¸€æ—¦faultyèŠ‚ç‚¹çš„æ•°é‡è¶…è¿‡fï¼Œè¯¥ç³»ç»Ÿå°±ä¸èƒ½ç»§ç»­æ‰§è¡Œå®¢æˆ·ç«¯çš„è¯·æ±‚ã€ç³»ç»Ÿä¼šå¡ä½ï¼Œä¸èƒ½åšå†™æ“ä½œã€‘ã€‚æ­¤å¤–ï¼Œåˆ†åŒºå®¹å¿æ˜¯å¿…é¡»è¦ä¿è¯çš„ã€‚ è®¾ç½®waterlineçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿå‡è®¾ä¸»èŠ‚ç‚¹æ˜¯åçš„ï¼Œå®ƒåœ¨ç»™è¯·æ±‚ç¼–å·æ—¶æ•…æ„é€‰æ‹©äº†ä¸€ä¸ªå¾ˆå¤§çš„ç¼–å·ï¼Œä»¥è‡³äºŽè¶…å‡ºäº†åºå·çš„èŒƒå›´ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªä½Žæ°´ä½ï¼ˆlow water markï¼‰hå’Œé«˜æ°´ä½ï¼ˆhigh water markï¼‰Hï¼Œè®©ä¸»èŠ‚ç‚¹åˆ†é…çš„ç¼–å·åœ¨hå’ŒHä¹‹é—´ï¼Œä¸èƒ½è‚†æ„åˆ†é… PAREPARE å’Œcommité˜¶æ®µä¸ºä»€ä¹ˆéœ€è¦ä¿å­˜æ¶ˆæ¯åœ¨æœ¬åœ°æˆ–è€…å†…å­˜ï¼ŸPRE-PREPAREä¸ºä»€ä¹ˆä¸éœ€è¦ï¼Ÿä¿å­˜æ¶ˆæ¯çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿viewChangeçš„æ—¶å€™èƒ½å¤Ÿæ¢å¤æ¶ˆæ¯ï¼Œé‡æ–°åœ¨æ–°çš„viewä¸Šè¾¾æˆå…±è¯†ã€‚PRE-PREPAREé˜¶æ®µå„èŠ‚ç‚¹è¿˜æ²¡æœ‰å‘é€æ¶ˆæ¯ç»™å¯¹æ–¹ï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿å­˜ã€‚ pbfté€šä¿¡æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿå¦‚ä½•è®¡ç®—çš„ï¼Ÿå› ä¸ºéœ€è¦ä¸‰é˜¶æ®µå…±è¯†ï¼Œæ¯ä¸ªé˜¶æ®µå„ä¸ªèŠ‚ç‚¹ä¹‹é—´éƒ½éœ€è¦é€šä¿¡ï¼Œæ‰€ä»¥é€šä¿¡é‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚ å‡è®¾ç³»ç»Ÿä¸­å­˜åœ¨2ä¸ªæ‹œå åº­èŠ‚ç‚¹ï¼Œæ­¤æ—¶åº”è¯¥æœ€å°‘éœ€è¦7ä¸ªèŠ‚ç‚¹ï¼Œä¸‹å›¾å±•ç¤ºäº†7ä¸ªèŠ‚ç‚¹é€šä¿¡çš„è¿‡ç¨‹ è¯·æ±‚æ¶ˆæ¯æ€»é‡ä¸ºï¼š 1 + 3f + 3f(3f-f) + (3f-f+1)(3f+1) + 3f-1 åœ¨ä¸Šè¿°ä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€ä¸ªç®€å•è®¡ç®— 12345request messages: 1pre-prepare messages: 3f = 6prepare messages: 3f(3f-f) = 24commit messages: (3f-f+1)(3f+1)= 35reply messages: 3f-1 = 5 å¯ä»¥çœ‹å‡ºå½“æœ‰7å„èŠ‚ç‚¹æ—¶ï¼Œpbftéœ€è¦çš„æ¶ˆæ¯é€šä¿¡æ€»é‡ç«Ÿç„¶è¾¾åˆ°äº†71æ¬¡ï¼Œè¿™è¿˜æ˜¯åªæœ‰ä¸€æ¬¡è¯·æ±‚çš„æƒ…å†µä¸‹ï¼Œå¦‚æžœå‰¯æœ¬æ›´å¤šï¼Œæ¶ˆæ¯å°†ä¼šå˜å¾—æ›´å¤šã€‚ å¦‚æžœåœ¨commité˜¶æ®µview changeï¼Œä¼šå¯¼è‡´è¾¾æˆä¸äº†å…±è¯†å—ï¼Ÿä¼šå¯¼è‡´ä¹‹å‰çš„viewä¸‹çš„è¯·æ±‚ç¼–å·ä¸¢å¤±å—ï¼Ÿå¦‚æžœcommité˜¶æ®µviewchangeï¼Œä¼šä¿ç•™ä¹‹å‰commité˜¶æ®µçš„è¯·æ±‚ï¼Œä¸ä¼šè¾¾æˆä¸äº†å…±è¯†ï¼Œä¹Ÿä¸ä¼šä¸¢å¤±è¯·æ±‚ç¼–å· prepareé˜¶æ®µå’Œcommité˜¶æ®µç”¨æ¥ç¡®ä¿é‚£äº›å·²ç»è¾¾åˆ°commitçŠ¶æ€çš„è¯·æ±‚å³ä½¿åœ¨å‘ç”ŸviewchangeåŽåœ¨æ–°çš„viewé‡Œä¾ç„¶ä¿æŒåŽŸæœ‰çš„åºåˆ—ä¸å˜ï¼Œæ¯”å¦‚ä¸€å¼€å§‹åœ¨view 0ä¸­ï¼Œå…±æœ‰req 0ï¼Œ req 1ï¼Œ req2ä¸‰ä¸ªè¯·æ±‚ä¾æ¬¡è¿›å…¥äº†commité˜¶æ®µï¼Œå‡è®¾æ²¡æœ‰åèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™å››ä¸ªreplicaså³å°†è¦ä¾æ¬¡æ‰§è¡Œè€…ä¸‰æ¡è¯·æ±‚å¹¶è¿”å›žç»™Clientã€‚ä½†è¿™æ—¶ä¸»èŠ‚ç‚¹é—®é¢˜å¯¼è‡´view changeçš„å‘ç”Ÿï¼Œview 0 å˜æˆ view 1ï¼Œåœ¨æ–°çš„viewé‡Œï¼ŒåŽŸæœ¬çš„req 0ï¼Œ req1ï¼Œ req2ä¸‰æ¡è¯·æ±‚çš„åºåˆ—è¢«ä¿ç•™ï¼Œä½œæ•°ã€‚é‚£äº›å¤„äºŽpre-prepareå’Œprepareé˜¶æ®µçš„è¯·æ±‚åœ¨view changeå‘ç”ŸåŽï¼Œåœ¨æ–°çš„viewé‡Œéƒ½å°†è¢«é—å¼ƒï¼Œä¸ä½œæ•°ã€‚ ç®€å•æ¥è¯´å°±æ˜¯ å¦‚æžœæ¯ä¸ªèŠ‚ç‚¹éƒ½è¿›å…¥äº†commité˜¶æ®µï¼ˆè¿™é‡Œè¦å¼ºè°ƒçš„æ˜¯æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿›å…¥è¿™ä¸ªcommité˜¶æ®µæ‰ç®—æ˜¯æ•´ä½“è¿›å…¥äº†commité˜¶æ®µï¼‰ï¼Œè¿™æ—¶å³ä½¿view changeï¼Œä¹Ÿä¼šä¿ç•™ä¹‹å‰çš„viewé‡Œè¿›å…¥commité˜¶æ®µçš„è¯·æ±‚ä¿¡æ¯ï¼Œview changeä¼šç»§ç»­ä¹‹å‰çš„commité˜¶æ®µè¯·æ±‚ï¼Œä¸ä¼šå†é‡æ–°è¿›å…¥pre-prepareå’Œprepareé˜¶æ®µã€‚]]></content>
      <categories>
        <category>å…±è¯†ç®—æ³•</category>
      </categories>
      <tags>
        <tag>pbft</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pbftå…±è¯†ç®—æ³•]]></title>
    <url>%2F2019%2F07%2F09%2Fconsensus-pbft%2F</url>
    <content type="text"><![CDATA[PBFT æ˜¯ parctical Byzantine Fault Toleranceï¼ˆå®žç”¨æ‹œå åº­å®¹é”™ç®—æ³•ï¼‰çš„ç¼©å†™ï¼Œå®ƒæ˜¯ç”±BFTç®—æ³•æ¼”åŒ–å‡ºæ¥çš„ï¼Œ æ‰€æœ‰çš„BFTç®—æ³•éƒ½ä¸ºäº†è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯åœ¨ä¸€ä¸ªä¸å¯ä¿¡çš„ç½‘ç»œé‡Œï¼Œå„ä¸ªèŠ‚ç‚¹å¦‚ä½•è¾¾æˆå…±è¯†ã€‚è¿™ç±»é—®é¢˜è¢«ç§°ä¸ºæ‹œå åº­å°†å†›é—®é¢˜ã€‚ä»€ä¹ˆæ˜¯æ‹œå åº­å°†å†›é—®é¢˜å‘¢ï¼Ÿæ‹œå åº­ä½äºŽå¦‚ä»Šçš„åœŸè€³å…¶çš„ä¼Šæ–¯å¦å¸ƒå°”ï¼Œæ˜¯å¤ä»£ä¸œç½—é©¬å¸å›½çš„é¦–éƒ½ã€‚æ‹œå åº­ç½—é©¬å¸å›½å›½åœŸè¾½é˜”ï¼Œä¸ºäº†è¾¾åˆ°é˜²å¾¡ç›®çš„ï¼Œæ¯å—å°åœ°éƒ½é©»æ‰Žä¸€æ”¯ç”±å°†å†›ç»Ÿé¢†çš„å†›é˜Ÿï¼Œæ¯ä¸ªå†›é˜Ÿéƒ½åˆ†éš”å¾ˆè¿œï¼Œå°†å†›ä¸Žå°†å†›ä¹‹é—´åªèƒ½é ä¿¡å·®ä¼ é€’æ¶ˆæ¯ã€‚ åœ¨æˆ˜äº‰çš„æ—¶å€™ï¼Œæ‹œå åº­å†›é˜Ÿå†…æ‰€æœ‰å°†å†›å¿…éœ€è¾¾æˆä¸€è‡´çš„å…±è¯†ï¼Œå†³å®šæ˜¯å¦æœ‰èµ¢çš„æœºä¼šæ‰åŽ»æ”»æ‰“æ•Œäººçš„é˜µè¥ã€‚ä½†æ˜¯ï¼Œåœ¨å†›é˜Ÿå†…æœ‰å¯èƒ½å­˜æœ‰å›å¾’å’Œæ•Œå†›çš„é—´è°ï¼Œå·¦å³å°†å†›ä»¬çš„å†³å®šå½±å“å°†å†›ä»¬è¾¾æˆä¸€è‡´å…±è¯†ã€‚åœ¨å·²çŸ¥æœ‰å°†å†›æ˜¯å›å¾’çš„æƒ…å†µä¸‹ï¼Œå…¶ä½™å¿ è¯šçš„å°†å†›å¦‚ä½•è¾¾æˆä¸€è‡´åè®®çš„é—®é¢˜ï¼Œè¿™å°±æ˜¯æ‹œå åº­å°†å†›é—®é¢˜ã€‚ æ¯”ç‰¹å¸å’Œä»¥å¤ªåŠä»£è¡¨çš„POSï¼ŒEOSä»£è¡¨çš„DPOSï¼Œè¿™äº›éƒ½æ˜¯å…¬é“¾çš„ç®—æ³•ï¼Œé€‚ç”¨äºŽä¼—å¤šèŠ‚ç‚¹çš„æƒ…å†µï¼Œé€šè¿‡ç‰ºç‰²CAPç†è®ºé‡Œé¢çš„ ä¸€è‡´æ€§æ¥è¾¾åˆ°å¯ç”¨æ€§ã€‚PBFT æœ¬èº«ç®—æ³•çš„å¤æ‚åº¦ä¸ºOï¼ˆn^2ï¼‰ä»–ç‰ºç‰²äº†å¯ç”¨æ€§æ¥è¾¾åˆ°ä¸€è‡´æ€§ï¼Œé€‚ç”¨äºŽè”ç›Ÿé“¾èŠ‚ç‚¹å°‘çš„æƒ…å†µã€‚ ä¸‹é¢å›¾ç‰‡å±•ç¤ºäº†ä¸»æµçš„å…±è¯†ç®—æ³• å®žç”¨æ‹œå åº­å®¹é”™ç³»ç»Ÿï¼ˆPBFTï¼‰é™ä½Žäº†æ‹œå åº­åè®®çš„è¿è¡Œå¤æ‚åº¦ï¼Œä»ŽæŒ‡æ•°çº§åˆ«é™ä½Žåˆ°å¤šé¡¹å¼çº§åˆ«ï¼ˆPolynomialï¼‰ï¼Œä½¿æ‹œå åº­åè®®åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åº”ç”¨æˆä¸ºå¯èƒ½ã€‚ â€‹ PBFTæ˜¯ä¸€ç§çŠ¶æ€æœºå‰¯æœ¬å¤åˆ¶ç®—æ³•ï¼Œå³æœåŠ¡ä½œä¸ºçŠ¶æ€æœºè¿›è¡Œå»ºæ¨¡ï¼ŒçŠ¶æ€æœºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸åŒèŠ‚ç‚¹è¿›è¡Œå‰¯æœ¬å¤åˆ¶ã€‚æ¯ä¸ªçŠ¶æ€æœºçš„å‰¯æœ¬éƒ½ä¿å­˜äº†æœåŠ¡çš„çŠ¶æ€ï¼ŒåŒæ—¶ä¹Ÿå®žçŽ°äº†æœåŠ¡çš„æ“ä½œã€‚å°†æ‰€æœ‰çš„å‰¯æœ¬ç»„æˆçš„é›†åˆä½¿ç”¨å¤§å†™å­—æ¯Rè¡¨ç¤ºï¼Œä½¿ç”¨0åˆ°|R|-1çš„æ•´æ•°è¡¨ç¤ºæ¯ä¸€ä¸ªå‰¯æœ¬ã€‚ä¸ºäº†æè¿°æ–¹ä¾¿ï¼Œé€šå¸¸å‡è®¾æ•…éšœèŠ‚ç‚¹æ•°ä¸ºfä¸ªï¼Œæ•´ä¸ªæœåŠ¡èŠ‚ç‚¹æ•°ä¸º|R|=3f+1ä¸ªï¼Œè¿™é‡Œmæ˜¯æœ‰å¯èƒ½å¤±æ•ˆçš„å‰¯æœ¬çš„æœ€å¤§ä¸ªæ•°ã€‚å°½ç®¡å¯ä»¥å­˜åœ¨å¤šäºŽ3f+1ä¸ªå‰¯æœ¬ï¼Œä½†æ˜¯é¢å¤–çš„å‰¯æœ¬é™¤äº†é™ä½Žæ€§èƒ½ä¹‹å¤–ä¸èƒ½æé«˜å¯é æ€§ã€‚ PBFTè¦æ±‚å…±åŒç»´æŠ¤ä¸€ä¸ªçŠ¶æ€ï¼Œæ‰€æœ‰èŠ‚ç‚¹é‡‡å–çš„è¡ŒåŠ¨ä¸€è‡´ã€‚ä¸ºæ­¤ï¼Œéœ€è¦è¿è¡Œä¸‰ç±»åŸºæœ¬åè®®ï¼ŒåŒ…æ‹¬ä¸€è‡´æ€§åè®®ã€æ£€æŸ¥ç‚¹ï¼ˆcheckPointï¼‰åè®®å’Œè§†å›¾æ›´æ¢(viewChange)åè®®ã€‚æˆ‘ä»¬ä¸»è¦å…³æ³¨æ”¯æŒç³»ç»Ÿæ—¥å¸¸è¿è¡Œçš„ä¸€è‡´æ€§åè®®ã€‚ä¸€è‡´æ€§åè®®è‡³å°‘åŒ…å«è‹¥å¹²ä¸ªé˜¶æ®µï¼šè¯·æ±‚ï¼ˆrequestï¼‰ã€åºå·åˆ†é…ï¼ˆpre-prepareï¼‰å’Œå“åº”ï¼ˆreplyï¼‰ã€‚æ ¹æ®åè®®è®¾è®¡çš„ä¸åŒï¼Œå¯èƒ½åŒ…å«ç›¸äº’äº¤äº’ï¼ˆprepareï¼‰ï¼Œåºå·ç¡®è®¤ï¼ˆcommitï¼‰ç­‰é˜¶æ®µã€‚ ä¸Šå›¾æ˜¾ç¤ºäº†ä¸€ä¸ªç®€åŒ–çš„PBFTçš„åè®®é€šä¿¡æ¨¡å¼ï¼Œå…¶ä¸­C ä¸ºå®¢æˆ·ç«¯ï¼Œ N0 ~N3 ä¸ºå…±è¯†èŠ‚ç‚¹ã€‚ å…¶ä¸­N0 ä¸ºä¸»èŠ‚ç‚¹ï¼ŒN3 ä¸ºæ•…éšœèŠ‚ç‚¹ã€‚æ•´ä¸ªåè®®åŸºæœ¬è¿‡ç¨‹å¦‚ä¸‹ (ä¸€)ã€å®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚ï¼Œæ¿€æ´»ä¸»èŠ‚ç‚¹çš„æœåŠ¡æ“ä½œã€‚ (äºŒ)ã€ä¸»èŠ‚ç‚¹æŽ¥æ”¶åˆ°è¯·æ±‚ï¼Œé‡‡ç”¨ä¸‰é˜¶æ®µåè®®ä»¥å‘ä»ŽèŠ‚ç‚¹å¹¿æ’­è¯·æ±‚ã€‚ åºå·åˆ†é…é˜¶æ®µï¼Œä¸»èŠ‚ç‚¹ç»™æ¯ä¸ªè¯·æ±‚åˆ†é…ä¸€ä¸ªåºå·Nï¼Œå¹¿æ’­åºå·åˆ†é…æ¶ˆæ¯å’Œå®¢æˆ·ç«¯çš„è¯·æ±‚æ¶ˆæ¯m,å¹¶å°†æž„é€ PRE-PREPARE æ¶ˆæ¯ç»™å„ä¸ªä»ŽèŠ‚ç‚¹ã€‚ äº¤äº’é˜¶æ®µ ä»ŽèŠ‚ç‚¹æ”¶åˆ°PRE-PREPAREæ¶ˆæ¯ï¼Œå‘å…¶ä»–èŠ‚ç‚¹å¹¿æ’­PARPAREæ¶ˆæ¯ã€‚ åºå·ç¡®è®¤é˜¶æ®µï¼Œå„èŠ‚ç‚¹å¯¹å½“å‰è§†å›¾ï¼ˆviewï¼‰çš„è¯·æ±‚å’Œæ¬¡åºéªŒè¯åŽï¼Œå¹¿æ’­Commitæ¶ˆæ¯ï¼Œæ‰§è¡Œæ”¶åˆ°çš„å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œç„¶åŽå°†ç»“æžœå“åº”ç»™å®¢æˆ·ç«¯ã€‚ (ä¸‰) ã€å®¢æˆ·ç«¯ç­‰åˆ°f+1çš„ç›¸åŒçš„å“åº”ç»“æžœï¼Œåˆ™è®¤ä¸ºæ­¤æ¬¡è¯·æ±‚æˆåŠŸå®Œæˆã€‚ åœ¨è¿™ä¸ªæœºåˆ¶ä¸‹æœ‰ä¸€ä¸ªè§†å›¾ï¼ˆviewï¼‰çš„æ¦‚å¿µï¼Œç±»ä¼¼raftçš„termçš„æ¦‚å¿µã€‚åœ¨å½“æœŸviewé‡Œé¢ï¼Œæœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œå…¶ä»–éƒ½æ˜¯å¤‡ä»½èŠ‚ç‚¹ã€‚ä¸»èŠ‚ç‚¹å°†å®¢æˆ·ç«¯çš„è¯·æ±‚ç¼–å·å¹¶æŽ’åºï¼Œç„¶åŽå‘é€ç»™å‰¯æœ¬èŠ‚ç‚¹ã€‚ä½†æ˜¯æ­¤æ—¶ä¸»èŠ‚ç‚¹æœ‰å¯èƒ½æ˜¯æ‹œå åº­çš„ï¼Œå®ƒæœ‰å¯èƒ½ç»™æ¶ˆæ¯ç¼–ä¸Šç›¸åŒçš„åºå·ï¼Œæˆ–è€…ä¸åŽ»ç»™æ¶ˆæ¯åˆ†é…åºå·ï¼Œæˆ–è€…è®©åˆ†é…çš„åºå·ä¸è¿žç»­ã€‚å¤‡ä»½èŠ‚ç‚¹æœ‰èŒè´£åŽ»æ£€æŸ¥è¿™æ¬¡åºå·ï¼Œå¹¶æ ¹æ®timeoutæœºåˆ¶åˆ¤æ–­ä¸»èŠ‚ç‚¹æ˜¯å¦å­˜æ´»ã€‚å½“å‡ºçŽ°è¿™äº›å¼‚å¸¸æƒ…å†µçš„æ—¶å€™ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šè§¦å‘viewChangeåè®®æ¥æ›´æ¢ä¸»èŠ‚ç‚¹ï¼Œå…³äºŽviewChangeåè®®æˆ‘ä»¬åŽé¢ä¼šè®²åˆ°ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†çš„åˆ†æžå„ä¸ªé˜¶æ®µã€‚ è§†å›¾æ˜¯è¿žç»­çš„æ•´æ•°ç¼–å·ã€‚ä¸»èŠ‚ç‚¹ç”±å…¬å¼å¾—å‡º \mathrm{p}=\mathrm{v} \bmod |\mathrm{N}|è¿™é‡Œv æ˜¯è§†å›¾ç¼–å·ï¼Œpæ˜¯å‰¯æœ¬ç¼–å·ï¼Œ |N| æ˜¯å‰¯æœ¬é›†åˆçš„ä¸ªæ•°ï¼Œå½“ä¸»èŠ‚ç‚¹å¤±æ•ˆå°±ä¼šè§¦å‘viewChangeè¿‡ç¨‹ã€‚ è¯·æ±‚é˜¶æ®µï¼ˆREQUESTï¼‰å®¢æˆ·ç«¯å‘ä¸»èŠ‚ç‚¹å‘é€ è¯·æ±‚, oä¸ºè¯·æ±‚çš„å…·ä½“çš„æ“ä½œï¼Œt ä¸ºè¯·æ±‚æ—¶å®¢æˆ·ç«¯è¿½åŠ çš„æ—¶é—´æˆ³ï¼Œcä¸ºå®¢æˆ·ç«¯æ ‡è¯†ã€‚ é¢„å‡†å¤‡é˜¶æ®µï¼ˆPRE-PREPAREï¼‰ä¸»èŠ‚ç‚¹æŽ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åŽéœ€è¦è¿›è¡Œä»¥ä¸‹æ ¡éªŒ å®¢æˆ·ç«¯è¯·æ±‚æ¶ˆæ¯ç­¾åæ˜¯å¦åˆæ³•ï¼Œå¦‚æžœåˆæ³•ï¼Œåˆ™åˆ†é…ä¸€ä¸ªåºå·nç»™è¯¥è¯·æ±‚ï¼Œç„¶åŽå‘æ‰€æœ‰çš„å‰¯æœ¬èŠ‚ç‚¹å‘é€é¢„å‡†å¤‡æ¶ˆæ¯ï¼Œé¢„å‡†å¤‡æ¶ˆæ¯çš„æ ¼å¼ä¸º&lt;, m&gt;ï¼Œè¿™é‡Œvæ˜¯å½“å‰è§†å›¾ç¼–å·ï¼Œnä¸ºæ¶ˆæ¯åºå·ï¼Œè¿™ä¸ªæ¶ˆæ¯åºå·å¿…é¡»åœ¨[h, H] ä¹‹é—´ï¼Œå…·ä½“åŽŸå› åŽé¢åˆ†æžï¼Œ dä¸ºè¯·æ±‚æ¶ˆæ¯çš„æ‘˜è¦ã€‚mæ˜¯å…·ä½“çš„æ¶ˆæ¯ã€‚ è¯·æ±‚æœ¬èº«æ˜¯ä¸åŒ…å«åœ¨é¢„å‡†å¤‡æ¶ˆæ¯ä½“é‡Œé¢çš„ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿é¢„å‡†å¤‡æ¶ˆæ¯è¶³å¤Ÿå°ï¼Œå› ä¸ºé¢„å‡†å¤‡æ¶ˆæ¯å°±æ˜¯ä¸ºäº†ä½œä¸ºä¸€ä¸ªè¯æ˜Žï¼Œè¯æ˜Žåœ¨è¿™ä¸ªviewé‡Œé¢ è¯·æ±‚çš„çš„åºå·è¢«èµ‹å€¼ä¸ºnï¼Œä»Žè€Œå¯ä»¥åœ¨viewChangeè¿‡ç¨‹ä¸­å¯ä»¥è¿›è¡Œè¿½ç´¢å¦å¤–ä¸€ä¸ªå±‚é¢ï¼Œå°†â€œè¯·æ±‚æŽ’åºåè®®â€å’Œâ€œè¯·æ±‚ä¼ è¾“åè®®â€è¿›è¡Œè§£è€¦ï¼Œæœ‰åˆ©äºŽå¯¹æ¶ˆæ¯ä¼ è¾“çš„æ•ˆçŽ‡è¿›è¡Œæ·±åº¦ä¼˜åŒ–ã€‚ å‡†å¤‡é˜¶æ®µï¼ˆPREPAREï¼‰å‰¯æœ¬èŠ‚ç‚¹iæ”¶åˆ°ä¸»èŠ‚ç‚¹çš„&lt;ï¼Œm&gt;æ¶ˆæ¯ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹æ ¡éªŒï¼š a. ä¸»èŠ‚ç‚¹PRE-PREPAREæ¶ˆæ¯ç­¾åæ˜¯å¦æ­£ç¡®ã€‚ b. å½“å‰å‰¯æœ¬èŠ‚ç‚¹æ˜¯å¦å·²ç»æ”¶åˆ°äº†ä¸€æ¡åœ¨åŒä¸€vä¸‹å¹¶ä¸”ç¼–å·ä¹Ÿæ˜¯nï¼Œä½†æ˜¯ç­¾åä¸åŒçš„PRE-PREPAREä¿¡æ¯ã€‚ c. dä¸Žmçš„æ‘˜è¦æ˜¯å¦ä¸€è‡´ã€‚ d. næ˜¯å¦åœ¨åŒºé—´[h, H]å†…ã€‚ å¦‚æžœæ£€éªŒé€šè¿‡, åœ¨å‡†å¤‡é˜¶æ®µçš„åŒæ—¶ï¼Œè¯¥èŠ‚ç‚¹å‘æ‰€æœ‰å‰¯æœ¬èŠ‚ç‚¹å‘é€å‡†å¤‡æ¶ˆæ¯,å¹¶ä¸”å°†é¢„å‡†å¤‡æ¶ˆæ¯å’Œå‡†å¤‡æ¶ˆæ¯å†™å…¥æœ¬åœ°log.ç”¨äºŽviewChangæ¢å¤æœªå®Œæˆçš„è¯·æ±‚ã€‚ Commité˜¶æ®µä¸»èŠ‚ç‚¹å’Œå‰¯æœ¬èŠ‚ç‚¹æ”¶åˆ°PREPAREæ¶ˆæ¯ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹æ ¡éªŒï¼š a. å‰¯æœ¬èŠ‚ç‚¹PARPAREæ¶ˆæ¯ç­¾åæ˜¯å¦æ­£ç¡®ã€‚ b. å½“å‰å‰¯æœ¬èŠ‚ç‚¹æ˜¯å¦å·²ç»æ”¶åˆ°åŒä¸€viewä¸‹çš„n c. næ˜¯å¦åœ¨åŒºé—´[h,H]é‡Œé¢ d.dæ˜¯å¦å’Œå½“å‰å·²æ”¶åˆ°PRE-PPREPAREä¸­çš„dç›¸åŒ éžæ³•è¯·æ±‚ä¸¢å¼ƒ,å¦‚æžœå‰¯æœ¬èŠ‚ç‚¹iæ”¶åˆ°äº†2f+1ä¸ªéªŒè¯é€šè¿‡çš„PREPAREæ¶ˆæ¯ï¼Œåˆ™å‘å…¶ä»–èŠ‚ç‚¹åŒ…æ‹¬ä¸»èŠ‚ç‚¹å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œv, n, d, iä¸Žä¸Šè¿°PREPAREæ¶ˆæ¯å†…å®¹ç›¸åŒã€‚è¿›è¡Œå‰¯æœ¬èŠ‚ç‚¹içš„ç­¾åã€‚è®°å½•COMMITæ¶ˆæ¯åˆ°æ—¥å¿—ä¸­ï¼Œç”¨äºŽView Changeè¿‡ç¨‹ä¸­æ¢å¤æœªå®Œæˆçš„è¯·æ±‚æ“ä½œã€‚è®°å½•å…¶ä»–å‰¯æœ¬èŠ‚ç‚¹å‘é€çš„PREPAREæ¶ˆæ¯åˆ°logä¸­ã€‚ REPLY é˜¶æ®µä¸»èŠ‚ç‚¹å’Œå‰¯æœ¬èŠ‚ç‚¹æ”¶åˆ°æ¶ˆæ¯ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹æ ¡éªŒï¼š a. å‰¯æœ¬èŠ‚ç‚¹COMMITæ¶ˆæ¯ç­¾åæ˜¯å¦æ­£ç¡®ã€‚ b. å½“å‰å‰¯æœ¬èŠ‚ç‚¹æ˜¯å¦å·²ç»æ”¶åˆ°äº†åŒä¸€è§†å›¾vä¸‹çš„nã€‚ c. dä¸Žmçš„æ‘˜è¦æ˜¯å¦ä¸€è‡´ã€‚ d. næ˜¯å¦åœ¨åŒºé—´[h, H]å†…ã€‚ éžæ³•è¯·æ±‚ä¸¢å¼ƒã€‚å¦‚æžœå‰¯æœ¬èŠ‚ç‚¹iæ”¶åˆ°äº†2f+1ä¸ªéªŒè¯é€šè¿‡çš„COMMITæ¶ˆæ¯ï¼Œè¯´æ˜Žå½“å‰ç½‘ç»œä¸­çš„å¤§éƒ¨åˆ†èŠ‚ç‚¹å·²ç»è¾¾æˆå…±è¯†ï¼Œè¿è¡Œå®¢æˆ·ç«¯çš„è¯·æ±‚æ“ä½œoï¼Œå¹¶è¿”å›žç»™å®¢æˆ·ç«¯ï¼Œrï¼šæ˜¯è¯·æ±‚æ“ä½œç»“æžœï¼Œå®¢æˆ·ç«¯å¦‚æžœæ”¶åˆ°f+1ä¸ªç›¸åŒçš„REPLYæ¶ˆæ¯ï¼Œè¯´æ˜Žå®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚å·²ç»è¾¾æˆå…¨ç½‘å…±è¯†ï¼Œå¦åˆ™å®¢æˆ·ç«¯éœ€è¦åˆ¤æ–­æ˜¯å¦é‡æ–°å‘é€è¯·æ±‚ç»™ä¸»èŠ‚ç‚¹ã€‚è®°å½•å…¶ä»–å‰¯æœ¬èŠ‚ç‚¹å‘é€çš„COMMITæ¶ˆæ¯åˆ°logä¸­ã€‚ï¼ˆè¡¥å……ï¼šéœ€è¦å°†é’ˆå¯¹æŸä¸ªè¯·æ±‚çš„æ‰€æœ‰æŽ¥å—çš„æ¶ˆæ¯å†™å…¥æ—¥å¿—ï¼Œè¿™ä¸ªæ—¥å¿—å¯ä»¥æ˜¯åœ¨å†…å­˜ä¸­çš„ï¼‰ã€‚ ä¸Šé¢ä»‹ç»PBFTçš„ä¸€è‡´æ€§åè®®çš„å„ä¸ªè¿‡ç¨‹ï¼Œè¿˜æœ‰ä¸¤ä¸ªä¸»è¦çš„è¿‡ç¨‹æŽ¥ä¸‹æ¥åˆ†åˆ«ä»‹ç» åžƒåœ¾å›žæ”¶åœ¨ä¸Šè¿°ç®—æ³•æµç¨‹ä¸­ï¼Œä¸ºäº†ç¡®ä¿åœ¨æ¯æ¬¡viewChangeä¸­èƒ½å¤Ÿæ¢å¤ä¹‹å‰çš„è¯·æ±‚ï¼Œæ¯ä¸ªå‰¯æœ¬èŠ‚ç‚¹ä¼šè®°å½•ä¸€äº›logåˆ°æœ¬åœ°ï¼Œå½“æ‰§è¡Œè¯·æ±‚åŽï¼Œå‰¯æœ¬èŠ‚ç‚¹éœ€è¦å°†è¯·æ±‚ä»Žæœ¬åœ°åˆ é™¤ã€‚æœ€ç®€å•çš„åšæ³•æ˜¯å½“ä¸€ä¸ªèŠ‚ç‚¹æ‰§è¡Œå®ŒæŸæ¡è¯·æ±‚å¹¶ReplyåŽï¼Œï¼Œå¯ä»¥å¹¿æ’­ä¸€æ¡æ¶ˆæ¯ï¼Œå½“å…¨ç½‘æœ‰2f+1ä¸ªèŠ‚ç‚¹éƒ½æ‰§è¡Œå®Œè¿™æ¡è¯·æ±‚åŽå°±å¯ä»¥åˆ é™¤å®ƒçš„æ—¥å¿—äº†ï¼Œè¿™æ ·çš„åšæ³•æˆæœ¬æ¯”è¾ƒé«˜ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å¤šæ¡è¯·æ±‚KåŽï¼ˆä¾‹å¦‚100æ¡ï¼‰æ‰§è¡Œä¸€æ¬¡çŠ¶æ€åŒæ­¥ã€‚è¿™ä¸ªçŠ¶æ€åŒæ­¥æ¶ˆæ¯å°±æ˜¯checkPointæ¶ˆæ¯ å‰¯æœ¬èŠ‚ç‚¹i å‘é€&lt;ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œnæ˜¯å½“å‰èŠ‚ç‚¹ä¿ç•™çš„æœ€åŽä¸€ä¸ªè§†å›¾çš„è¯·æ±‚ç¼–å·ã€‚è¯¥checkPointæ¶ˆæ¯è®°å½•åˆ°logä¸­ã€‚å¦‚æžœå‰¯æœ¬èŠ‚ç‚¹æ”¶åˆ°äº†2f+1ä¸ªéªŒè¯è¿‡çš„checkPointæ¶ˆæ¯ï¼Œå°±å¯ä»¥è¯æ˜Žè¯¥æ£€æŸ¥ç‚¹æ˜¯æ­£ç¡®çš„ã€‚å…·æœ‰è¿™ä¸ªstable checkpointçš„èŠ‚ç‚¹å°±å¯ä»¥å°†æ‰€æœ‰åºå·å°äºŽç­‰äºŽnçš„pre-prepare,prepare,commitæ¶ˆæ¯ï¼Œä»¥åŠä¹‹å‰çš„æ£€æŸ¥ç‚¹å’Œæ£€æŸ¥ç‚¹æ¶ˆæ¯åˆ é™¤ã€‚ è¿™æ˜¯ä¸€ä¸ªç†æƒ³çš„æƒ…å†µï¼Œå®žé™…ä¸Šå½“å‰¯æœ¬iå‘å…¶ä»–èŠ‚ç‚¹å‘å‡ºcheckPointæ¶ˆæ¯åŽï¼Œå…¶ä»–èŠ‚ç‚¹è¿˜æ²¡å®ŒæˆKæ¡è¯·æ±‚ï¼Œæ‰€ä»¥ä¸ä¼šç«‹å³å¯¹iè¿›è¡Œå“åº”ï¼Œä»–è¿˜æ˜¯ä¼šæŒ‰ç…§è‡ªå·±çš„èŠ‚å¥ï¼Œå‘å‰å‰è¿›,ä½†æ˜¯æ­¤æ—¶çš„checkPointè¿˜æœªå½¢æˆstable,ä¸ºäº†é˜²æ­¢içš„è¯·æ±‚å¤„ç†è¿‡å¿«ï¼Œè®¾ç½®ä¸€ä¸ªä¸Šæ–‡æåˆ°çš„é«˜ä½Žæ°´ä½çº¿[h,H]æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä½Žæ°´ä½hç­‰äºŽä¸Šä¸€ä¸ªstable checkPointçš„å€¼ï¼Œé«˜æ°´ä½H = h + L, Lä¸ºæˆ‘ä»¬è®¾å®šçš„å€¼ï¼Œç­‰äºŽcheckPointå‘¨æœŸå¤„ç†è¯·æ±‚æ•°çš„æ•´æ•°å€ï¼Œå¯ä»¥è®¾ç½®ä¸ºL = 2Kã€‚å½“å‰¯æœ¬èŠ‚ç‚¹iå¤„ç†è¯·æ±‚è¶…è¿‡é«˜æ°´ä½çº¿Hçš„æ—¶å€™ï¼Œæ­¤æ—¶å°±éœ€è¦åœä¸€ä¸‹è„šæœ¬ï¼Œç­‰å¾…stable checkPoint å‘ç”Ÿå˜åŒ–ï¼Œå†ç»§ç»­å‰è¡Œã€‚ viewChangeå¦‚æžœä¸»èŠ‚ç‚¹ä½œæ¶ï¼Œå®ƒå¯èƒ½ä¼šç»™ä¸åŒçš„è¯·æ±‚ç¼–ä¸Šç›¸åŒçš„åºå·ï¼Œæˆ–è€…ä¸åŽ»åˆ†é…åºå·ï¼Œæˆ–è€…è®©ç›¸é‚»çš„åºå·ä¸è¿žç»­ã€‚å¤‡ä»½èŠ‚ç‚¹åº”å½“æœ‰èŒè´£æ¥ä¸»åŠ¨æ£€æŸ¥è¿™äº›åºå·çš„åˆæ³•æ€§ã€‚å¦‚æžœä¸»èŠ‚ç‚¹æŽ‰çº¿æˆ–è€…ä½œæ¶ä¸å¹¿æ’­å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå®¢æˆ·ç«¯è®¾ç½®è¶…æ—¶æœºåˆ¶ï¼Œè¶…æ—¶çš„è¯ï¼Œå‘æ‰€æœ‰å‰¯æœ¬èŠ‚ç‚¹å¹¿æ’­è¯·æ±‚æ¶ˆæ¯ã€‚å‰¯æœ¬èŠ‚ç‚¹æ£€æµ‹å‡ºä¸»èŠ‚ç‚¹ä½œæ¶æˆ–è€…ä¸‹çº¿ï¼Œå‘èµ·View Changeåè®®ã€‚ å‰¯æœ¬èŠ‚ç‚¹å‘å…¶ä»–èŠ‚ç‚¹å¹¿æ’­æ¶ˆæ¯ã€‚næ˜¯æœ€æ–°çš„stable checkpointçš„ç¼–å·ï¼ŒCæ˜¯2f+1éªŒè¯è¿‡çš„CheckPointæ¶ˆæ¯é›†åˆï¼ŒPæ˜¯å½“å‰å‰¯æœ¬èŠ‚ç‚¹æœªå®Œæˆçš„è¯·æ±‚çš„PRE-PREPAREå’ŒPREPAREæ¶ˆæ¯é›†åˆã€‚ å½“ä¸»èŠ‚ç‚¹p = v + 1 mod |R|æ”¶åˆ°2fä¸ªæœ‰æ•ˆçš„VIEW-CHANGEæ¶ˆæ¯åŽï¼Œå‘å…¶ä»–èŠ‚ç‚¹å¹¿æ’­æ¶ˆæ¯ã€‚Væ˜¯æœ‰æ•ˆçš„VIEW-CHANGEæ¶ˆæ¯é›†åˆã€‚Oæ˜¯ä¸»èŠ‚ç‚¹é‡æ–°å‘èµ·çš„æœªç»å®Œæˆçš„PRE-PREPAREæ¶ˆæ¯é›†åˆã€‚PRE-PREPAREæ¶ˆæ¯é›†åˆçš„é€‰å–è§„åˆ™ï¼š é€‰å–Vä¸­æœ€å°çš„stable checkpointç¼–å·min-sï¼Œé€‰å–Vä¸­prepareæ¶ˆæ¯çš„æœ€å¤§ç¼–å·max-sã€‚ åœ¨min-så’Œmax-sä¹‹é—´ï¼Œå¦‚æžœå­˜åœ¨Pæ¶ˆæ¯é›†åˆï¼Œåˆ™åˆ›å»º&lt;, m&gt;æ¶ˆæ¯ã€‚å¦åˆ™åˆ›å»ºä¸€ä¸ªç©ºçš„PRE-PREPAREæ¶ˆæ¯ï¼Œå³ï¼š&lt;, m(null)&gt;, m(null)ç©ºæ¶ˆæ¯ï¼Œd(null)ç©ºæ¶ˆæ¯æ‘˜è¦ã€‚ å‰¯æœ¬èŠ‚ç‚¹æ”¶åˆ°ä¸»èŠ‚ç‚¹çš„NEW-VIEWæ¶ˆæ¯ï¼ŒéªŒè¯æœ‰æ•ˆæ€§ï¼Œæœ‰æ•ˆçš„è¯ï¼Œè¿›å…¥v+1çŠ¶æ€ï¼Œå¹¶ä¸”å¼€å§‹Oä¸­çš„PRE-PREPAREæ¶ˆæ¯å¤„ç†æµç¨‹ã€‚å¦‚æžœä¸€æ¡è¯·æ±‚åœ¨ä¸Šä¸€ä¸ªviewä¸­åˆ°è¾¾äº†committedçŠ¶æ€ï¼Œä¸»èŠ‚ç‚¹å°±é€‰å–è¿™ä¸ªè¯·æ±‚å¼€å§‹åœ¨æ–°çš„viewä¸­è¿›è¡Œç¬¬ä¸‰é˜¶æ®µã€‚ä½†æ˜¯å¦‚æžœé€‰å–çš„è¯·æ±‚åœ¨ä¸Šä¸€viewä¸­å¹¶æ²¡æœ‰è¢«prepareï¼Œé‚£å®ƒçš„ç¼–å·næœ‰å¯èƒ½æ˜¯ä¸è¢«åŒæ„çš„ï¼Œæˆ‘ä»¬é€‰æ‹©åœ¨æ–°çš„viewä¸­ä½œåºŸè¿™æ ·çš„è¯·æ±‚ã€‚ å…·ä½“çš„viewChangeè¿‡ç¨‹å¦‚ä¸‹ è§†å›¾å˜æ›´å¯ä»¥ç”±è¶…æ—¶è§¦å‘ï¼Œä»¥é˜²æ­¢å¤‡ä»½èŠ‚ç‚¹æ— æœŸé™åœ°ç­‰å¾…è¯·æ±‚çš„æ‰§è¡Œã€‚å¤‡ä»½èŠ‚ç‚¹åœ¨æŽ¥æ”¶åˆ°ä¸€ä¸ªæœ‰æ•ˆè¯·æ±‚ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰§è¡Œå®ƒæ—¶ï¼Œä¼šæŸ¥çœ‹è®¡æ—¶å™¨æ˜¯å¦åœ¨è¿è¡Œï¼Œå¦‚æžœæ²¡æœ‰ï¼Œé‚£ä¹ˆå®ƒå°†å¯åŠ¨è®¡æ—¶å™¨ï¼›å½“è¯·æ±‚è¢«æ‰§è¡Œæ—¶å°±æŠŠè®¡æ—¶å™¨åœæ­¢ã€‚å¦‚æžœè®¡æ—¶å™¨è¶…æ—¶ï¼Œåˆ™view + 1,å¹¶å°†ä¼šæŠŠè§†å›¾å˜æ›´çš„æ¶ˆæ¯å‘å…¨ç½‘å¹¿æ’­ã€‚ Q&amp;A pfbtå…±è¯†ä¸ºä»€ä¹ˆéœ€è¦3f+ 1ä¸ªèŠ‚ç‚¹ï¼Ÿ pbftå…±è¯† parpareå’Œcommit é˜¶æ®µä¸ºä»€ä¹ˆæ”¶åˆ°éœ€è¦2f+ 1ä¸ªèŠ‚ç‚¹å›žå¤ï¼ˆåŒ…æ‹¬è‡ªå·±çš„ï¼‰ï¼Œf + 1ä¸ªä¸è¡Œå—ï¼Ÿ pbft å…±è¯† å®¢æˆ·ç«¯ä¸ºä»€ä¹ˆéœ€è¦f + 1ä¸ªèŠ‚ç‚¹çš„ç›¸åŒå›žå¤ï¼Œfä¸ªä¸è¡Œå—ï¼Ÿ pbftå…±è¯† ä¸ºä»€ä¹ˆéœ€è¦ä¸‰é˜¶æ®µï¼ŸåŽ»é™¤æŽ‰commité˜¶æ®µå¯ä»¥å—ï¼Ÿ åœ¨ä¸€ä¸ªèŠ‚ç‚¹æ•°ä¸ºNçš„èŠ‚ç‚¹ä¸­ï¼Œè¯šå®žèŠ‚ç‚¹çš„æ•°é‡æ˜¯å¤šå°‘ä¸ªï¼Ÿ CAPå®šç†åœ¨pbftä¸­æ˜¯å¦‚ä½•å–èˆçš„ï¼Ÿ è®¾ç½®waterlineçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ PAREPARE å’Œcommité˜¶æ®µä¸ºä»€ä¹ˆéœ€è¦ä¿å­˜æ¶ˆæ¯åœ¨æœ¬åœ°æˆ–è€…å†…å­˜ï¼ŸPRE-PREPAREä¸ºä»€ä¹ˆä¸éœ€è¦ï¼Ÿ pbfté€šä¿¡æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿå¦‚ä½•è®¡ç®—çš„ï¼Ÿ å¦‚æžœåœ¨commité˜¶æ®µview changeï¼Œä¼šå¯¼è‡´è¾¾æˆä¸äº†å…±è¯†å—ï¼Ÿä¼šå¯¼è‡´ä¹‹å‰çš„viewä¸‹çš„è¯·æ±‚ç¼–å·ä¸¢å¤±å—ï¼Ÿ ä¸‹é¢ç¯‡æ–‡ç« æˆ‘ä¼šç»™å‡ºè¿™äº›é—®é¢˜çš„ç­”æ¡ˆ]]></content>
      <categories>
        <category>å…±è¯†ç®—æ³•</category>
      </categories>
      <tags>
        <tag>pbft</tag>
      </tags>
  </entry>
</search>
