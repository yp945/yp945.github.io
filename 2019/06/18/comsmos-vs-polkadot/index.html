<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Cosmos 和 Polkadot 都是关注区块链互操作性的项目，关于二者之间的差别已经有过很多讨论。如果你还不熟悉这两个项目，Linda Xie 发过一串推特介绍过这两个项目，可以作为很好的入门材料。 虽然已经有很多文章分析过这两个项目的区别了，但是我认为其中大部分都存在一定的偏向性或者不够详细。通过这篇文章，我会从架构权衡到设计哲学等方面更深入地探讨这两个项目。">
<meta name="keywords" content="Cosmos,Polkadot">
<meta property="og:type" content="article">
<meta property="og:title" content="Cosmos 与 波卡 Polkadot 的五大区别">
<meta property="og:url" content="http://yoursite.com/2019/06/18/comsmos-vs-polkadot/index.html">
<meta property="og:site_name" content="ClimbYang的记录">
<meta property="og:description" content="Cosmos 和 Polkadot 都是关注区块链互操作性的项目，关于二者之间的差别已经有过很多讨论。如果你还不熟悉这两个项目，Linda Xie 发过一串推特介绍过这两个项目，可以作为很好的入门材料。 虽然已经有很多文章分析过这两个项目的区别了，但是我认为其中大部分都存在一定的偏向性或者不够详细。通过这篇文章，我会从架构权衡到设计哲学等方面更深入地探讨这两个项目。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://img.learnblockchain.cn/2019/06/15608239090500.png">
<meta property="og:image" content="https://img.learnblockchain.cn/2019/05/15585168934635.jpg!wl/scale/60%">
<meta property="og:image" content="https://img.learnblockchain.cn/2019/06/15608254444315.png">
<meta property="og:image" content="https://img.learnblockchain.cn/2019/06/15608262563931.png">
<meta property="og:updated_time" content="2019-07-05T08:13:55.291Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cosmos 与 波卡 Polkadot 的五大区别">
<meta name="twitter:description" content="Cosmos 和 Polkadot 都是关注区块链互操作性的项目，关于二者之间的差别已经有过很多讨论。如果你还不熟悉这两个项目，Linda Xie 发过一串推特介绍过这两个项目，可以作为很好的入门材料。 虽然已经有很多文章分析过这两个项目的区别了，但是我认为其中大部分都存在一定的偏向性或者不够详细。通过这篇文章，我会从架构权衡到设计哲学等方面更深入地探讨这两个项目。">
<meta name="twitter:image" content="https://img.learnblockchain.cn/2019/06/15608239090500.png">



  <link rel="alternate" href="/atom.xml" title="ClimbYang的记录" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://yoursite.com/2019/06/18/comsmos-vs-polkadot/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Cosmos 与 波卡 Polkadot 的五大区别 | ClimbYang的记录</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    
        <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ClimbYang的记录</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">blockchain</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/18/comsmos-vs-polkadot/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ClimbYang">
      <meta itemprop="description" content="记录学习编程的点滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ClimbYang的记录">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Cosmos 与 波卡 Polkadot 的五大区别

              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-18 10:45:14" itemprop="dateCreated datePublished" datetime="2019-06-18T10:45:14+08:00">2019-06-18</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-07-05 16:13:55" itemprop="dateModified" datetime="2019-07-05T16:13:55+08:00">2019-07-05</time>
              </span>
            
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/跨链/" itemprop="url" rel="index"><span itemprop="name">跨链</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
              <span title="本文字数">7.5k</span>
            </span>
          

	  

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
              <span title="阅读时长">15 分钟</span>
            </span>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Cosmos 和 Polkadot 都是关注区块链互操作性的项目，关于二者之间的差别已经有过很多讨论。如果你还不熟悉这两个项目，Linda Xie 发过一串<a href="https://twitter.com/ljxie/status/1118221870745047040?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1118221870745047040&ref_url=https%3A%2F%2Fmedium.com%2Fmedia%2F4c261ee43d7ae6db10bd7c53dcca9114%3FpostId%3D67f09535594b" target="_blank" rel="noopener">推特</a>介绍过这两个项目，可以作为很好的入门材料。</p>
<p>虽然已经有很多文章分析过这两个项目的区别了，但是我认为其中大部分都存在一定的偏向性或者不够详细。通过这篇文章，我会从架构权衡到设计哲学等方面更深入地探讨这两个项目。</p>
<a id="more"></a>

<h2 id="为什么要构建一条新的区块链？"><a href="#为什么要构建一条新的区块链？" class="headerlink" title="为什么要构建一条新的区块链？"></a>为什么要构建一条新的区块链？</h2><p>为什么一些项目要选择从头开始构建一条专门承载应用程序的区块链，而不是以<a href="https://learnblockchain.cn/2018/01/04/understanding-smart-contracts/" target="_blank" rel="noopener">智能合约</a>的形式在现有的区块链上编写应用程序呢？主要有以下两点原因。</p>
<p>首先，现有的智能合约平台不一定能满足应用程序所需的灵活性和可定制性。举例来说，如果你想搭建的应用程序需要自定义的哈希函数，那么把它编写到以太坊上会消耗很多 gas ，因为这个函数每调用一次都需要在以太坊虚拟机内执行一次。一种解决方案是提议将这个函数作为<a href="https://ethereum.stackexchange.com/questions/15479/list-of-pre-compiled-contracts" target="_blank" rel="noopener">预编译合约</a>添加至以太坊协议内。但是，除非这个函数也广泛应用于其它应用程序，否则这项提议大概率是不会通过的。从头开始编写一条新的区块链，你就可以自由灵活地设计区块链的核心逻辑，以此满足你的应用程序的需求。</p>
<p>其次是自治问题。在<a href="https://learnblockchain.cn/2018/01/04/understanding-smart-contracts/" target="_blank" rel="noopener">智能合约</a>平台上构建的应用程序必须接受平台的治理并遵守其规则，从区块时间和 gas 定价之类影响用户体验的规则，到回滚之类改变状态的决策等等。</p>
<p>但相应的，具有自治能力的链失去了与其它应用程序进行无缝通信的能力，因为应用程序都是搭建在使用不同状态机的区块链上。Cosmos 和 Polkadot 都致力于解决这个问题——Cosmos 采用的是 <a href="https://medium.com/@juliankoh/a-deep-look-into-cosmos-the-internet-of-blockchains-af3aa1a97a5b" target="_blank" rel="noopener">Hub-and-Zone</a>（中心枢纽-分区） 模型，Polkadot 则采用的是<a href="https://medium.com/polkadot-network/polkadot-the-foundation-of-a-new-internet-e8800ec81c7" target="_blank" rel="noopener">Relay Chain/Parachain</a>（中继链/平行链）模型。</p>
<p>读者需要对这两个项目有一定的了解，本文侧重于梳理二者的不同点。</p>
<h2 id="局部安全-vs-全局安全"><a href="#局部安全-vs-全局安全" class="headerlink" title="局部安全 vs 全局安全"></a>局部安全 vs 全局安全</h2><p><a href="https://learnblockchain.cn/2019/05/21/what-is-cosmos/" target="_blank" rel="noopener">Cosmos</a> 和 Polkadot 采用的安全模型差别极大。</p>
<h3 id="Polkadot-共享全局安全"><a href="#Polkadot-共享全局安全" class="headerlink" title="Polkadot 共享全局安全"></a>Polkadot 共享全局安全</h3><p>简单来说，Polkadot 的工作流程如下：</p>
<p><img src="https://img.learnblockchain.cn/2019/06/15608239090500.png" alt="Polkadot的安全模型"></p>
<p class="image-caption">Polkadot 的网络架构</p>


<p>平行链（Parachain）是 Polkadot 网络中的区块链。这些链有自己的状态机、自己的规则和自己的区块生产者，即核验人（collators）。<strong>每条平行链本质上都是一个独立的状态机</strong>，而且可以使用任何类型的特殊功能、共识算法、交易手续费结构等等。在 Polkadot 网络中，所有平行链都有同一条母链，叫做中继链，里面包含了由所有平行链组成的 “全局状态”。中继链拥有自己的共识算法，叫做 GRANDPA 共识（祖父共识），可以迅速将平行链上的区块确定下来。通过这个模型，Polkadot 的平行链实现了 “共享安全性”—— 如果中继链上有 1000 名验证者，具有极高的安全性，凡是连接到这条中继链的平行链都会受益。这样一来，平行链即能拥有自己的状态机并自定义规则，又能与成百上千条平行链一起共享母链的安全性。</p>
<p>这种模型的<strong>缺点</strong>需要在于由中继链上的验证者来验证平行链上的状态改变。例如，验证者可能会出于某种原因一直拒绝某条链上的核验人提议的区块，而且这条中继链上的区块永远无法被添加进全局状态。为了尽量避免这种情况，Polkadot 对验证者进行混洗，让他们随机验证平行链，降低同一位验证者始终验证同一条平行链的概率。Polkadot 还另设有一类被称为 Fishermen （渔夫）的验证者，他们会不断查验验证者是否存在恶意行为。</p>
<h3 id="Cosmos-独立的局部安全"><a href="#Cosmos-独立的局部安全" class="headerlink" title="Cosmos 独立的局部安全"></a>Cosmos 独立的局部安全</h3><p><a href="https://learnblockchain.cn/2019/05/21/what-is-cosmos/" target="_blank" rel="noopener">Cosmos</a> 采用了完全不同的网络架构。</p>
<p><img src="https://img.learnblockchain.cn/2019/05/15585168934635.jpg!wl/scale/60%" alt="Cosmos的网络架构"></p>
<p class="image-caption">Cosmos的网络架构</p>

<p><strong>在 Cosmos 网络中，每条链都是独立运行的</strong>，并设有各自的安全机制，而非像 Polkadot 那样采用全局的安全性模型。每条链都有自己的共识机制，而且由单独的验证者来负责保护这条链的安全性。Cosmos 网络使用中心枢纽-分区模型来实现互操作性，每个分区（独立的链）都可以通过中心枢纽（同样是一条独立的链）向其它分区 “发送代币”。这个协议被称为 IBC （跨链通信），是链与链之间通过发送消息实现代币转账的协议。IBC 协议尚在<a href="https://github.com/cosmos/ics/issues" target="_blank" rel="noopener">开发</a>之中，最开始先支持代币转账，最终会支持各类消息的跨链传递。</p>
<p>相比于 Polkadot 的架构而言，Cosmos 的架构最大的不同之处在于，每个分区链的状态仅由各自的验证者保护。一个分区想要获得很强的安全性，就需要建立自己的验证者集，这对于小型应用程序来说会比较困难。不过，对于那些想要获得更多控制权的应用程序来说，这是个很大的亮点。例如，币安最开始就是用自己的节点来充当币安链的验证者，来促进去中心化交易所的持续运行。这样一来，币安在测试币安链并增加新功能的时候就有了充分的控制权。我觉得币安不太可能放弃决定哪些交易可以上链的权力，但若要在<a href="https://learnblockchain.cn/2017/11/20/whatiseth/" target="_blank" rel="noopener">以太坊</a>或 Polkadot 平台上开发，就不能不放弃这样的权力。正因如此，我认为 Telegram、Facebook 和 Kakao 这类公司会选择构建自己的区块链并掌握其控制权，未来也不太可能与别的链通信。</p>
<h2 id="治理和参与"><a href="#治理和参与" class="headerlink" title="治理和参与"></a>治理和参与</h2><p>Polkadot 和 Cosmos 之间的第二个主要差别在于治理和参与。</p>
<h3 id="参与规则差异"><a href="#参与规则差异" class="headerlink" title="参与规则差异"></a>参与规则差异</h3><p>在 Polkadot 网络中，只有一条中继链和一些与这条中继链共享验证者的平行链。根据<a href="https://medium.com/polkadot-network/a-brief-summary-of-everything-substrate-and-polkadot-f1f21071499d" target="_blank" rel="noopener">目前的估算</a>，平行链的数量上限为 100 条，不过未来有可能减少或增加。Polkadot 网络通过拍卖机制来竞拍平行链的使用权——出价最高的人需要在 PoS 系统中锁定一定数量的 DOT （Polkadot 上的原生货币），才可以在一定时间段内拥有所拍得平行链的使用权。这意味着要想使用 Polkadot 上的平行链，需要购买并锁定大量 DOT ，直到不想再使用这条平行链为止。</p>
<p>Cosmos 网络没有设置固定的参与规则——任何人都可以创建中心枢纽或分区。中心枢纽就是具有自治能力的区块链，它专门用来连接其它区块链。这里有两个例子，一个是 <a href="https://cosmos.bigdipper.live/" target="_blank" rel="noopener">Cosmos Hub</a>，最近已由 Tendermint 团队上线；另一个是 <a href="https://www.irisnet.org/" target="_blank" rel="noopener">Iris Hub</a>，旨在连接主要运行于中国或其它亚洲国家的区块链 。这种中心枢纽-分区模型提高了跨链通信的效率，因为分区链只需要连接到中心枢纽，无需连接到其他每条链上。</p>
<p><img src="https://img.learnblockchain.cn/2019/06/15608254444315.png" alt="中心枢纽-分区模型"></p>
<p class="image-caption">中心枢纽-分区模型可以更高效地连接多条链</p>

<h3 id="治理流程差异"><a href="#治理流程差异" class="headerlink" title="治理流程差异"></a>治理流程差异</h3><p>由于参与规则不同，这两个网络在治理流程上也存在差异。<br>在 Polkadot 网络中，治理决策取决于投票者所质押的 DOT 数量。关于链上投票会有一套正式机制，不过尚未最终确定下来，点击<a href="https://github.com/paritytech/polkadot/wiki/Governance" target="_blank" rel="noopener">此处</a>可了解最新进展。除了采取以质押量决定投票权重的机制之外，Polkadot 还组建了一个委员会来代表不活跃的权益持有者。委员会最开始由 6 人组成，每两周增加 1 人，直到满 24 人为止。每位委员会成员均通过<a href="https://en.wikipedia.org/wiki/Approval_voting" target="_blank" rel="noopener">赞成投票</a>的方式选出。治理流程的具体细节尚未敲定，也就是说有很多方法可以改变中继链的参数，如出块时间、区块奖励等，以及平行链的参与规则。例如，Polkadot 的治理流程可以改变平行链使用权的竞拍机制或所需的 DOT 数量。有一种常见的误解是 DOT 持有者可以通过投票随意弃用某条平行链。实际上，DOT 持有者只能改变参与流程。也就是说一旦竞拍下了某条平行链，在整个<a href="https://twitter.com/PAMauric/status/1118545428809568267" target="_blank" rel="noopener">租期</a>之内都享有这条链的使用权。</p>
<p>另一方面，Cosmos 网络不存在单一的 “治理”流程。每个中心枢纽和分区都有自己的治理流程，因此没有一套应用于整个系统内所有链的核心规则。我们所说的“Cosmos 治理”指的都是 Cosmos Hub 的治理，即由 Tendermint 团队上线的那条链。Cosmos Hub 的规则是，任何人都可以发送一个文本提议，由 ATOM 持有者进行投票表决，ATOM 的质押量决定了投票权重。想知道提议长什么样子，<a href="https://www.mintscan.io/proposals/5" target="_blank" rel="noopener">这里</a>有个例子。如果你想深入了解治理流程的话，可以阅读一下 Chorus One 发布的<a href="https://learnblockchain.cn/2019/06/18/comsmos-governance/" target="_blank" rel="noopener"> Cosmos Hub 治理机制</a>，是不错的了解 Cosmos Hub 治理的入门资料。</p>
<h2 id="跨链通信"><a href="#跨链通信" class="headerlink" title="跨链通信"></a>跨链通信</h2><p>Polkadot 和 Cosmos 之间的另一个差别是跨链通信协议及其设计目标。<br><strong>Polkadot 旨在实现平行链之间任意的消息传递</strong>。也就是说，平行链 A 可以调用平行链 B 中的智能合约，实现与平行链 B 之间的代币转账或是其他类型的通信。<strong>Cosmos 则聚焦于跨链资产转移</strong>，其协议较为简单。目前，这两种通信协议仍待完善细则，而且尚未构建完成。可以查看 <a href="https://github.com/cosmos/ics" target="_blank" rel="noopener">IBC</a>（跨链通信）和 <a href="http://research.web3.foundation/en/latest/polkadot/ICMP/" target="_blank" rel="noopener">ICMP</a>（平行链之间的跨链通信）这两种协议的细则。</p>
<p>跨链通信所面临的最大挑战不是如何将一条链上的数据在另一条链上表示出来，而是如何处理链分叉和链重组这样的情况。这是 Cosmos 和 Polkadot 在构架设计上最大的差异。</p>
<p>为了确保跨链通信的安全性，Polkadot 采用了两种不同的机制。首先是安全性共享机制，降低了信息交换的难度。 共享安全性的另一个好处是所有平行链都位于同一个安全层级，因此每条链可以彼此信任。为便于理解，我们以以太坊（安全性较高）和 Verge（安全性较低）的交互操作为例。若想在 Verge 链上表示以太坊，我们可以锁定一些以太坊，然后在 Verge 链上生成 ETH-XVG 代币。然而，由于 Verge 链的安全性较低，攻击者可能会向 Verge 链发动 51% 攻击，并向以太坊区块链发送双花交易，就可以取回比实际拥有数量更多的以太币。因此，在互相发送消息的时候，安全性较高的链很难信任安全性较低的链。如果是在安全层级各不相同的链之间互传消息，情况就会变得更加复杂。</p>
<p>从理论上来说，共享安全性是一种保障跨链通信的良好方式。前提是，这种协议要确保能够经常对验证者进行混洗，再随机分配到各条平行链上。这就会造成经典的 “数据可用性问题”，即每次验证者被分配到新的平行链上，就需要下载新链的状态。这是目前区块链领域最大的难题之一，Polkadot 能否解决尚未可知。</p>
<p>其次，Polkadot 引入了 Fisherman（渔夫）的概念，也就是 Polkadot 网络上的 “赏金猎人”，专门监视平行链上的恶意行为。从某种意义上来说，这是抵御恶意行为的“第二道防线”。如果某条平行链的验证者将一个无效块上链，Fisherman 发现后可以向中继链提交证明，将包括所有平行链在内的整个 Polkadot 网络的状态进行回滚。在跨链通信期间，最令我们担心的莫过于一条链在重组，另一条链却运行如常。Polkadot 就避免了这个问题，一旦发现无效块上链，整个网络都会回滚。</p>
<p>Cosmos 采用了完全不同的跨链通信方式。因为每条链上都有自己的验证者，所以很有可能会出现分区中的验证者串谋的情况。也就是说，如果有两个分区需要通信，A 分区需要必须信任 Cosmos Hub（通信枢纽）以及 B 分区中的验证者。从理论上来说，A 分区的人在决定向 B 分区发送信息之前，需要调查一下 B 分区的验证者。不过我觉得实际情况没那么糟糕。 <a href="https://hubble.figment.network/cosmos/chains/cosmoshub-2/validators/B1167D0437DB9DF0D533EE2ACDE48107139BDD2E" target="_blank" rel="noopener">Polychain Labs</a> 或 Zaki Manian 的 <a href="https://hubble.figment.network/cosmos/chains/cosmoshub-2/validators/95E060D07713070FE9822F6C50BD76BCCBF9F17A" target="_blank" rel="noopener">iqlusion</a> 等知名验证者节点可能会验证多条链，逐渐建立起良好的声誉。也就是说，当 A 分区的人看到 B 分区是由 Polychain Labs 和 iqlusion 验证的，可能会因此决定信任 B 分区。</p>
<p>然而，即使一条链得到了人们的信任，也有可能被怀有恶意的攻击者控制，出现各种问题。有一段<a href="https://youtu.be/_qUnCUZHc5g" target="_blank" rel="noopener">对话</a>中提到了一个很好的例子：<br><img src="https://img.learnblockchain.cn/2019/06/15608262563931.png" alt></p>
<p class="image-caption">代币分散于不同分区的 Cosmos 网络</p>

<p>假设上图中的小红点代表一种名为 ETM 的代币，即 Ethermint 分区的原生代币。A、B、C 三个分区的用户想要使用 ETM 来运行各自分区内的一些应用程序，而且他们都信任 Ethermint 分区，因此通过跨链通信在各自的分区内接受了一些 ETM 。现在假设 Ethermint 分区的验证者串谋发动双花攻击，任意转移 ETM 代币。这也会对剩余网络造成影响，因为 ETM 代币也存在于其他分区中。不过受波及的只有 Ethermint 或其他分区中的 ETM 代币持有者。Ethermint 分区中的恶意验证者只能毁掉自己的分区，破坏不了其他分区。这就是 Cosmos 架构的目标——确保恶意行为无法影响整个网络。</p>
<p>Polkadot 则不同。如果中继链（全局状态）上发生了无效状态更新，又没被 Fisherman 发现的话，Polkadot 网络中的每条平行链都会受到影响。平行链不能被看作是完全不同的东西，毕竟它们都共享同一个全局状态。</p>
<h2 id="共识算法"><a href="#共识算法" class="headerlink" title="共识算法"></a>共识算法</h2><p>Polkadot 中继链采用的是 <a href="https://medium.com/polkadot-network/grandpa-block-finality-in-polkadot-an-introduction-part-1-d08a24a021b5" target="_blank" rel="noopener">GRANDPA</a> 共识算法。这个算法能让中继链迅速确定来自所有平行链的区块，并且容纳大量验证者（1000 名以上）。简单来说，这是因为并非所有验证者都需要对每一个区块进行投票——他们可以只需为自己认为有效的某个区块投票，相当于这个区块之前的所有区块也都得到了认可。通过这种方式，GRANDPA 算法可以找出一组得票数最多的区块，并将这组区块确定了下来。该算法仍处于开发之中，尚不知实际会如何执行。</p>
<p>平行链可以采用不同的共识算法达成局部共识。Polkadot 提供一个软件开发工具包（<a href="https://github.com/paritytech/substrate" target="_blank" rel="noopener">Substrate</a>），其中包括 GRANDPA、Rhododendron 和 Aurand 三种开箱即用的共识算法。今后可能会有更多算法被加入 Substrate ，皆可应用于 Polkadot 网络。</p>
<p>在 Cosmos 网络中，每条链可以选用的共识算法有很多，只要是符合 <a href="https://tendermint.com/docs/spec/abci/" target="_blank" rel="noopener">ABCI</a> 规范的共识算法即可。 <a href="https://tendermint.com/docs/spec/abci/" target="_blank" rel="noopener">ABCI</a> 规范旨在实现跨链通信的标准化。目前只有 Tendermint 算法符合这个规范，还有<a href="https://twitter.com/sunnya97/status/1113454367548379136" target="_blank" rel="noopener">另一些团队</a>也在努力开发符合该规范的其他共识算法。从更抽象的层面上来看，Tendermint 算法的原理是让每位验证者都能互相通信，共同决定一个区块能否上链，这样就能实现单一区块层面上的确定性。该算法的速度很快，而且通过了 200 名验证者的压力测试，在 <a href="https://github.com/cosmos/game-of-stakes" target="_blank" rel="noopener">Game of Stakes</a>（权益争夺赛）中的出块时间为 6 秒。Cosmos 团队也提供了一个软件开发工具包，里面包含了开箱即用的 Tendermint 算法。<a href="https://medium.com/tendermint/a-to-z-of-blockchain-consensus-81e2406af5a3" target="_blank" rel="noopener">这篇文章</a>很好地介绍了共识算法，以及 Tendermint 算法的功能。</p>
<p>Tendermint 算法最大的缺点是验证者之间的通信成本高很高。也就是说，虽然验证者人数在 200 左右的时候，算法的运行速度很快，一旦人数涨到了 2000 ，速度就会慢得多。另一方面需要权衡的是异步环境中的安全性。也就是说，在出现网络分区之时，不会出现两个不同的交易历史最终合并成一个（而另一个交易历史被抛弃）的情况，而是整个网络都将停止运行。这点非常重要，一旦一笔交易得到了“最终确认”，即使是在最差的网络环境下也不会被撤销。</p>
<p>我的个人观点是，基于共识算法来比较这两个项目没什么长远意义。这两个项目的构架未来都将接受不同的共识算法。如今的绝大多数应用不管使用的是 Tendermint 算法还是 Polkadot 的某个共识算法都可以良好运行。</p>
<h2 id="Substrate-vs-Cosmos-SDK"><a href="#Substrate-vs-Cosmos-SDK" class="headerlink" title="Substrate vs Cosmos SDK"></a>Substrate vs Cosmos SDK</h2><p>Polkadot 和 Cosmos 都提供软件开发工具包，分别叫作 <a href="https://www.parity.io/substrate/" target="_blank" rel="noopener">Substrate</a> 和 <a href="https://cosmos.network/sdk" target="_blank" rel="noopener">Cosmos SDK</a> 。二者的目的都是为了便于开发者搭建自己的区块链，其中包括各种开箱即用的模块，例如治理模块（投票系统）、质押模块和认证模块等。这两个工具包最主要的区别在于，<a href="https://learnblockchain.cn/docs/cosmos/" target="_blank" rel="noopener">Cosmos SDK</a> 仅支持 Go 语言，而 Substrate 支持任何可编译为 WASM (Web Assembly) 的语言，给予了开发者更多灵活性。</p>
<p>这两个工具包都是构建区块链的全新框架，未来几年还将新增更多功能。关于这两个工具包的深度剖析以及使用这两个工具包开发应用程序的详细体验需要另外写一篇文章了。如果你感兴趣的话，请在推特上给我<a href="https://twitter.com/juliankoh" target="_blank" rel="noopener"><em>@</em>juliankoh</a> 留言。</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>虽然这篇文章篇幅很长，写的也很详细，但是依然有所疏漏。Cosmos 和 Polkadot 之间的不同点很难把握，可能还有很多细节我没有捕捉到。要全方位了解这两个项目绝非易事，毕竟项目文件随时都可能改动。这两个项目尚在起步阶段，未来一年将得到极大的发展——我在上文中提到的几个点可能很快就不成立了。总而言之，我认为 Polkadot 相比 Cosmos 主要有以下几个优势：</p>
<ol>
<li>应用程序开发者不需要自己维护安全性</li>
<li>共享安全性模型下的跨链通信更容易解决数据可用性问题</li>
<li>Substrate（在 WASM、更多共识算法和开箱即用模块方面）表现出很大的野心</li>
<li>相比跨平行链的合约调用更侧重于不限类型的信息传递（这一用例目前尚不明确）</li>
<li>1.0 版本的<a href="https://twitter.com/web3jp/status/1113440496116846592" target="_blank" rel="noopener">开发者</a>似乎多一些</li>
</ol>
<p>反过来，Cosmos 相比 Polkadot 主要有以下几个优势：</p>
<ol>
<li>Cosmos 已经上线了，Polkadot 还没上线</li>
<li>Polkadot 的平行链参与流程限制性更强，而且成本更高</li>
<li>更能满足特定项目（如币安）对自定义的需求</li>
<li>平行链上验证者的恶意行为会波及整个网络。在 Cosmos 网络中，恶意行为只能破坏个别分区和资产</li>
<li>已经有<a href="https://cosmos.network/ecosystem" target="_blank" rel="noopener">很多项目</a>在使用 Cosmos SDK 了</li>
<li>重点关注如何降低资产转移的难度。目前已经有经过验证的用例。</li>
</ol>
<p>感谢每一位不厌其烦为我答疑解惑的朋友，尤其是来自 Cosmos 团队的 <a href="https://twitter.com/zmanian" target="_blank" rel="noopener">Zaki Manian</a> 和 <a href="https://twitter.com/gautier_md" target="_blank" rel="noopener">Gautier Marin</a> ，以及来自 Polkadot 团队的 Alistair Stewart 。NEAR Protocol (<a href="https://twitter.com/AlexSkidanov" target="_blank" rel="noopener">Alex Skidanov</a>) 发布的 <a href="https://youtu.be/5bLwPQZw9Jk" target="_blank" rel="noopener">Whiteboard Series</a> 系列视频很棒，对我理解这两个项目给予了很大帮助。<a href="https://twitter.com/ljxie/" target="_blank" rel="noopener">Linda Xie</a> 整理出来的关于 Polkadot 和 Cosmos 的链接帮助我缩小了文章的范围，让这篇文章更具有可读性。特别感谢<a href="https://twitter.com/cherylyeoh" target="_blank" rel="noopener">Cheryl Yeoh</a> 在我撰写本文的过程中为我提供的灵感和思路，并且对本文进行了审校。</p>
<hr>
<p>原文链接在<a href="https://medium.com/@juliankoh/5-differences-between-cosmos-polkadot-67f09535594b" target="_blank" rel="noopener">这里</a> ， 在<a href="https://ethfans.org" target="_blank" rel="noopener">ETHFANS</a> 的闵敏 &amp; 阿剑的翻译基础上有说所修改。</p>
<p><a href="https://learnblockchain.cn/" target="_blank" rel="noopener">深入浅出区块链</a> - 打造高质量区块链技术博客，<a href="https://learnblockchain.cn/2018/01/11/guide/" target="_blank" rel="noopener">学区块链</a>都来这里，关注<a href="https://www.zhihu.com/people/xiong-li-bing/activities" target="_blank" rel="noopener">知乎</a>、<a href="https://weibo.com/517623789" target="_blank" rel="noopener">微博</a> 掌握区块链技术动态。</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/tags/Cosmos/" rel="tag"># Cosmos</a>
          
            <a href="/tags/Polkadot/" rel="tag"># Polkadot</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/06/18/comsmos-governance/" rel="next" title="理解 Cosmos Hub 的治理【译】">
                <i class="fa fa-chevron-left"></i> 理解 Cosmos Hub 的治理【译】
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/06/19/web3-blockchain/" rel="prev" title="理解 Web 3 技术栈及区块链如何助力">
                理解 Web 3 技术栈及区块链如何助力 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">ClimbYang</p>
              <div class="site-description motion-element" itemprop="description">记录学习编程的点滴</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">88</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">24</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">75</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/yp945" title="GitHub &rarr; https://github.com/yp945" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:pan107104@outlook.com" title="E-Mail &rarr; mailto:pan107104@outlook.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#为什么要构建一条新的区块链？"><span class="nav-number">1.</span> <span class="nav-text">为什么要构建一条新的区块链？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#局部安全-vs-全局安全"><span class="nav-number">2.</span> <span class="nav-text">局部安全 vs 全局安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Polkadot-共享全局安全"><span class="nav-number">2.1.</span> <span class="nav-text">Polkadot 共享全局安全</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cosmos-独立的局部安全"><span class="nav-number">2.2.</span> <span class="nav-text">Cosmos 独立的局部安全</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#治理和参与"><span class="nav-number">3.</span> <span class="nav-text">治理和参与</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#参与规则差异"><span class="nav-number">3.1.</span> <span class="nav-text">参与规则差异</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#治理流程差异"><span class="nav-number">3.2.</span> <span class="nav-text">治理流程差异</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#跨链通信"><span class="nav-number">4.</span> <span class="nav-text">跨链通信</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#共识算法"><span class="nav-number">5.</span> <span class="nav-text">共识算法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Substrate-vs-Cosmos-SDK"><span class="nav-number">6.</span> <span class="nav-text">Substrate vs Cosmos SDK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#结论"><span class="nav-number">7.</span> <span class="nav-text">结论</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ClimbYang</span>

  

  
</div>

<div>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv" style="display:none">
    本站总访问量 <span id="busuanzi_value_site_pv"></span> 次
    <span class="post-meta-divider">|</span>
</span>
<span id="busuanzi_container_site_uv" style="display:none">
    有<span id="busuanzi_value_site_uv"></span>人看过
</span>
</div>




  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/affix.js?v=7.2.0"></script>

  <script src="/js/schemes/pisces.js?v=7.2.0"></script>




  
  <script src="/js/scrollspy.js?v=7.2.0"></script>
<script src="/js/post-details.js?v=7.2.0"></script>



  


  <script src="/js/next-boot.js?v=7.2.0"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
